!function(){"use strict";var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var r,n={},i={};function s(){if(r)return i;r=1,i.byteLength=function(t){var e=a(t),r=e[0],n=e[1];return 3*(r+n)/4-n},i.toByteArray=function(t){var r,i,s=a(t),o=s[0],c=s[1],u=new n(function(t,e,r){return 3*(e+r)/4-r}(0,o,c)),f=0,h=c>0?o-4:o;for(i=0;i<h;i+=4)r=e[t.charCodeAt(i)]<<18|e[t.charCodeAt(i+1)]<<12|e[t.charCodeAt(i+2)]<<6|e[t.charCodeAt(i+3)],u[f++]=r>>16&255,u[f++]=r>>8&255,u[f++]=255&r;2===c&&(r=e[t.charCodeAt(i)]<<2|e[t.charCodeAt(i+1)]>>4,u[f++]=255&r);1===c&&(r=e[t.charCodeAt(i)]<<10|e[t.charCodeAt(i+1)]<<4|e[t.charCodeAt(i+2)]>>2,u[f++]=r>>8&255,u[f++]=255&r);return u},i.fromByteArray=function(e){for(var r,n=e.length,i=n%3,s=[],o=16383,a=0,c=n-i;a<c;a+=o)s.push(u(e,a,a+o>c?c:a+o));1===i?(r=e[n-1],s.push(t[r>>2]+t[r<<4&63]+"==")):2===i&&(r=(e[n-2]<<8)+e[n-1],s.push(t[r>>10]+t[r>>4&63]+t[r<<2&63]+"="));return s.join("")};for(var t=[],e=[],n="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0;o<64;++o)t[o]=s[o],e[s.charCodeAt(o)]=o;function a(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function c(e){return t[e>>18&63]+t[e>>12&63]+t[e>>6&63]+t[63&e]}function u(t,e,r){for(var n,i=[],s=e;s<r;s+=3)n=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),i.push(c(n));return i.join("")}return e["-".charCodeAt(0)]=62,e["_".charCodeAt(0)]=63,i}var o,a,c={};
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function u(){return o||(o=1,c.read=function(t,e,r,n,i){var s,o,a=8*i-n-1,c=(1<<a)-1,u=c>>1,f=-7,h=r?i-1:0,l=r?-1:1,d=t[e+h];for(h+=l,s=d&(1<<-f)-1,d>>=-f,f+=a;f>0;s=256*s+t[e+h],h+=l,f-=8);for(o=s&(1<<-f)-1,s>>=-f,f+=n;f>0;o=256*o+t[e+h],h+=l,f-=8);if(0===s)s=1-u;else{if(s===c)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,n),s-=u}return(d?-1:1)*o*Math.pow(2,s-n)},c.write=function(t,e,r,n,i,s){var o,a,c,u=8*s-i-1,f=(1<<u)-1,h=f>>1,l=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:s-1,p=n?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=f):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),(e+=o+h>=1?l/c:l*Math.pow(2,1-h))*c>=2&&(o++,c/=2),o+h>=f?(a=0,o=f):o+h>=1?(a=(e*c-1)*Math.pow(2,i),o+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;t[r+d]=255&a,d+=p,a/=256,i-=8);for(o=o<<i|a,u+=i;u>0;t[r+d]=255&o,d+=p,o/=256,u-=8);t[r+d-p]|=128*y}),c}
/*!
	 * The buffer module from node.js, for the browser.
	 *
	 * @author   Feross Aboukhadijeh <https://feross.org>
	 * @license  MIT
	 */var f,h=(a||(a=1,function(t){const e=s(),r=u(),n="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=a,t.SlowBuffer=function(t){return+t!=t&&(t=0),a.alloc(+t)},t.INSPECT_MAX_BYTES=50;const i=2147483647;function o(t){if(t>i)throw new RangeError('The value "'+t+'" is invalid for option "size"');const e=new Uint8Array(t);return Object.setPrototypeOf(e,a.prototype),e}function a(t,e,r){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return h(t)}return c(t,e,r)}function c(t,e,r){if("string"==typeof t)return function(t,e){if("string"==typeof e&&""!==e||(e="utf8"),!a.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const r=0|y(t,e);let n=o(r);const i=n.write(t,e);return i!==r&&(n=n.slice(0,i)),n}(t,e);if(ArrayBuffer.isView(t))return function(t){if(Y(t,Uint8Array)){const e=new Uint8Array(t);return d(e.buffer,e.byteOffset,e.byteLength)}return l(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(Y(t,ArrayBuffer)||t&&Y(t.buffer,ArrayBuffer))return d(t,e,r);if("undefined"!=typeof SharedArrayBuffer&&(Y(t,SharedArrayBuffer)||t&&Y(t.buffer,SharedArrayBuffer)))return d(t,e,r);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return a.from(n,e,r);const i=function(t){if(a.isBuffer(t)){const e=0|p(t.length),r=o(e);return 0===r.length||t.copy(r,0,0,e),r}return void 0!==t.length?"number"!=typeof t.length||W(t.length)?o(0):l(t):"Buffer"===t.type&&Array.isArray(t.data)?l(t.data):void 0}(t);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return a.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function f(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function h(t){return f(t),o(t<0?0:0|p(t))}function l(t){const e=t.length<0?0:0|p(t.length),r=o(e);for(let n=0;n<e;n+=1)r[n]=255&t[n];return r}function d(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r),Object.setPrototypeOf(n,a.prototype),n}function p(t){if(t>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|t}function y(t,e){if(a.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||Y(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);const r=t.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return K(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return Z(t).length;default:if(i)return n?-1:K(t).length;e=(""+e).toLowerCase(),i=!0}}function g(t,e,r){let n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return O(this,e,r);case"utf8":case"utf-8":return T(this,e,r);case"ascii":return S(this,e,r);case"latin1":case"binary":return N(this,e,r);case"base64":return x(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function b(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function w(t,e,r,n,i){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),W(r=+r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof e&&(e=a.from(e,n)),a.isBuffer(e))return 0===e.length?-1:m(t,e,r,n,i);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):m(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function m(t,e,r,n,i){let s,o=1,a=t.length,c=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;o=2,a/=2,c/=2,r/=2}function u(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(i){let n=-1;for(s=r;s<a;s++)if(u(t,s)===u(e,-1===n?0:s-n)){if(-1===n&&(n=s),s-n+1===c)return n*o}else-1!==n&&(s-=s-n),n=-1}else for(r+c>a&&(r=a-c),s=r;s>=0;s--){let r=!0;for(let n=0;n<c;n++)if(u(t,s+n)!==u(e,n)){r=!1;break}if(r)return s}return-1}function v(t,e,r,n){r=Number(r)||0;const i=t.length-r;n?(n=Number(n))>i&&(n=i):n=i;const s=e.length;let o;for(n>s/2&&(n=s/2),o=0;o<n;++o){const n=parseInt(e.substr(2*o,2),16);if(W(n))return o;t[r+o]=n}return o}function E(t,e,r,n){return H(K(e,t.length-r),t,r,n)}function _(t,e,r,n){return H(function(t){const e=[];for(let r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function B(t,e,r,n){return H(Z(e),t,r,n)}function I(t,e,r,n){return H(function(t,e){let r,n,i;const s=[];for(let o=0;o<t.length&&!((e-=2)<0);++o)r=t.charCodeAt(o),n=r>>8,i=r%256,s.push(i),s.push(n);return s}(e,t.length-r),t,r,n)}function x(t,r,n){return 0===r&&n===t.length?e.fromByteArray(t):e.fromByteArray(t.slice(r,n))}function T(t,e,r){r=Math.min(t.length,r);const n=[];let i=e;for(;i<r;){const e=t[i];let s=null,o=e>239?4:e>223?3:e>191?2:1;if(i+o<=r){let r,n,a,c;switch(o){case 1:e<128&&(s=e);break;case 2:r=t[i+1],128==(192&r)&&(c=(31&e)<<6|63&r,c>127&&(s=c));break;case 3:r=t[i+1],n=t[i+2],128==(192&r)&&128==(192&n)&&(c=(15&e)<<12|(63&r)<<6|63&n,c>2047&&(c<55296||c>57343)&&(s=c));break;case 4:r=t[i+1],n=t[i+2],a=t[i+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(c=(15&e)<<18|(63&r)<<12|(63&n)<<6|63&a,c>65535&&c<1114112&&(s=c))}}null===s?(s=65533,o=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|1023&s),n.push(s),i+=o}return function(t){const e=t.length;if(e<=A)return String.fromCharCode.apply(String,t);let r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=A));return r}(n)}t.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=function(){try{const t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),a.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}}),a.poolSize=8192,a.from=function(t,e,r){return c(t,e,r)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array),a.alloc=function(t,e,r){return function(t,e,r){return f(t),t<=0?o(t):void 0!==e?"string"==typeof r?o(t).fill(e,r):o(t).fill(e):o(t)}(t,e,r)},a.allocUnsafe=function(t){return h(t)},a.allocUnsafeSlow=function(t){return h(t)},a.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==a.prototype},a.compare=function(t,e){if(Y(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),Y(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),!a.isBuffer(t)||!a.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let r=t.length,n=e.length;for(let i=0,s=Math.min(r,n);i<s;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0},a.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return a.alloc(0);let r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;const n=a.allocUnsafe(e);let i=0;for(r=0;r<t.length;++r){let e=t[r];if(Y(e,Uint8Array))i+e.length>n.length?(a.isBuffer(e)||(e=a.from(e)),e.copy(n,i)):Uint8Array.prototype.set.call(n,e,i);else{if(!a.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(n,i)}i+=e.length}return n},a.byteLength=y,a.prototype._isBuffer=!0,a.prototype.swap16=function(){const t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)b(this,e,e+1);return this},a.prototype.swap32=function(){const t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)b(this,e,e+3),b(this,e+1,e+2);return this},a.prototype.swap64=function(){const t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)b(this,e,e+7),b(this,e+1,e+6),b(this,e+2,e+5),b(this,e+3,e+4);return this},a.prototype.toString=function(){const t=this.length;return 0===t?"":0===arguments.length?T(this,0,t):g.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(t){if(!a.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===a.compare(this,t)},a.prototype.inspect=function(){let e="";const r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},n&&(a.prototype[n]=a.prototype.inspect),a.prototype.compare=function(t,e,r,n,i){if(Y(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),!a.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),e<0||r>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&e>=r)return 0;if(n>=i)return-1;if(e>=r)return 1;if(this===t)return 0;let s=(i>>>=0)-(n>>>=0),o=(r>>>=0)-(e>>>=0);const c=Math.min(s,o),u=this.slice(n,i),f=t.slice(e,r);for(let t=0;t<c;++t)if(u[t]!==f[t]){s=u[t],o=f[t];break}return s<o?-1:o<s?1:0},a.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},a.prototype.indexOf=function(t,e,r){return w(this,t,e,r,!0)},a.prototype.lastIndexOf=function(t,e,r){return w(this,t,e,r,!1)},a.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const i=this.length-e;if((void 0===r||r>i)&&(r=i),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let s=!1;for(;;)switch(n){case"hex":return v(this,t,e,r);case"utf8":case"utf-8":return E(this,t,e,r);case"ascii":case"latin1":case"binary":return _(this,t,e,r);case"base64":return B(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,t,e,r);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const A=4096;function S(t,e,r){let n="";r=Math.min(t.length,r);for(let i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}function N(t,e,r){let n="";r=Math.min(t.length,r);for(let i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function O(t,e,r){const n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);let i="";for(let n=e;n<r;++n)i+=X[t[n]];return i}function R(t,e,r){const n=t.slice(e,r);let i="";for(let t=0;t<n.length-1;t+=2)i+=String.fromCharCode(n[t]+256*n[t+1]);return i}function U(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function F(t,e,r,n,i,s){if(!a.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<s)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function k(t,e,r,n,i){q(e,n,i,t,r,7);let s=Number(e&BigInt(4294967295));t[r++]=s,s>>=8,t[r++]=s,s>>=8,t[r++]=s,s>>=8,t[r++]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return t[r++]=o,o>>=8,t[r++]=o,o>>=8,t[r++]=o,o>>=8,t[r++]=o,r}function L(t,e,r,n,i){q(e,n,i,t,r,7);let s=Number(e&BigInt(4294967295));t[r+7]=s,s>>=8,t[r+6]=s,s>>=8,t[r+5]=s,s>>=8,t[r+4]=s;let o=Number(e>>BigInt(32)&BigInt(4294967295));return t[r+3]=o,o>>=8,t[r+2]=o,o>>=8,t[r+1]=o,o>>=8,t[r]=o,r+8}function P(t,e,r,n,i,s){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function C(t,e,n,i,s){return e=+e,n>>>=0,s||P(t,0,n,4),r.write(t,e,n,i,23,4),n+4}function j(t,e,n,i,s){return e=+e,n>>>=0,s||P(t,0,n,8),r.write(t,e,n,i,52,8),n+8}a.prototype.slice=function(t,e){const r=this.length;(t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);const n=this.subarray(t,e);return Object.setPrototypeOf(n,a.prototype),n},a.prototype.readUintLE=a.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||U(t,e,this.length);let n=this[t],i=1,s=0;for(;++s<e&&(i*=256);)n+=this[t+s]*i;return n},a.prototype.readUintBE=a.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||U(t,e,this.length);let n=this[t+--e],i=1;for(;e>0&&(i*=256);)n+=this[t+--e]*i;return n},a.prototype.readUint8=a.prototype.readUInt8=function(t,e){return t>>>=0,e||U(t,1,this.length),this[t]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(t,e){return t>>>=0,e||U(t,2,this.length),this[t]|this[t+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(t,e){return t>>>=0,e||U(t,2,this.length),this[t]<<8|this[t+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(t,e){return t>>>=0,e||U(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(t,e){return t>>>=0,e||U(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},a.prototype.readBigUInt64LE=J(function(t){$(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||G(t,this.length-8);const n=e+256*this[++t]+65536*this[++t]+this[++t]*2**24,i=this[++t]+256*this[++t]+65536*this[++t]+r*2**24;return BigInt(n)+(BigInt(i)<<BigInt(32))}),a.prototype.readBigUInt64BE=J(function(t){$(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||G(t,this.length-8);const n=e*2**24+65536*this[++t]+256*this[++t]+this[++t],i=this[++t]*2**24+65536*this[++t]+256*this[++t]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)}),a.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||U(t,e,this.length);let n=this[t],i=1,s=0;for(;++s<e&&(i*=256);)n+=this[t+s]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*e)),n},a.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||U(t,e,this.length);let n=e,i=1,s=this[t+--n];for(;n>0&&(i*=256);)s+=this[t+--n]*i;return i*=128,s>=i&&(s-=Math.pow(2,8*e)),s},a.prototype.readInt8=function(t,e){return t>>>=0,e||U(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},a.prototype.readInt16LE=function(t,e){t>>>=0,e||U(t,2,this.length);const r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt16BE=function(t,e){t>>>=0,e||U(t,2,this.length);const r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt32LE=function(t,e){return t>>>=0,e||U(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},a.prototype.readInt32BE=function(t,e){return t>>>=0,e||U(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},a.prototype.readBigInt64LE=J(function(t){$(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||G(t,this.length-8);const n=this[t+4]+256*this[t+5]+65536*this[t+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(e+256*this[++t]+65536*this[++t]+this[++t]*2**24)}),a.prototype.readBigInt64BE=J(function(t){$(t>>>=0,"offset");const e=this[t],r=this[t+7];void 0!==e&&void 0!==r||G(t,this.length-8);const n=(e<<24)+65536*this[++t]+256*this[++t]+this[++t];return(BigInt(n)<<BigInt(32))+BigInt(this[++t]*2**24+65536*this[++t]+256*this[++t]+r)}),a.prototype.readFloatLE=function(t,e){return t>>>=0,e||U(t,4,this.length),r.read(this,t,!0,23,4)},a.prototype.readFloatBE=function(t,e){return t>>>=0,e||U(t,4,this.length),r.read(this,t,!1,23,4)},a.prototype.readDoubleLE=function(t,e){return t>>>=0,e||U(t,8,this.length),r.read(this,t,!0,52,8)},a.prototype.readDoubleBE=function(t,e){return t>>>=0,e||U(t,8,this.length),r.read(this,t,!1,52,8)},a.prototype.writeUintLE=a.prototype.writeUIntLE=function(t,e,r,n){t=+t,e>>>=0,r>>>=0,n||F(this,t,e,r,Math.pow(2,8*r)-1,0);let i=1,s=0;for(this[e]=255&t;++s<r&&(i*=256);)this[e+s]=t/i&255;return e+r},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(t,e,r,n){t=+t,e>>>=0,r>>>=0,n||F(this,t,e,r,Math.pow(2,8*r)-1,0);let i=r-1,s=1;for(this[e+i]=255&t;--i>=0&&(s*=256);)this[e+i]=t/s&255;return e+r},a.prototype.writeUint8=a.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||F(this,t,e,1,255,0),this[e]=255&t,e+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||F(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||F(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||F(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||F(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},a.prototype.writeBigUInt64LE=J(function(t,e=0){return k(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=J(function(t,e=0){return L(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e>>>=0,!n){const n=Math.pow(2,8*r-1);F(this,t,e,r,n-1,-n)}let i=0,s=1,o=0;for(this[e]=255&t;++i<r&&(s*=256);)t<0&&0===o&&0!==this[e+i-1]&&(o=1),this[e+i]=(t/s|0)-o&255;return e+r},a.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e>>>=0,!n){const n=Math.pow(2,8*r-1);F(this,t,e,r,n-1,-n)}let i=r-1,s=1,o=0;for(this[e+i]=255&t;--i>=0&&(s*=256);)t<0&&0===o&&0!==this[e+i+1]&&(o=1),this[e+i]=(t/s|0)-o&255;return e+r},a.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||F(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},a.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||F(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},a.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||F(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},a.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||F(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},a.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||F(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},a.prototype.writeBigInt64LE=J(function(t,e=0){return k(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=J(function(t,e=0){return L(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeFloatLE=function(t,e,r){return C(this,t,e,!0,r)},a.prototype.writeFloatBE=function(t,e,r){return C(this,t,e,!1,r)},a.prototype.writeDoubleLE=function(t,e,r){return j(this,t,e,!0,r)},a.prototype.writeDoubleBE=function(t,e,r){return j(this,t,e,!1,r)},a.prototype.copy=function(t,e,r,n){if(!a.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);const i=n-r;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,r,n):Uint8Array.prototype.set.call(t,this.subarray(r,n),e),i},a.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!a.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===t.length){const e=t.charCodeAt(0);("utf8"===n&&e<128||"latin1"===n)&&(t=e)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;let i;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(i=e;i<r;++i)this[i]=t;else{const s=a.isBuffer(t)?t:a.from(t,n),o=s.length;if(0===o)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(i=0;i<r-e;++i)this[i+e]=s[i%o]}return this};const M={};function V(t,e,r){M[t]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(t){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:t,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}function D(t){let e="",r=t.length;const n="-"===t[0]?1:0;for(;r>=n+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function q(t,e,r,n,i,s){if(t>r||t<e){const r="bigint"==typeof e?"n":"";let n;throw n=0===e||e===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(s+1)}${r}`:`>= -(2${r} ** ${8*(s+1)-1}${r}) and < 2 ** ${8*(s+1)-1}${r}`,new M.ERR_OUT_OF_RANGE("value",n,t)}!function(t,e,r){$(e,"offset"),void 0!==t[e]&&void 0!==t[e+r]||G(e,t.length-(r+1))}(n,i,s)}function $(t,e){if("number"!=typeof t)throw new M.ERR_INVALID_ARG_TYPE(e,"number",t)}function G(t,e,r){if(Math.floor(t)!==t)throw $(t,r),new M.ERR_OUT_OF_RANGE("offset","an integer",t);if(e<0)throw new M.ERR_BUFFER_OUT_OF_BOUNDS;throw new M.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${e}`,t)}V("ERR_BUFFER_OUT_OF_BOUNDS",function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),V("ERR_INVALID_ARG_TYPE",function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`},TypeError),V("ERR_OUT_OF_RANGE",function(t,e,r){let n=`The value of "${t}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=D(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=D(i)),i+="n"),n+=` It must be ${e}. Received ${i}`,n},RangeError);const z=/[^+/0-9A-Za-z-_]/g;function K(t,e){let r;e=e||1/0;const n=t.length;let i=null;const s=[];for(let o=0;o<n;++o){if(r=t.charCodeAt(o),r>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(o+1===n){(e-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(e-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function Z(t){return e.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(z,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function H(t,e,r,n){let i;for(i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function Y(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function W(t){return t!=t}const X=function(){const t="0123456789abcdef",e=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let i=0;i<16;++i)e[n+i]=t[r]+t[i]}return e}();function J(t){return"undefined"==typeof BigInt?Q:t}function Q(){throw new Error("BigInt not supported")}}(n)),n);!function(t){t[t.SysFatal=1]="SysFatal",t[t.SysTransient=2]="SysTransient",t[t.DestinationInvalid=3]="DestinationInvalid",t[t.CanisterReject=4]="CanisterReject",t[t.CanisterError=5]="CanisterError"}(f||(f={}));const l="abcdefghijklmnopqrstuvwxyz234567",d=Object.create(null);for(let t=0;t<32;t++)d[l[t]]=t;d[0]=d.o,d[1]=d.i;const p=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);const y="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function g(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&"Uint8Array"===t.constructor.name}function b(t,...e){if(!g(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function w(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function m(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function v(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function E(t,e){return t<<32-e|t>>>e}const _=(()=>"function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex)(),B=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function I(t){if(b(t),_)return t.toHex();let e="";for(let r=0;r<t.length;r++)e+=B[t[r]];return e}const x=48,T=57,A=65,S=70,N=97,O=102;function R(t){return t>=x&&t<=T?t-x:t>=A&&t<=S?t-(A-10):t>=N&&t<=O?t-(N-10):void 0}function U(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);if(_)return Uint8Array.fromHex(t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let e=0,i=0;e<r;e++,i+=2){const r=R(t.charCodeAt(i)),s=R(t.charCodeAt(i+1));if(void 0===r||void 0===s){const e=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+e+'" at index '+i)}n[e]=16*r+s}return n}function F(t){if("string"!=typeof t)throw new Error("string expected");return new Uint8Array((new TextEncoder).encode(t))}function k(t){return"string"==typeof t&&(t=F(t)),b(t),t}function L(...t){let e=0;for(let r=0;r<t.length;r++){const n=t[r];b(n),e+=n.length}const r=new Uint8Array(e);for(let e=0,n=0;e<t.length;e++){const i=t[e];r.set(i,n),n+=i.length}return r}class P{}function C(t){const e=e=>t().update(k(e)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function j(t=32){if(y&&"function"==typeof y.getRandomValues)return y.getRandomValues(new Uint8Array(t));if(y&&"function"==typeof y.randomBytes)return Uint8Array.from(y.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}function M(t,e,r){return t&e^~t&r}function V(t,e,r){return t&e^t&r^e&r}class D extends P{constructor(t,e,r,n){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=e,this.padOffset=r,this.isLE=n,this.buffer=new Uint8Array(t),this.view=v(this.buffer)}update(t){w(this),b(t=k(t));const{view:e,buffer:r,blockLen:n}=this,i=t.length;for(let s=0;s<i;){const o=Math.min(n-this.pos,i-s);if(o===n){const e=v(t);for(;n<=i-s;s+=n)this.process(e,s);continue}r.set(t.subarray(s,s+o),this.pos),this.pos+=o,s+=o,this.pos===n&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){w(this),function(t,e){b(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}(t,this),this.finished=!0;const{buffer:e,view:r,blockLen:n,isLE:i}=this;let{pos:s}=this;e[s++]=128,m(this.buffer.subarray(s)),this.padOffset>n-s&&(this.process(r,0),s=0);for(let t=s;t<n;t++)e[t]=0;!function(t,e,r,n){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,r,n);const i=BigInt(32),s=BigInt(4294967295),o=Number(r>>i&s),a=Number(r&s),c=n?4:0,u=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+u,a,n)}(r,n-8,BigInt(8*this.length),i),this.process(r,0);const o=v(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,u=this.get();if(c>u.length)throw new Error("_sha2: outputLen bigger than state");for(let t=0;t<c;t++)o.setUint32(4*t,u[t],i)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:r,length:n,finished:i,destroyed:s,pos:o}=this;return t.destroyed=s,t.finished=i,t.length=n,t.pos=o,n%e&&t.buffer.set(r),t}clone(){return this._cloneInto()}}const q=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),$=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),G=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),z=BigInt(2**32-1),K=BigInt(32);function Z(t,e=!1){return e?{h:Number(t&z),l:Number(t>>K&z)}:{h:0|Number(t>>K&z),l:0|Number(t&z)}}const H=(t,e,r)=>t>>>r,Y=(t,e,r)=>t<<32-r|e>>>r,W=(t,e,r)=>t>>>r|e<<32-r,X=(t,e,r)=>t<<32-r|e>>>r,J=(t,e,r)=>t<<64-r|e>>>r-32,Q=(t,e,r)=>t>>>r-32|e<<64-r;function tt(t,e,r,n){const i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:0|i}}const et=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),rt=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,nt=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),it=(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0,st=(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0),ot=(t,e,r,n,i,s)=>e+r+n+i+s+(t/2**32|0)|0,at=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ct=new Uint32Array(64);class ut extends D{constructor(t=32){super(64,t,8,!1),this.A=0|q[0],this.B=0|q[1],this.C=0|q[2],this.D=0|q[3],this.E=0|q[4],this.F=0|q[5],this.G=0|q[6],this.H=0|q[7]}get(){const{A:t,B:e,C:r,D:n,E:i,F:s,G:o,H:a}=this;return[t,e,r,n,i,s,o,a]}set(t,e,r,n,i,s,o,a){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|s,this.G=0|o,this.H=0|a}process(t,e){for(let r=0;r<16;r++,e+=4)ct[r]=t.getUint32(e,!1);for(let t=16;t<64;t++){const e=ct[t-15],r=ct[t-2],n=E(e,7)^E(e,18)^e>>>3,i=E(r,17)^E(r,19)^r>>>10;ct[t]=i+ct[t-7]+n+ct[t-16]|0}let{A:r,B:n,C:i,D:s,E:o,F:a,G:c,H:u}=this;for(let t=0;t<64;t++){const e=u+(E(o,6)^E(o,11)^E(o,25))+M(o,a,c)+at[t]+ct[t]|0,f=(E(r,2)^E(r,13)^E(r,22))+V(r,n,i)|0;u=c,c=a,a=o,o=s+e|0,s=i,i=n,n=r,r=e+f|0}r=r+this.A|0,n=n+this.B|0,i=i+this.C|0,s=s+this.D|0,o=o+this.E|0,a=a+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(r,n,i,s,o,a,c,u)}roundClean(){m(ct)}destroy(){this.set(0,0,0,0,0,0,0,0),m(this.buffer)}}class ft extends ut{constructor(){super(28),this.A=0|$[0],this.B=0|$[1],this.C=0|$[2],this.D=0|$[3],this.E=0|$[4],this.F=0|$[5],this.G=0|$[6],this.H=0|$[7]}}const ht=(()=>function(t,e=!1){const r=t.length;let n=new Uint32Array(r),i=new Uint32Array(r);for(let s=0;s<r;s++){const{h:r,l:o}=Z(t[s],e);[n[s],i[s]]=[r,o]}return[n,i]}(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))))(),lt=(()=>ht[0])(),dt=(()=>ht[1])(),pt=new Uint32Array(80),yt=new Uint32Array(80);class gt extends D{constructor(t=64){super(128,t,16,!1),this.Ah=0|G[0],this.Al=0|G[1],this.Bh=0|G[2],this.Bl=0|G[3],this.Ch=0|G[4],this.Cl=0|G[5],this.Dh=0|G[6],this.Dl=0|G[7],this.Eh=0|G[8],this.El=0|G[9],this.Fh=0|G[10],this.Fl=0|G[11],this.Gh=0|G[12],this.Gl=0|G[13],this.Hh=0|G[14],this.Hl=0|G[15]}get(){const{Ah:t,Al:e,Bh:r,Bl:n,Ch:i,Cl:s,Dh:o,Dl:a,Eh:c,El:u,Fh:f,Fl:h,Gh:l,Gl:d,Hh:p,Hl:y}=this;return[t,e,r,n,i,s,o,a,c,u,f,h,l,d,p,y]}set(t,e,r,n,i,s,o,a,c,u,f,h,l,d,p,y){this.Ah=0|t,this.Al=0|e,this.Bh=0|r,this.Bl=0|n,this.Ch=0|i,this.Cl=0|s,this.Dh=0|o,this.Dl=0|a,this.Eh=0|c,this.El=0|u,this.Fh=0|f,this.Fl=0|h,this.Gh=0|l,this.Gl=0|d,this.Hh=0|p,this.Hl=0|y}process(t,e){for(let r=0;r<16;r++,e+=4)pt[r]=t.getUint32(e),yt[r]=t.getUint32(e+=4);for(let t=16;t<80;t++){const e=0|pt[t-15],r=0|yt[t-15],n=W(e,r,1)^W(e,r,8)^H(e,0,7),i=X(e,r,1)^X(e,r,8)^Y(e,r,7),s=0|pt[t-2],o=0|yt[t-2],a=W(s,o,19)^J(s,o,61)^H(s,0,6),c=X(s,o,19)^Q(s,o,61)^Y(s,o,6),u=nt(i,c,yt[t-7],yt[t-16]),f=it(u,n,a,pt[t-7],pt[t-16]);pt[t]=0|f,yt[t]=0|u}let{Ah:r,Al:n,Bh:i,Bl:s,Ch:o,Cl:a,Dh:c,Dl:u,Eh:f,El:h,Fh:l,Fl:d,Gh:p,Gl:y,Hh:g,Hl:b}=this;for(let t=0;t<80;t++){const e=W(f,h,14)^W(f,h,18)^J(f,h,41),w=X(f,h,14)^X(f,h,18)^Q(f,h,41),m=f&l^~f&p,v=st(b,w,h&d^~h&y,dt[t],yt[t]),E=ot(v,g,e,m,lt[t],pt[t]),_=0|v,B=W(r,n,28)^J(r,n,34)^J(r,n,39),I=X(r,n,28)^Q(r,n,34)^Q(r,n,39),x=r&i^r&o^i&o,T=n&s^n&a^s&a;g=0|p,b=0|y,p=0|l,y=0|d,l=0|f,d=0|h,({h:f,l:h}=tt(0|c,0|u,0|E,0|_)),c=0|o,u=0|a,o=0|i,a=0|s,i=0|r,s=0|n;const A=et(_,I,T);r=rt(A,E,B,x),n=0|A}({h:r,l:n}=tt(0|this.Ah,0|this.Al,0|r,0|n)),({h:i,l:s}=tt(0|this.Bh,0|this.Bl,0|i,0|s)),({h:o,l:a}=tt(0|this.Ch,0|this.Cl,0|o,0|a)),({h:c,l:u}=tt(0|this.Dh,0|this.Dl,0|c,0|u)),({h:f,l:h}=tt(0|this.Eh,0|this.El,0|f,0|h)),({h:l,l:d}=tt(0|this.Fh,0|this.Fl,0|l,0|d)),({h:p,l:y}=tt(0|this.Gh,0|this.Gl,0|p,0|y)),({h:g,l:b}=tt(0|this.Hh,0|this.Hl,0|g,0|b)),this.set(r,n,i,s,o,a,c,u,f,h,l,d,p,y,g,b)}roundClean(){m(pt,yt)}destroy(){m(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const bt=C(()=>new ut),wt=C(()=>new ft),mt=C(()=>new gt),vt=bt,Et=wt;const _t="__principal__";let Bt=class t{constructor(t){this._arr=t,this._isPrincipal=!0}static anonymous(){return new this(new Uint8Array([4]))}static managementCanister(){return this.fromText("aaaaa-aa")}static selfAuthenticating(t){const e=(r=t,Et.create().update(new Uint8Array(r)).digest());var r;return new this(new Uint8Array([...e,2]))}static from(e){if("string"==typeof e)return t.fromText(e);if(Object.getPrototypeOf(e)===Uint8Array.prototype)return new t(e);if("object"==typeof e&&null!==e&&!0===e._isPrincipal)return new t(e._arr);throw new Error(`Impossible to convert ${JSON.stringify(e)} to Principal.`)}static fromHex(t){return new this((t=>{var e;return new Uint8Array((null!==(e=t.match(/.{1,2}/g))&&void 0!==e?e:[]).map(t=>parseInt(t,16)))})(t))}static fromText(t){let e=t;if(t.includes(_t)){const r=JSON.parse(t);_t in r&&(e=r[_t])}let r=function(t){let e=0,r=0;const n=new Uint8Array(4*t.length/3|0);let i=0;function s(t){let s=d[t.toLowerCase()];if(void 0===s)throw new Error(`Invalid character: ${JSON.stringify(t)}`);s<<=3,r|=s>>>e,e+=5,e>=8&&(n[i++]=r,e-=8,r=e>0?s<<5-e&255:0)}for(const e of t)s(e);return n.slice(0,i)}(e.toLowerCase().replace(/-/g,""));r=r.slice(4,r.length);const n=new this(r);if(n.toText()!==e)throw new Error(`Principal "${n.toText()}" does not have a valid checksum (original value "${e}" may not be a valid Principal ID).`);return n}static fromUint8Array(t){return new this(t)}isAnonymous(){return 1===this._arr.byteLength&&4===this._arr[0]}toUint8Array(){return this._arr}toHex(){return(t=this._arr,t.reduce((t,e)=>t+e.toString(16).padStart(2,"0"),"")).toUpperCase();var t}toText(){const t=new ArrayBuffer(4);new DataView(t).setUint32(0,function(t){const e=new Uint8Array(t);let r=-1;for(let t=0;t<e.length;t++){const n=e[t];r=p[255&(n^r)]^r>>>8}return(-1^r)>>>0}(this._arr));const e=new Uint8Array(t),r=Uint8Array.from(this._arr),n=function(t){let e=0,r=0,n="";function i(t){return e<0?r|=t>>-e:r=t<<e&248,e>3?(e-=8,1):(e<4&&(n+=l[r>>3],e+=5),0)}for(let e=0;e<t.length;)e+=i(t[e]);return n+(e<0?l[r>>3]:"")}(new Uint8Array([...e,...r])).match(/.{1,5}/g);if(!n)throw new Error;return n.join("-")}toString(){return this.toText()}toJSON(){return{[_t]:this.toText()}}compareTo(t){for(let e=0;e<Math.min(this._arr.length,t._arr.length);e++){if(this._arr[e]<t._arr[e])return"lt";if(this._arr[e]>t._arr[e])return"gt"}return this._arr.length<t._arr.length?"lt":this._arr.length>t._arr.length?"gt":"eq"}ltEq(t){const e=this.compareTo(t);return"lt"==e||"eq"==e}gtEq(t){const e=this.compareTo(t);return"gt"==e||"eq"==e}};function It(...t){const e=new Uint8Array(t.reduce((t,e)=>t+e.byteLength,0));let r=0;for(const n of t)e.set(new Uint8Array(n),r),r+=n.byteLength;return e.buffer}function xt(t){return[...new Uint8Array(t)].map(t=>t.toString(16).padStart(2,"0")).join("")}const Tt=new RegExp(/^[0-9a-fA-F]+$/);function At(t){if(!Tt.test(t))throw new Error("Invalid hexadecimal string.");const e=[...t].reduce((t,e,r)=>(t[r/2|0]=(t[r/2|0]||"")+e,t),[]).map(t=>Number.parseInt(t,16));return new Uint8Array(e).buffer}function St(t,e){if(t.byteLength!==e.byteLength)return t.byteLength-e.byteLength;const r=new Uint8Array(t),n=new Uint8Array(e);for(let t=0;t<r.length;t++)if(r[t]!==n[t])return r[t]-n[t];return 0}function Nt(t,e){return 0===St(t,e)}function Ot(t){return new DataView(t.buffer,t.byteOffset,t.byteLength).buffer}function Rt(t){return t instanceof Uint8Array?Ot(t):t instanceof ArrayBuffer?t:Array.isArray(t)?Ot(new Uint8Array(t)):"buffer"in t?Rt(t.buffer):Ot(new Uint8Array(t))}class Ut extends Error{constructor(t){super(t),this.message=t,this.name="AgentError",this.__proto__=Ut.prototype,Object.setPrototypeOf(this,Ut.prototype)}}function Ft(...t){const e=new Uint8Array(t.reduce((t,e)=>t+e.byteLength,0));let r=0;for(const n of t)e.set(new Uint8Array(n),r),r+=n.byteLength;return e}class kt{constructor(t,e=(null==t?void 0:t.byteLength)||0){this._buffer=Pt(t||new ArrayBuffer(0)),this._view=new Uint8Array(this._buffer,0,e)}save(){return this._view}restore(t){this._view=t}get buffer(){return Pt(this._view.slice())}get byteLength(){return this._view.byteLength}read(t){const e=this._view.subarray(0,t);return this._view=this._view.subarray(t),e.slice().buffer}readUint8(){const t=this._view[0];return this._view=this._view.subarray(1),t}write(t){const e=new Uint8Array(t),r=this._view.byteLength;this._view.byteOffset+this._view.byteLength+e.byteLength>=this._buffer.byteLength?this.alloc(e.byteLength):this._view=new Uint8Array(this._buffer,this._view.byteOffset,this._view.byteLength+e.byteLength),this._view.set(e,r)}get end(){return 0===this._view.byteLength}alloc(t){const e=new ArrayBuffer(1.2*(this._buffer.byteLength+t)|0),r=new Uint8Array(e,0,this._view.byteLength+t);r.set(this._view),this._buffer=e,this._view=r}}function Lt(t){return new DataView(t.buffer,t.byteOffset,t.byteLength).buffer}function Pt(t){return t instanceof Uint8Array?Lt(t):t instanceof ArrayBuffer?t:Array.isArray(t)?Lt(new Uint8Array(t)):"buffer"in t?Pt(t.buffer):Lt(new Uint8Array(t))}function Ct(t){if(/^_\d+_$/.test(t)||/^_0x[0-9a-fA-F]+_$/.test(t)){const e=+t.slice(1,-1);if(Number.isSafeInteger(e)&&e>=0&&e<2**32)return e}return function(t){const e=(new TextEncoder).encode(t);let r=0;for(const t of e)r=(223*r+t)%2**32;return r}(t)}function jt(){throw new Error("unexpected end of buffer")}function Mt(t,e){return t.byteLength<e&&jt(),t.read(e)}function Vt(t){const e=t.readUint8();return void 0===e&&jt(),e}function Dt(t){if("number"==typeof t&&(t=BigInt(t)),t<BigInt(0))throw new Error("Cannot leb encode negative values.");const e=(t===BigInt(0)?0:Math.ceil(Math.log2(Number(t))))+1,r=new kt(new ArrayBuffer(e),0);for(;;){const e=Number(t&BigInt(127));if((t/=BigInt(128))===BigInt(0)){r.write(new Uint8Array([e]));break}r.write(new Uint8Array([128|e]))}return r.buffer}function qt(t){let e,r=BigInt(1),n=BigInt(0);do{e=Vt(t),n+=BigInt(127&e).valueOf()*r,r*=BigInt(128)}while(e>=128);return n}function $t(t){"number"==typeof t&&(t=BigInt(t));const e=t<BigInt(0);e&&(t=-t-BigInt(1));const r=(t===BigInt(0)?0:Math.ceil(Math.log2(Number(t))))+1,n=new kt(new ArrayBuffer(r),0);for(;;){const r=i(t);if(t/=BigInt(128),e&&t===BigInt(0)&&64&r||!e&&t===BigInt(0)&&!(64&r)){n.write(new Uint8Array([r]));break}n.write(new Uint8Array([128|r]))}function i(t){const r=t%BigInt(128);return Number(e?BigInt(128)-r-BigInt(1):r)}return n.buffer}function Gt(t){const e=new Uint8Array(t.buffer);let r=0;for(;r<e.byteLength;r++)if(e[r]<128){if(!(64&e[r]))return qt(t);break}const n=new Uint8Array(Mt(t,r+1));let i=BigInt(0);for(let t=n.byteLength-1;t>=0;t--)i=i*BigInt(128)+BigInt(128-(127&n[t])-1);return-i-BigInt(1)}function zt(t,e){t=BigInt(t);const r=new kt(new ArrayBuffer(Math.min(1,e)),0);let n=0,i=BigInt(256),s=BigInt(0),o=Number(t%i);for(r.write(new Uint8Array([o]));++n<e;)t<0&&s===BigInt(0)&&0!==o&&(s=BigInt(1)),o=Number((t/i-s)%BigInt(256)),r.write(new Uint8Array([o])),i*=BigInt(256);return r.buffer}function Kt(t,e){let r=BigInt(Vt(t)),n=BigInt(1),i=0;for(;++i<e;){n*=BigInt(256);r+=n*BigInt(Vt(t))}return r}function Zt(t){const e=BigInt(t);if(t<0)throw new RangeError("Input must be non-negative");return BigInt(1)<<e}const Ht="DIDL";function Yt(t,e,r){return t.map((t,n)=>r(t,e[n]))}class Wt{constructor(){this._typs=[],this._idx=new Map}has(t){return this._idx.has(t.name)}add(t,e){const r=this._typs.length;this._idx.set(t.name,r),this._typs.push(e)}merge(t,e){const r=this._idx.get(t.name),n=this._idx.get(e);if(void 0===r)throw new Error("Missing type index for "+t);if(void 0===n)throw new Error("Missing type index for "+e);this._typs[r]=this._typs[n],this._typs.splice(n,1),this._idx.delete(e)}encode(){const t=Dt(this._typs.length),e=Ft(...this._typs);return Ft(t,e)}indexOf(t){if(!this._idx.has(t))throw new Error("Missing type index for "+t);return $t(this._idx.get(t)||0)}}class Xt{display(){return this.name}valueToString(t){return Ee(t)}buildTypeTable(t){t.has(this)||this._buildTypeTableImpl(t)}}class Jt extends Xt{checkType(t){if(this.name!==t.name)throw new Error(`type mismatch: type on the wire ${t.name}, expect type ${this.name}`);return t}_buildTypeTableImpl(t){}}class Qt extends Xt{checkType(t){if(t instanceof ge){const e=t.getType();if(void 0===e)throw new Error("type mismatch with uninitialized type");return e}throw new Error(`type mismatch: type on the wire ${t.name}, expect type ${this.name}`)}encodeType(t){return t.indexOf(this.name)}}class te extends Jt{accept(t,e){return t.visitEmpty(this,e)}covariant(t){throw new Error(`Invalid ${this.display()} argument: ${Ee(t)}`)}encodeValue(){throw new Error("Empty cannot appear as a function argument")}valueToString(){throw new Error("Empty cannot appear as a value")}encodeType(){return $t(-17)}decodeValue(){throw new Error("Empty cannot appear as an output")}get name(){return"empty"}}class ee extends Xt{checkType(t){throw new Error("Method not implemented for unknown.")}accept(t,e){throw t.visitType(this,e)}covariant(t){throw new Error(`Invalid ${this.display()} argument: ${Ee(t)}`)}encodeValue(){throw new Error("Unknown cannot appear as a function argument")}valueToString(){throw new Error("Unknown cannot appear as a value")}encodeType(){throw new Error("Unknown cannot be serialized")}decodeValue(t,e){let r,n=e.decodeValue(t,e);return Object(n)!==n&&(n=Object(n)),r=e instanceof ge?()=>e.getType():()=>e,Object.defineProperty(n,"type",{value:r,writable:!0,enumerable:!1,configurable:!0}),n}_buildTypeTableImpl(){throw new Error("Unknown cannot be serialized")}get name(){return"Unknown"}}class re extends Jt{accept(t,e){return t.visitBool(this,e)}covariant(t){if("boolean"==typeof t)return!0;throw new Error(`Invalid ${this.display()} argument: ${Ee(t)}`)}encodeValue(t){return new Uint8Array([t?1:0])}encodeType(){return $t(-2)}decodeValue(t,e){switch(this.checkType(e),Vt(t)){case 0:return!1;case 1:return!0;default:throw new Error("Boolean value out of range")}}get name(){return"bool"}}class ne extends Jt{accept(t,e){return t.visitNull(this,e)}covariant(t){if(null===t)return!0;throw new Error(`Invalid ${this.display()} argument: ${Ee(t)}`)}encodeValue(){return new ArrayBuffer(0)}encodeType(){return $t(-1)}decodeValue(t,e){return this.checkType(e),null}get name(){return"null"}}class ie extends Jt{accept(t,e){return t.visitReserved(this,e)}covariant(t){return!0}encodeValue(){return new ArrayBuffer(0)}encodeType(){return $t(-16)}decodeValue(t,e){return e.name!==this.name&&e.decodeValue(t,e),null}get name(){return"reserved"}}class se extends Jt{accept(t,e){return t.visitText(this,e)}covariant(t){if("string"==typeof t)return!0;throw new Error(`Invalid ${this.display()} argument: ${Ee(t)}`)}encodeValue(t){const e=(new TextEncoder).encode(t);return Ft(Dt(e.byteLength),e)}encodeType(){return $t(-15)}decodeValue(t,e){this.checkType(e);const r=qt(t),n=Mt(t,Number(r));return new TextDecoder("utf8",{fatal:!0}).decode(n)}get name(){return"text"}valueToString(t){return'"'+t+'"'}}class oe extends Jt{accept(t,e){return t.visitInt(this,e)}covariant(t){if("bigint"==typeof t||Number.isInteger(t))return!0;throw new Error(`Invalid ${this.display()} argument: ${Ee(t)}`)}encodeValue(t){return $t(t)}encodeType(){return $t(-4)}decodeValue(t,e){return this.checkType(e),Gt(t)}get name(){return"int"}valueToString(t){return t.toString()}}class ae extends Jt{accept(t,e){return t.visitNat(this,e)}covariant(t){if("bigint"==typeof t&&t>=BigInt(0)||Number.isInteger(t)&&t>=0)return!0;throw new Error(`Invalid ${this.display()} argument: ${Ee(t)}`)}encodeValue(t){return Dt(t)}encodeType(){return $t(-3)}decodeValue(t,e){return this.checkType(e),qt(t)}get name(){return"nat"}valueToString(t){return t.toString()}}class ce extends Jt{constructor(t){if(super(),this._bits=t,32!==t&&64!==t)throw new Error("not a valid float type")}accept(t,e){return t.visitFloat(this,e)}covariant(t){if("number"==typeof t||t instanceof Number)return!0;throw new Error(`Invalid ${this.display()} argument: ${Ee(t)}`)}encodeValue(t){const e=new ArrayBuffer(this._bits/8),r=new DataView(e);return 32===this._bits?r.setFloat32(0,t,!0):r.setFloat64(0,t,!0),e}encodeType(){return $t(32===this._bits?-13:-14)}decodeValue(t,e){this.checkType(e);const r=Mt(t,this._bits/8),n=new DataView(r);return 32===this._bits?n.getFloat32(0,!0):n.getFloat64(0,!0)}get name(){return"float"+this._bits}valueToString(t){return t.toString()}}class ue extends Jt{constructor(t){super(),this._bits=t}accept(t,e){return t.visitFixedInt(this,e)}covariant(t){const e=Zt(this._bits-1)*BigInt(-1),r=Zt(this._bits-1)-BigInt(1);let n=!1;if("bigint"==typeof t)n=t>=e&&t<=r;else if(Number.isInteger(t)){const i=BigInt(t);n=i>=e&&i<=r}else n=!1;if(n)return!0;throw new Error(`Invalid ${this.display()} argument: ${Ee(t)}`)}encodeValue(t){return zt(t,this._bits/8)}encodeType(){return $t(-9-(Math.log2(this._bits)-3))}decodeValue(t,e){this.checkType(e);const r=function(t,e){let r=Kt(t,e);const n=BigInt(2)**(BigInt(8)*BigInt(e-1)+BigInt(7));return r>=n&&(r-=n*BigInt(2)),r}(t,this._bits/8);return this._bits<=32?Number(r):r}get name(){return`int${this._bits}`}valueToString(t){return t.toString()}}class fe extends Jt{constructor(t){super(),this._bits=t}accept(t,e){return t.visitFixedNat(this,e)}covariant(t){const e=Zt(this._bits);let r=!1;if("bigint"==typeof t&&t>=BigInt(0))r=t<e;else if(Number.isInteger(t)&&t>=0){r=BigInt(t)<e}else r=!1;if(r)return!0;throw new Error(`Invalid ${this.display()} argument: ${Ee(t)}`)}encodeValue(t){return function(t,e){if(BigInt(t)<BigInt(0))throw new Error("Cannot write negative values.");return zt(t,e)}(t,this._bits/8)}encodeType(){return $t(-5-(Math.log2(this._bits)-3))}decodeValue(t,e){this.checkType(e);const r=Kt(t,this._bits/8);return this._bits<=32?Number(r):r}get name(){return`nat${this._bits}`}valueToString(t){return t.toString()}}class he extends Qt{constructor(t){super(),this._type=t,this._blobOptimization=!1,t instanceof fe&&8===t._bits&&(this._blobOptimization=!0)}accept(t,e){return t.visitVec(this,this._type,e)}covariant(t){const e=this._type instanceof fe||this._type instanceof ue?this._type._bits:0;if(ArrayBuffer.isView(t)&&e==8*t.BYTES_PER_ELEMENT||Array.isArray(t)&&t.every((t,e)=>{try{return this._type.covariant(t)}catch(t){throw new Error(`Invalid ${this.display()} argument: \n\nindex ${e} -> ${t.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${Ee(t)}`)}encodeValue(t){const e=Dt(t.length);if(this._blobOptimization)return Ft(e,new Uint8Array(t));if(ArrayBuffer.isView(t))return Ft(e,new Uint8Array(t.buffer));const r=new kt(new ArrayBuffer(e.byteLength+t.length),0);r.write(e);for(const e of t){const t=this._type.encodeValue(e);r.write(new Uint8Array(t))}return r.buffer}_buildTypeTableImpl(t){this._type.buildTypeTable(t);const e=$t(-19),r=this._type.encodeType(t);t.add(this,Ft(e,r))}decodeValue(t,e){const r=this.checkType(e);if(!(r instanceof he))throw new Error("Not a vector type");const n=Number(qt(t));if(this._type instanceof fe){if(8==this._type._bits)return new Uint8Array(t.read(n));if(16==this._type._bits)return new Uint16Array(t.read(2*n));if(32==this._type._bits)return new Uint32Array(t.read(4*n));if(64==this._type._bits)return new BigUint64Array(t.read(8*n))}if(this._type instanceof ue){if(8==this._type._bits)return new Int8Array(t.read(n));if(16==this._type._bits)return new Int16Array(t.read(2*n));if(32==this._type._bits)return new Int32Array(t.read(4*n));if(64==this._type._bits)return new BigInt64Array(t.read(8*n))}const i=[];for(let e=0;e<n;e++)i.push(this._type.decodeValue(t,r._type));return i}get name(){return`vec ${this._type.name}`}display(){return`vec ${this._type.display()}`}valueToString(t){return"vec {"+t.map(t=>this._type.valueToString(t)).join("; ")+"}"}}class le extends Qt{constructor(t){super(),this._type=t}accept(t,e){return t.visitOpt(this,this._type,e)}covariant(t){try{if(Array.isArray(t)&&(0===t.length||1===t.length&&this._type.covariant(t[0])))return!0}catch(e){throw new Error(`Invalid ${this.display()} argument: ${Ee(t)} \n\n-> ${e.message}`)}throw new Error(`Invalid ${this.display()} argument: ${Ee(t)}`)}encodeValue(t){return 0===t.length?new Uint8Array([0]):Ft(new Uint8Array([1]),this._type.encodeValue(t[0]))}_buildTypeTableImpl(t){this._type.buildTypeTable(t);const e=$t(-18),r=this._type.encodeType(t);t.add(this,Ft(e,r))}decodeValue(t,e){if(e instanceof ne)return[];if(e instanceof ie)return[];let r=e;if(e instanceof ge){const t=e.getType();if(void 0===t)throw new Error("type mismatch with uninitialized type");r=t}if(r instanceof le)switch(Vt(t)){case 0:return[];case 1:{const e=t.save();try{return[this._type.decodeValue(t,r._type)]}catch(n){return t.restore(e),r._type.decodeValue(t,r._type),[]}}default:throw new Error("Not an option value")}else{if(this._type instanceof ne||this._type instanceof le||this._type instanceof ie)return r.decodeValue(t,r),[];{const n=t.save();try{return[this._type.decodeValue(t,e)]}catch(i){return t.restore(n),r.decodeValue(t,e),[]}}}}get name(){return`opt ${this._type.name}`}display(){return`opt ${this._type.display()}`}valueToString(t){return 0===t.length?"null":`opt ${this._type.valueToString(t[0])}`}}class de extends Qt{constructor(t={}){super(),this._fields=Object.entries(t).sort((t,e)=>Ct(t[0])-Ct(e[0]))}accept(t,e){return t.visitRecord(this,this._fields,e)}tryAsTuple(){const t=[];for(let e=0;e<this._fields.length;e++){const[r,n]=this._fields[e];if(r!==`_${e}_`)return null;t.push(n)}return t}covariant(t){if("object"==typeof t&&this._fields.every(([e,r])=>{if(!t.hasOwnProperty(e))throw new Error(`Record is missing key "${e}".`);try{return r.covariant(t[e])}catch(t){throw new Error(`Invalid ${this.display()} argument: \n\nfield ${e} -> ${t.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${Ee(t)}`)}encodeValue(t){const e=this._fields.map(([e])=>t[e]);return Ft(...Yt(this._fields,e,([,t],e)=>t.encodeValue(e)))}_buildTypeTableImpl(t){this._fields.forEach(([e,r])=>r.buildTypeTable(t));const e=$t(-20),r=Dt(this._fields.length),n=this._fields.map(([e,r])=>Ft(Dt(Ct(e)),r.encodeType(t)));t.add(this,Ft(e,r,Ft(...n)))}decodeValue(t,e){const r=this.checkType(e);if(!(r instanceof de))throw new Error("Not a record type");const n={};let i=0,s=0;for(;s<r._fields.length;){const[e,o]=r._fields[s];if(i>=this._fields.length){o.decodeValue(t,o),s++;continue}const[a,c]=this._fields[i],u=Ct(this._fields[i][0]),f=Ct(e);if(u===f)n[a]=c.decodeValue(t,o),i++,s++;else if(f>u){if(!(c instanceof le||c instanceof ie))throw new Error("Cannot find required field "+a);n[a]=[],i++}else o.decodeValue(t,o),s++}for(const[t,e]of this._fields.slice(i)){if(!(e instanceof le||e instanceof ie))throw new Error("Cannot find required field "+t);n[t]=[]}return n}get name(){const t=this._fields.map(([t,e])=>t+":"+e.name);return`record {${t.join("; ")}}`}display(){const t=this._fields.map(([t,e])=>t+":"+e.display());return`record {${t.join("; ")}}`}valueToString(t){const e=this._fields.map(([e])=>t[e]);return`record {${Yt(this._fields,e,([t,e],r)=>t+"="+e.valueToString(r)).join("; ")}}`}}class pe extends de{constructor(t){const e={};t.forEach((t,r)=>e["_"+r+"_"]=t),super(e),this._components=t}accept(t,e){return t.visitTuple(this,this._components,e)}covariant(t){if(Array.isArray(t)&&t.length>=this._fields.length&&this._components.every((e,r)=>{try{return e.covariant(t[r])}catch(t){throw new Error(`Invalid ${this.display()} argument: \n\nindex ${r} -> ${t.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${Ee(t)}`)}encodeValue(t){return Ft(...Yt(this._components,t,(t,e)=>t.encodeValue(e)))}decodeValue(t,e){const r=this.checkType(e);if(!(r instanceof pe))throw new Error("not a tuple type");if(r._components.length<this._components.length)throw new Error("tuple mismatch");const n=[];for(const[e,i]of r._components.entries())e>=this._components.length?i.decodeValue(t,i):n.push(this._components[e].decodeValue(t,i));return n}display(){const t=this._components.map(t=>t.display());return`record {${t.join("; ")}}`}valueToString(t){return`record {${Yt(this._components,t,(t,e)=>t.valueToString(e)).join("; ")}}`}}class ye extends Qt{constructor(t={}){super(),this._fields=Object.entries(t).sort((t,e)=>Ct(t[0])-Ct(e[0]))}accept(t,e){return t.visitVariant(this,this._fields,e)}covariant(t){if("object"==typeof t&&1===Object.entries(t).length&&this._fields.every(([e,r])=>{try{return!t.hasOwnProperty(e)||r.covariant(t[e])}catch(t){throw new Error(`Invalid ${this.display()} argument: \n\nvariant ${e} -> ${t.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${Ee(t)}`)}encodeValue(t){for(let e=0;e<this._fields.length;e++){const[r,n]=this._fields[e];if(t.hasOwnProperty(r)){return Ft(Dt(e),n.encodeValue(t[r]))}}throw Error("Variant has no data: "+t)}_buildTypeTableImpl(t){this._fields.forEach(([,e])=>{e.buildTypeTable(t)});const e=$t(-21),r=Dt(this._fields.length),n=this._fields.map(([e,r])=>Ft(Dt(Ct(e)),r.encodeType(t)));t.add(this,Ft(e,r,...n))}decodeValue(t,e){const r=this.checkType(e);if(!(r instanceof ye))throw new Error("Not a variant type");const n=Number(qt(t));if(n>=r._fields.length)throw Error("Invalid variant index: "+n);const[i,s]=r._fields[n];for(const[e,r]of this._fields)if(Ct(i)===Ct(e)){const n=r.decodeValue(t,s);return{[e]:n}}throw new Error("Cannot find field hash "+i)}get name(){return`variant {${this._fields.map(([t,e])=>t+":"+e.name).join("; ")}}`}display(){return`variant {${this._fields.map(([t,e])=>t+("null"===e.name?"":`:${e.display()}`)).join("; ")}}`}valueToString(t){for(const[e,r]of this._fields)if(t.hasOwnProperty(e)){const n=r.valueToString(t[e]);return"null"===n?`variant {${e}}`:`variant {${e}=${n}}`}throw new Error("Variant has no data: "+t)}}class ge extends Qt{constructor(){super(...arguments),this._id=ge._counter++,this._type=void 0}accept(t,e){if(!this._type)throw Error("Recursive type uninitialized.");return t.visitRec(this,this._type,e)}fill(t){this._type=t}getType(){return this._type}covariant(t){if(this._type&&this._type.covariant(t))return!0;throw new Error(`Invalid ${this.display()} argument: ${Ee(t)}`)}encodeValue(t){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.encodeValue(t)}_buildTypeTableImpl(t){if(!this._type)throw Error("Recursive type uninitialized.");t.add(this,new Uint8Array([])),this._type.buildTypeTable(t),t.merge(this,this._type.name)}decodeValue(t,e){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.decodeValue(t,e)}get name(){return`rec_${this._id}`}display(){if(!this._type)throw Error("Recursive type uninitialized.");return`μ${this.name}.${this._type.name}`}valueToString(t){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.valueToString(t)}}function be(t){if(1!==Vt(t))throw new Error("Cannot decode principal");const e=Number(qt(t));return Bt.fromUint8Array(new Uint8Array(Mt(t,e)))}ge._counter=0;class we extends Jt{accept(t,e){return t.visitPrincipal(this,e)}covariant(t){if(t&&t._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${Ee(t)}`)}encodeValue(t){const e=t.toUint8Array(),r=Dt(e.byteLength);return Ft(new Uint8Array([1]),r,e)}encodeType(){return $t(-24)}decodeValue(t,e){return this.checkType(e),be(t)}get name(){return"principal"}valueToString(t){return`${this.name} "${t.toText()}"`}}class me extends Qt{constructor(t,e,r=[]){super(),this.argTypes=t,this.retTypes=e,this.annotations=r}static argsToString(t,e){if(t.length!==e.length)throw new Error("arity mismatch");return"("+t.map((t,r)=>t.valueToString(e[r])).join(", ")+")"}accept(t,e){return t.visitFunc(this,e)}covariant(t){if(Array.isArray(t)&&2===t.length&&t[0]&&t[0]._isPrincipal&&"string"==typeof t[1])return!0;throw new Error(`Invalid ${this.display()} argument: ${Ee(t)}`)}encodeValue([t,e]){const r=t.toUint8Array(),n=Dt(r.byteLength),i=Ft(new Uint8Array([1]),n,r),s=(new TextEncoder).encode(e),o=Dt(s.byteLength);return Ft(new Uint8Array([1]),i,o,s)}_buildTypeTableImpl(t){this.argTypes.forEach(e=>e.buildTypeTable(t)),this.retTypes.forEach(e=>e.buildTypeTable(t));const e=$t(-22),r=Dt(this.argTypes.length),n=Ft(...this.argTypes.map(e=>e.encodeType(t))),i=Dt(this.retTypes.length),s=Ft(...this.retTypes.map(e=>e.encodeType(t))),o=Dt(this.annotations.length),a=Ft(...this.annotations.map(t=>this.encodeAnnotation(t)));t.add(this,Ft(e,r,n,i,s,o,a))}decodeValue(t){if(1!==Vt(t))throw new Error("Cannot decode function reference");const e=be(t),r=Mt(t,Number(qt(t)));return[e,new TextDecoder("utf8",{fatal:!0}).decode(r)]}get name(){return`(${this.argTypes.map(t=>t.name).join(", ")}) -> (${this.retTypes.map(t=>t.name).join(", ")})${" "+this.annotations.join(" ")}`}valueToString([t,e]){return`func "${t.toText()}".${e}`}display(){return`(${this.argTypes.map(t=>t.display()).join(", ")}) → (${this.retTypes.map(t=>t.display()).join(", ")})${" "+this.annotations.join(" ")}`}encodeAnnotation(t){if("query"===t)return new Uint8Array([1]);if("oneway"===t)return new Uint8Array([2]);if("composite_query"===t)return new Uint8Array([3]);throw new Error("Illegal function annotation")}}class ve extends Qt{constructor(t){super(),this._fields=Object.entries(t).sort((t,e)=>t[0]<e[0]?-1:t[0]>e[0]?1:0)}accept(t,e){return t.visitService(this,e)}covariant(t){if(t&&t._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${Ee(t)}`)}encodeValue(t){const e=t.toUint8Array(),r=Dt(e.length);return Ft(new Uint8Array([1]),r,e)}_buildTypeTableImpl(t){this._fields.forEach(([e,r])=>r.buildTypeTable(t));const e=$t(-23),r=Dt(this._fields.length),n=this._fields.map(([e,r])=>{const n=(new TextEncoder).encode(e);return Ft(Dt(n.length),n,r.encodeType(t))});t.add(this,Ft(e,r,...n))}decodeValue(t){return be(t)}get name(){const t=this._fields.map(([t,e])=>t+":"+e.name);return`service {${t.join("; ")}}`}valueToString(t){return`service "${t.toText()}"`}}function Ee(t){const e=JSON.stringify(t,(t,e)=>"bigint"==typeof e?`BigInt(${e})`:e);return e&&e.length>400?e.substring(0,397)+"...":e}function _e(t,e){if(e.length<t.length)throw Error("Wrong number of message arguments");const r=new Wt;t.forEach(t=>t.buildTypeTable(r));const n=(new TextEncoder).encode(Ht),i=r.encode(),s=Dt(e.length),o=Ft(...t.map(t=>t.encodeType(r))),a=Ft(...Yt(t,e,(t,e)=>{try{t.covariant(e)}catch(t){throw new Error(t.message+"\n\n")}return t.encodeValue(e)}));return Ft(n,i,s,o,a)}function Be(t,e){const r=new kt(e);if(e.byteLength<4)throw new Error("Message length smaller than magic number");const n=Mt(r,4),i=(new TextDecoder).decode(n);if(i!==Ht)throw new Error("Wrong magic number: "+JSON.stringify(i));const[s,o]=function(t){const e=[],r=Number(qt(t));for(let n=0;n<r;n++){const r=Number(Gt(t));switch(r){case-18:case-19:{const n=Number(Gt(t));e.push([r,n]);break}case-20:case-21:{const n=[];let i,s=Number(qt(t));for(;s--;){const e=Number(qt(t));if(e>=Math.pow(2,32))throw new Error("field id out of 32-bit range");if("number"==typeof i&&i>=e)throw new Error("field id collision or not sorted");i=e;const r=Number(Gt(t));n.push([e,r])}e.push([r,n]);break}case-22:{const n=[];let i=Number(qt(t));for(;i--;)n.push(Number(Gt(t)));const s=[];let o=Number(qt(t));for(;o--;)s.push(Number(Gt(t)));const a=[];let c=Number(qt(t));for(;c--;){switch(Number(qt(t))){case 1:a.push("query");break;case 2:a.push("oneway");break;case 3:a.push("composite_query");break;default:throw new Error("unknown annotation")}}e.push([r,[n,s,a]]);break}case-23:{let n=Number(qt(t));const i=[];for(;n--;){const e=Number(qt(t)),r=(new TextDecoder).decode(Mt(t,e)),n=Gt(t);i.push([r,n])}e.push([r,i]);break}default:throw new Error("Illegal op_code: "+r)}}const n=[],i=Number(qt(t));for(let e=0;e<i;e++)n.push(Number(Gt(t)));return[e,n]}(r);if(o.length<t.length)throw new Error("Wrong number of return values");const a=s.map(t=>He());function c(t){if(t<-24)throw new Error("future value not supported");if(t<0)switch(t){case-1:return Se;case-2:return Ae;case-3:return Re;case-4:return Oe;case-5:return je;case-6:return Me;case-7:return Ve;case-8:return De;case-9:return ke;case-10:return Le;case-11:return Pe;case-12:return Ce;case-13:return Ue;case-14:return Fe;case-15:return Ne;case-16:return xe;case-17:return Ie;case-24:return qe;default:throw new Error("Illegal op_code: "+t)}if(t>=s.length)throw new Error("type index out of range");return a[t]}function u(t){switch(t[0]){case-19:return Ge(c(t[1]));case-18:return ze(c(t[1]));case-20:{const e={};for(const[r,n]of t[1]){e[`_${r}_`]=c(n)}const r=Ke(e),n=r.tryAsTuple();return Array.isArray(n)?$e(...n):r}case-21:{const e={};for(const[r,n]of t[1]){e[`_${r}_`]=c(n)}return Ze(e)}case-22:{const[e,r,n]=t[1];return Ye(e.map(t=>c(t)),r.map(t=>c(t)),n)}case-23:{const e={},r=t[1];for(const[t,n]of r){let r=c(n);if(r instanceof ge&&(r=r.getType()),!(r instanceof me))throw new Error("Illegal service definition: services can only contain functions");e[t]=r}return We(e)}default:throw new Error("Illegal op_code: "+t[0])}}s.forEach((t,e)=>{if(-22===t[0]){const r=u(t);a[e].fill(r)}}),s.forEach((t,e)=>{if(-22!==t[0]){const r=u(t);a[e].fill(r)}});const f=o.map(t=>c(t)),h=t.map((t,e)=>t.decodeValue(r,f[e]));for(let e=t.length;e<f.length;e++)f[e].decodeValue(r,f[e]);if(r.byteLength>0)throw new Error("decode: Left-over bytes");return h}const Ie=new te,xe=new ie,Te=new ee,Ae=new re,Se=new ne,Ne=new se,Oe=new oe,Re=new ae,Ue=new ce(32),Fe=new ce(64),ke=new ue(8),Le=new ue(16),Pe=new ue(32),Ce=new ue(64),je=new fe(8),Me=new fe(16),Ve=new fe(32),De=new fe(64),qe=new we;function $e(...t){return new pe(t)}function Ge(t){return new he(t)}function ze(t){return new le(t)}function Ke(t){return new de(t)}function Ze(t){return new ye(t)}function He(){return new ge}function Ye(t,e,r=[]){return new me(t,e,r)}function We(t){return new ve(t)}var Xe,Je=Object.freeze({__proto__:null,Bool:Ae,BoolClass:re,ConstructType:Qt,Empty:Ie,EmptyClass:te,FixedIntClass:ue,FixedNatClass:fe,Float32:Ue,Float64:Fe,FloatClass:ce,Func:Ye,FuncClass:me,Int:Oe,Int16:Le,Int32:Pe,Int64:Ce,Int8:ke,IntClass:oe,Nat:Re,Nat16:Me,Nat32:Ve,Nat64:De,Nat8:je,NatClass:ae,Null:Se,NullClass:ne,Opt:ze,OptClass:le,PrimitiveType:Jt,Principal:qe,PrincipalClass:we,Rec:He,RecClass:ge,Record:Ke,RecordClass:de,Reserved:xe,ReservedClass:ie,Service:We,ServiceClass:ve,Text:Ne,TextClass:se,Tuple:$e,TupleClass:pe,Type:Xt,Unknown:Te,UnknownClass:ee,Variant:Ze,VariantClass:ye,Vec:Ge,VecClass:he,Visitor:class{visitType(t,e){throw new Error("Not implemented")}visitPrimitive(t,e){return this.visitType(t,e)}visitEmpty(t,e){return this.visitPrimitive(t,e)}visitBool(t,e){return this.visitPrimitive(t,e)}visitNull(t,e){return this.visitPrimitive(t,e)}visitReserved(t,e){return this.visitPrimitive(t,e)}visitText(t,e){return this.visitPrimitive(t,e)}visitNumber(t,e){return this.visitPrimitive(t,e)}visitInt(t,e){return this.visitNumber(t,e)}visitNat(t,e){return this.visitNumber(t,e)}visitFloat(t,e){return this.visitPrimitive(t,e)}visitFixedInt(t,e){return this.visitNumber(t,e)}visitFixedNat(t,e){return this.visitNumber(t,e)}visitPrincipal(t,e){return this.visitPrimitive(t,e)}visitConstruct(t,e){return this.visitType(t,e)}visitVec(t,e,r){return this.visitConstruct(t,r)}visitOpt(t,e,r){return this.visitConstruct(t,r)}visitRecord(t,e,r){return this.visitConstruct(t,r)}visitTuple(t,e,r){const n=e.map((t,e)=>[`_${e}_`,t]);return this.visitRecord(t,n,r)}visitVariant(t,e,r){return this.visitConstruct(t,r)}visitRec(t,e,r){return this.visitConstruct(e,r)}visitFunc(t,e){return this.visitConstruct(t,e)}visitService(t,e){return this.visitConstruct(t,e)}},decode:Be,encode:_e}),Qe={},tr={};function er(){return Xe||(Xe=1,function(t){var e=s(),r=u(),n="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=a,t.SlowBuffer=function(t){+t!=t&&(t=0);return a.alloc(+t)},t.INSPECT_MAX_BYTES=50;var i=2147483647;function o(t){if(t>i)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,a.prototype),e}function a(t,e,r){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return h(t)}return c(t,e,r)}function c(t,e,r){if("string"==typeof t)return function(t,e){"string"==typeof e&&""!==e||(e="utf8");if(!a.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var r=0|y(t,e),n=o(r),i=n.write(t,e);i!==r&&(n=n.slice(0,i));return n}(t,e);if(ArrayBuffer.isView(t))return function(t){if(D(t,Uint8Array)){var e=new Uint8Array(t);return d(e.buffer,e.byteOffset,e.byteLength)}return l(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(D(t,ArrayBuffer)||t&&D(t.buffer,ArrayBuffer))return d(t,e,r);if("undefined"!=typeof SharedArrayBuffer&&(D(t,SharedArrayBuffer)||t&&D(t.buffer,SharedArrayBuffer)))return d(t,e,r);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return a.from(n,e,r);var i=function(t){if(a.isBuffer(t)){var e=0|p(t.length),r=o(e);return 0===r.length||t.copy(r,0,0,e),r}if(void 0!==t.length)return"number"!=typeof t.length||q(t.length)?o(0):l(t);if("Buffer"===t.type&&Array.isArray(t.data))return l(t.data)}(t);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return a.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function f(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function h(t){return f(t),o(t<0?0:0|p(t))}function l(t){for(var e=t.length<0?0:0|p(t.length),r=o(e),n=0;n<e;n+=1)r[n]=255&t[n];return r}function d(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r),Object.setPrototypeOf(n,a.prototype),n}function p(t){if(t>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|t}function y(t,e){if(a.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||D(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var r=t.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return j(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return M(t).length;default:if(i)return n?-1:j(t).length;e=(""+e).toLowerCase(),i=!0}}function g(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return O(this,e,r);case"utf8":case"utf-8":return T(this,e,r);case"ascii":return S(this,e,r);case"latin1":case"binary":return N(this,e,r);case"base64":return x(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function b(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function w(t,e,r,n,i){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),q(r=+r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof e&&(e=a.from(e,n)),a.isBuffer(e))return 0===e.length?-1:m(t,e,r,n,i);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):m(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function m(t,e,r,n,i){var s,o=1,a=t.length,c=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;o=2,a/=2,c/=2,r/=2}function u(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(i){var f=-1;for(s=r;s<a;s++)if(u(t,s)===u(e,-1===f?0:s-f)){if(-1===f&&(f=s),s-f+1===c)return f*o}else-1!==f&&(s-=s-f),f=-1}else for(r+c>a&&(r=a-c),s=r;s>=0;s--){for(var h=!0,l=0;l<c;l++)if(u(t,s+l)!==u(e,l)){h=!1;break}if(h)return s}return-1}function v(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n))>i&&(n=i):n=i;var s=e.length;n>s/2&&(n=s/2);for(var o=0;o<n;++o){var a=parseInt(e.substr(2*o,2),16);if(q(a))return o;t[r+o]=a}return o}function E(t,e,r,n){return V(j(e,t.length-r),t,r,n)}function _(t,e,r,n){return V(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function B(t,e,r,n){return V(M(e),t,r,n)}function I(t,e,r,n){return V(function(t,e){for(var r,n,i,s=[],o=0;o<t.length&&!((e-=2)<0);++o)n=(r=t.charCodeAt(o))>>8,i=r%256,s.push(i),s.push(n);return s}(e,t.length-r),t,r,n)}function x(t,r,n){return 0===r&&n===t.length?e.fromByteArray(t):e.fromByteArray(t.slice(r,n))}function T(t,e,r){r=Math.min(t.length,r);for(var n=[],i=e;i<r;){var s,o,a,c,u=t[i],f=null,h=u>239?4:u>223?3:u>191?2:1;if(i+h<=r)switch(h){case 1:u<128&&(f=u);break;case 2:128==(192&(s=t[i+1]))&&(c=(31&u)<<6|63&s)>127&&(f=c);break;case 3:s=t[i+1],o=t[i+2],128==(192&s)&&128==(192&o)&&(c=(15&u)<<12|(63&s)<<6|63&o)>2047&&(c<55296||c>57343)&&(f=c);break;case 4:s=t[i+1],o=t[i+2],a=t[i+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&(c=(15&u)<<18|(63&s)<<12|(63&o)<<6|63&a)>65535&&c<1114112&&(f=c)}null===f?(f=65533,h=1):f>65535&&(f-=65536,n.push(f>>>10&1023|55296),f=56320|1023&f),n.push(f),i+=h}return function(t){var e=t.length;if(e<=A)return String.fromCharCode.apply(String,t);var r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=A));return r}(n)}t.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),a.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}}),a.poolSize=8192,a.from=function(t,e,r){return c(t,e,r)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array),a.alloc=function(t,e,r){return function(t,e,r){return f(t),t<=0?o(t):void 0!==e?"string"==typeof r?o(t).fill(e,r):o(t).fill(e):o(t)}(t,e,r)},a.allocUnsafe=function(t){return h(t)},a.allocUnsafeSlow=function(t){return h(t)},a.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==a.prototype},a.compare=function(t,e){if(D(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),D(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),!a.isBuffer(t)||!a.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var r=t.length,n=e.length,i=0,s=Math.min(r,n);i<s;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0},a.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return a.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=a.allocUnsafe(e),i=0;for(r=0;r<t.length;++r){var s=t[r];if(D(s,Uint8Array))i+s.length>n.length?a.from(s).copy(n,i):Uint8Array.prototype.set.call(n,s,i);else{if(!a.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,i)}i+=s.length}return n},a.byteLength=y,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)b(this,e,e+1);return this},a.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)b(this,e,e+3),b(this,e+1,e+2);return this},a.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)b(this,e,e+7),b(this,e+1,e+6),b(this,e+2,e+5),b(this,e+3,e+4);return this},a.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?T(this,0,t):g.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(t){if(!a.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===a.compare(this,t)},a.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},n&&(a.prototype[n]=a.prototype.inspect),a.prototype.compare=function(t,e,r,n,i){if(D(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),!a.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),e<0||r>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&e>=r)return 0;if(n>=i)return-1;if(e>=r)return 1;if(this===t)return 0;for(var s=(i>>>=0)-(n>>>=0),o=(r>>>=0)-(e>>>=0),c=Math.min(s,o),u=this.slice(n,i),f=t.slice(e,r),h=0;h<c;++h)if(u[h]!==f[h]){s=u[h],o=f[h];break}return s<o?-1:o<s?1:0},a.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},a.prototype.indexOf=function(t,e,r){return w(this,t,e,r,!0)},a.prototype.lastIndexOf=function(t,e,r){return w(this,t,e,r,!1)},a.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-e;if((void 0===r||r>i)&&(r=i),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var s=!1;;)switch(n){case"hex":return v(this,t,e,r);case"utf8":case"utf-8":return E(this,t,e,r);case"ascii":case"latin1":case"binary":return _(this,t,e,r);case"base64":return B(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,t,e,r);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var A=4096;function S(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}function N(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function O(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var i="",s=e;s<r;++s)i+=$[t[s]];return i}function R(t,e,r){for(var n=t.slice(e,r),i="",s=0;s<n.length-1;s+=2)i+=String.fromCharCode(n[s]+256*n[s+1]);return i}function U(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function F(t,e,r,n,i,s){if(!a.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<s)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function k(t,e,r,n,i,s){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function L(t,e,n,i,s){return e=+e,n>>>=0,s||k(t,0,n,4),r.write(t,e,n,i,23,4),n+4}function P(t,e,n,i,s){return e=+e,n>>>=0,s||k(t,0,n,8),r.write(t,e,n,i,52,8),n+8}a.prototype.slice=function(t,e){var r=this.length;(t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);var n=this.subarray(t,e);return Object.setPrototypeOf(n,a.prototype),n},a.prototype.readUintLE=a.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||U(t,e,this.length);for(var n=this[t],i=1,s=0;++s<e&&(i*=256);)n+=this[t+s]*i;return n},a.prototype.readUintBE=a.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||U(t,e,this.length);for(var n=this[t+--e],i=1;e>0&&(i*=256);)n+=this[t+--e]*i;return n},a.prototype.readUint8=a.prototype.readUInt8=function(t,e){return t>>>=0,e||U(t,1,this.length),this[t]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(t,e){return t>>>=0,e||U(t,2,this.length),this[t]|this[t+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(t,e){return t>>>=0,e||U(t,2,this.length),this[t]<<8|this[t+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(t,e){return t>>>=0,e||U(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(t,e){return t>>>=0,e||U(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},a.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||U(t,e,this.length);for(var n=this[t],i=1,s=0;++s<e&&(i*=256);)n+=this[t+s]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*e)),n},a.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||U(t,e,this.length);for(var n=e,i=1,s=this[t+--n];n>0&&(i*=256);)s+=this[t+--n]*i;return s>=(i*=128)&&(s-=Math.pow(2,8*e)),s},a.prototype.readInt8=function(t,e){return t>>>=0,e||U(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},a.prototype.readInt16LE=function(t,e){t>>>=0,e||U(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt16BE=function(t,e){t>>>=0,e||U(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt32LE=function(t,e){return t>>>=0,e||U(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},a.prototype.readInt32BE=function(t,e){return t>>>=0,e||U(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},a.prototype.readFloatLE=function(t,e){return t>>>=0,e||U(t,4,this.length),r.read(this,t,!0,23,4)},a.prototype.readFloatBE=function(t,e){return t>>>=0,e||U(t,4,this.length),r.read(this,t,!1,23,4)},a.prototype.readDoubleLE=function(t,e){return t>>>=0,e||U(t,8,this.length),r.read(this,t,!0,52,8)},a.prototype.readDoubleBE=function(t,e){return t>>>=0,e||U(t,8,this.length),r.read(this,t,!1,52,8)},a.prototype.writeUintLE=a.prototype.writeUIntLE=function(t,e,r,n){(t=+t,e>>>=0,r>>>=0,n)||F(this,t,e,r,Math.pow(2,8*r)-1,0);var i=1,s=0;for(this[e]=255&t;++s<r&&(i*=256);)this[e+s]=t/i&255;return e+r},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(t,e,r,n){(t=+t,e>>>=0,r>>>=0,n)||F(this,t,e,r,Math.pow(2,8*r)-1,0);var i=r-1,s=1;for(this[e+i]=255&t;--i>=0&&(s*=256);)this[e+i]=t/s&255;return e+r},a.prototype.writeUint8=a.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||F(this,t,e,1,255,0),this[e]=255&t,e+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||F(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||F(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||F(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||F(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},a.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var i=Math.pow(2,8*r-1);F(this,t,e,r,i-1,-i)}var s=0,o=1,a=0;for(this[e]=255&t;++s<r&&(o*=256);)t<0&&0===a&&0!==this[e+s-1]&&(a=1),this[e+s]=(t/o|0)-a&255;return e+r},a.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var i=Math.pow(2,8*r-1);F(this,t,e,r,i-1,-i)}var s=r-1,o=1,a=0;for(this[e+s]=255&t;--s>=0&&(o*=256);)t<0&&0===a&&0!==this[e+s+1]&&(a=1),this[e+s]=(t/o|0)-a&255;return e+r},a.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||F(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},a.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||F(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},a.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||F(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},a.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||F(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},a.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||F(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},a.prototype.writeFloatLE=function(t,e,r){return L(this,t,e,!0,r)},a.prototype.writeFloatBE=function(t,e,r){return L(this,t,e,!1,r)},a.prototype.writeDoubleLE=function(t,e,r){return P(this,t,e,!0,r)},a.prototype.writeDoubleBE=function(t,e,r){return P(this,t,e,!1,r)},a.prototype.copy=function(t,e,r,n){if(!a.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var i=n-r;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,r,n):Uint8Array.prototype.set.call(t,this.subarray(r,n),e),i},a.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!a.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===t.length){var i=t.charCodeAt(0);("utf8"===n&&i<128||"latin1"===n)&&(t=i)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var s;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(s=e;s<r;++s)this[s]=t;else{var o=a.isBuffer(t)?t:a.from(t,n),c=o.length;if(0===c)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(s=0;s<r-e;++s)this[s+e]=o[s%c]}return this};var C=/[^+/0-9A-Za-z-_]/g;function j(t,e){var r;e=e||1/0;for(var n=t.length,i=null,s=[],o=0;o<n;++o){if((r=t.charCodeAt(o))>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(o+1===n){(e-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(e-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function M(t){return e.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(C,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function V(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function D(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function q(t){return t!=t}var $=function(){for(var t="0123456789abcdef",e=new Array(256),r=0;r<16;++r)for(var n=16*r,i=0;i<16;++i)e[n+i]=t[r]+t[i];return e}()}(tr)),tr}var rr,nr,ir,sr={exports:{}},or=sr.exports;function ar(){return rr||(rr=1,t=sr,function(e){var r,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,s=Math.floor,o="[BigNumber Error] ",a=o+"Number primitive has more than 15 significant digits: ",c=1e14,u=14,f=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],l=1e7,d=1e9;function p(t){var e=0|t;return t>0||t===e?e:e-1}function y(t){for(var e,r,n=1,i=t.length,s=t[0]+"";n<i;){for(e=t[n++]+"",r=u-e.length;r--;e="0"+e);s+=e}for(i=s.length;48===s.charCodeAt(--i););return s.slice(0,i+1||1)}function g(t,e){var r,n,i=t.c,s=e.c,o=t.s,a=e.s,c=t.e,u=e.e;if(!o||!a)return null;if(r=i&&!i[0],n=s&&!s[0],r||n)return r?n?0:-a:o;if(o!=a)return o;if(r=o<0,n=c==u,!i||!s)return n?0:!i^r?1:-1;if(!n)return c>u^r?1:-1;for(a=(c=i.length)<(u=s.length)?c:u,o=0;o<a;o++)if(i[o]!=s[o])return i[o]>s[o]^r?1:-1;return c==u?0:c>u^r?1:-1}function b(t,e,r,n){if(t<e||t>r||t!==s(t))throw Error(o+(n||"Argument")+("number"==typeof t?t<e||t>r?" out of range: ":" not an integer: ":" not a primitive number: ")+String(t))}function w(t){var e=t.c.length-1;return p(t.e/u)==e&&t.c[e]%2!=0}function m(t,e){return(t.length>1?t.charAt(0)+"."+t.slice(1):t)+(e<0?"e":"e+")+e}function v(t,e,r){var n,i;if(e<0){for(i=r+".";++e;i+=r);t=i+t}else if(++e>(n=t.length)){for(i=r,e-=n;--e;i+=r);t+=i}else e<n&&(t=t.slice(0,e)+"."+t.slice(e));return t}r=function t(e){var r,E,_,B,I,x,T,A,S,N,O=G.prototype={constructor:G,toString:null,valueOf:null},R=new G(1),U=20,F=4,k=-7,L=21,P=-1e7,C=1e7,j=!1,M=1,V=0,D={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},q="0123456789abcdefghijklmnopqrstuvwxyz",$=!0;function G(t,e){var r,i,o,c,h,l,d,p,y=this;if(!(y instanceof G))return new G(t,e);if(null==e){if(t&&!0===t._isBigNumber)return y.s=t.s,void(!t.c||t.e>C?y.c=y.e=null:t.e<P?y.c=[y.e=0]:(y.e=t.e,y.c=t.c.slice()));if((l="number"==typeof t)&&0*t==0){if(y.s=1/t<0?(t=-t,-1):1,t===~~t){for(c=0,h=t;h>=10;h/=10,c++);return void(c>C?y.c=y.e=null:(y.e=c,y.c=[t]))}p=String(t)}else{if(!n.test(p=String(t)))return _(y,p,l);y.s=45==p.charCodeAt(0)?(p=p.slice(1),-1):1}(c=p.indexOf("."))>-1&&(p=p.replace(".","")),(h=p.search(/e/i))>0?(c<0&&(c=h),c+=+p.slice(h+1),p=p.substring(0,h)):c<0&&(c=p.length)}else{if(b(e,2,q.length,"Base"),10==e&&$)return H(y=new G(t),U+y.e+1,F);if(p=String(t),l="number"==typeof t){if(0*t!=0)return _(y,p,l,e);if(y.s=1/t<0?(p=p.slice(1),-1):1,G.DEBUG&&p.replace(/^0\.0*|\./,"").length>15)throw Error(a+t)}else y.s=45===p.charCodeAt(0)?(p=p.slice(1),-1):1;for(r=q.slice(0,e),c=h=0,d=p.length;h<d;h++)if(r.indexOf(i=p.charAt(h))<0){if("."==i){if(h>c){c=d;continue}}else if(!o&&(p==p.toUpperCase()&&(p=p.toLowerCase())||p==p.toLowerCase()&&(p=p.toUpperCase()))){o=!0,h=-1,c=0;continue}return _(y,String(t),l,e)}l=!1,(c=(p=E(p,e,10,y.s)).indexOf("."))>-1?p=p.replace(".",""):c=p.length}for(h=0;48===p.charCodeAt(h);h++);for(d=p.length;48===p.charCodeAt(--d););if(p=p.slice(h,++d)){if(d-=h,l&&G.DEBUG&&d>15&&(t>f||t!==s(t)))throw Error(a+y.s*t);if((c=c-h-1)>C)y.c=y.e=null;else if(c<P)y.c=[y.e=0];else{if(y.e=c,y.c=[],h=(c+1)%u,c<0&&(h+=u),h<d){for(h&&y.c.push(+p.slice(0,h)),d-=u;h<d;)y.c.push(+p.slice(h,h+=u));h=u-(p=p.slice(h)).length}else h-=d;for(;h--;p+="0");y.c.push(+p)}}else y.c=[y.e=0]}function z(t,e,r,n){var i,s,o,a,c;if(null==r?r=F:b(r,0,8),!t.c)return t.toString();if(i=t.c[0],o=t.e,null==e)c=y(t.c),c=1==n||2==n&&(o<=k||o>=L)?m(c,o):v(c,o,"0");else if(s=(t=H(new G(t),e,r)).e,a=(c=y(t.c)).length,1==n||2==n&&(e<=s||s<=k)){for(;a<e;c+="0",a++);c=m(c,s)}else if(e-=o+(2===n&&s>o),c=v(c,s,"0"),s+1>a){if(--e>0)for(c+=".";e--;c+="0");}else if((e+=s-a)>0)for(s+1==a&&(c+=".");e--;c+="0");return t.s<0&&i?"-"+c:c}function K(t,e){for(var r,n,i=1,s=new G(t[0]);i<t.length;i++)(!(n=new G(t[i])).s||(r=g(s,n))===e||0===r&&s.s===e)&&(s=n);return s}function Z(t,e,r){for(var n=1,i=e.length;!e[--i];e.pop());for(i=e[0];i>=10;i/=10,n++);return(r=n+r*u-1)>C?t.c=t.e=null:r<P?t.c=[t.e=0]:(t.e=r,t.c=e),t}function H(t,e,r,n){var o,a,f,l,d,p,y,g=t.c,b=h;if(g){t:{for(o=1,l=g[0];l>=10;l/=10,o++);if((a=e-o)<0)a+=u,f=e,d=g[p=0],y=s(d/b[o-f-1]%10);else if((p=i((a+1)/u))>=g.length){if(!n)break t;for(;g.length<=p;g.push(0));d=y=0,o=1,f=(a%=u)-u+1}else{for(d=l=g[p],o=1;l>=10;l/=10,o++);y=(f=(a%=u)-u+o)<0?0:s(d/b[o-f-1]%10)}if(n=n||e<0||null!=g[p+1]||(f<0?d:d%b[o-f-1]),n=r<4?(y||n)&&(0==r||r==(t.s<0?3:2)):y>5||5==y&&(4==r||n||6==r&&(a>0?f>0?d/b[o-f]:0:g[p-1])%10&1||r==(t.s<0?8:7)),e<1||!g[0])return g.length=0,n?(e-=t.e+1,g[0]=b[(u-e%u)%u],t.e=-e||0):g[0]=t.e=0,t;if(0==a?(g.length=p,l=1,p--):(g.length=p+1,l=b[u-a],g[p]=f>0?s(d/b[o-f]%b[f])*l:0),n)for(;;){if(0==p){for(a=1,f=g[0];f>=10;f/=10,a++);for(f=g[0]+=l,l=1;f>=10;f/=10,l++);a!=l&&(t.e++,g[0]==c&&(g[0]=1));break}if(g[p]+=l,g[p]!=c)break;g[p--]=0,l=1}for(a=g.length;0===g[--a];g.pop());}t.e>C?t.c=t.e=null:t.e<P&&(t.c=[t.e=0])}return t}function Y(t){var e,r=t.e;return null===r?t.toString():(e=y(t.c),e=r<=k||r>=L?m(e,r):v(e,r,"0"),t.s<0?"-"+e:e)}return G.clone=t,G.ROUND_UP=0,G.ROUND_DOWN=1,G.ROUND_CEIL=2,G.ROUND_FLOOR=3,G.ROUND_HALF_UP=4,G.ROUND_HALF_DOWN=5,G.ROUND_HALF_EVEN=6,G.ROUND_HALF_CEIL=7,G.ROUND_HALF_FLOOR=8,G.EUCLID=9,G.config=G.set=function(t){var e,r;if(null!=t){if("object"!=typeof t)throw Error(o+"Object expected: "+t);if(t.hasOwnProperty(e="DECIMAL_PLACES")&&(b(r=t[e],0,d,e),U=r),t.hasOwnProperty(e="ROUNDING_MODE")&&(b(r=t[e],0,8,e),F=r),t.hasOwnProperty(e="EXPONENTIAL_AT")&&((r=t[e])&&r.pop?(b(r[0],-d,0,e),b(r[1],0,d,e),k=r[0],L=r[1]):(b(r,-d,d,e),k=-(L=r<0?-r:r))),t.hasOwnProperty(e="RANGE"))if((r=t[e])&&r.pop)b(r[0],-d,-1,e),b(r[1],1,d,e),P=r[0],C=r[1];else{if(b(r,-d,d,e),!r)throw Error(o+e+" cannot be zero: "+r);P=-(C=r<0?-r:r)}if(t.hasOwnProperty(e="CRYPTO")){if((r=t[e])!==!!r)throw Error(o+e+" not true or false: "+r);if(r){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw j=!r,Error(o+"crypto unavailable");j=r}else j=r}if(t.hasOwnProperty(e="MODULO_MODE")&&(b(r=t[e],0,9,e),M=r),t.hasOwnProperty(e="POW_PRECISION")&&(b(r=t[e],0,d,e),V=r),t.hasOwnProperty(e="FORMAT")){if("object"!=typeof(r=t[e]))throw Error(o+e+" not an object: "+r);D=r}if(t.hasOwnProperty(e="ALPHABET")){if("string"!=typeof(r=t[e])||/^.?$|[+\-.\s]|(.).*\1/.test(r))throw Error(o+e+" invalid: "+r);$="0123456789"==r.slice(0,10),q=r}}return{DECIMAL_PLACES:U,ROUNDING_MODE:F,EXPONENTIAL_AT:[k,L],RANGE:[P,C],CRYPTO:j,MODULO_MODE:M,POW_PRECISION:V,FORMAT:D,ALPHABET:q}},G.isBigNumber=function(t){if(!t||!0!==t._isBigNumber)return!1;if(!G.DEBUG)return!0;var e,r,n=t.c,i=t.e,a=t.s;t:if("[object Array]"=={}.toString.call(n)){if((1===a||-1===a)&&i>=-d&&i<=d&&i===s(i)){if(0===n[0]){if(0===i&&1===n.length)return!0;break t}if((e=(i+1)%u)<1&&(e+=u),String(n[0]).length==e){for(e=0;e<n.length;e++)if((r=n[e])<0||r>=c||r!==s(r))break t;if(0!==r)return!0}}}else if(null===n&&null===i&&(null===a||1===a||-1===a))return!0;throw Error(o+"Invalid BigNumber: "+t)},G.maximum=G.max=function(){return K(arguments,-1)},G.minimum=G.min=function(){return K(arguments,1)},G.random=(B=9007199254740992,I=Math.random()*B&2097151?function(){return s(Math.random()*B)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(t){var e,r,n,a,c,f=0,l=[],p=new G(R);if(null==t?t=U:b(t,0,d),a=i(t/u),j)if(crypto.getRandomValues){for(e=crypto.getRandomValues(new Uint32Array(a*=2));f<a;)(c=131072*e[f]+(e[f+1]>>>11))>=9e15?(r=crypto.getRandomValues(new Uint32Array(2)),e[f]=r[0],e[f+1]=r[1]):(l.push(c%1e14),f+=2);f=a/2}else{if(!crypto.randomBytes)throw j=!1,Error(o+"crypto unavailable");for(e=crypto.randomBytes(a*=7);f<a;)(c=281474976710656*(31&e[f])+1099511627776*e[f+1]+4294967296*e[f+2]+16777216*e[f+3]+(e[f+4]<<16)+(e[f+5]<<8)+e[f+6])>=9e15?crypto.randomBytes(7).copy(e,f):(l.push(c%1e14),f+=7);f=a/7}if(!j)for(;f<a;)(c=I())<9e15&&(l[f++]=c%1e14);for(a=l[--f],t%=u,a&&t&&(c=h[u-t],l[f]=s(a/c)*c);0===l[f];l.pop(),f--);if(f<0)l=[n=0];else{for(n=-1;0===l[0];l.splice(0,1),n-=u);for(f=1,c=l[0];c>=10;c/=10,f++);f<u&&(n-=u-f)}return p.e=n,p.c=l,p}),G.sum=function(){for(var t=1,e=arguments,r=new G(e[0]);t<e.length;)r=r.plus(e[t++]);return r},E=function(){var t="0123456789";function e(t,e,r,n){for(var i,s,o=[0],a=0,c=t.length;a<c;){for(s=o.length;s--;o[s]*=e);for(o[0]+=n.indexOf(t.charAt(a++)),i=0;i<o.length;i++)o[i]>r-1&&(null==o[i+1]&&(o[i+1]=0),o[i+1]+=o[i]/r|0,o[i]%=r)}return o.reverse()}return function(n,i,s,o,a){var c,u,f,h,l,d,p,g,b=n.indexOf("."),w=U,m=F;for(b>=0&&(h=V,V=0,n=n.replace(".",""),d=(g=new G(i)).pow(n.length-b),V=h,g.c=e(v(y(d.c),d.e,"0"),10,s,t),g.e=g.c.length),f=h=(p=e(n,i,s,a?(c=q,t):(c=t,q))).length;0==p[--h];p.pop());if(!p[0])return c.charAt(0);if(b<0?--f:(d.c=p,d.e=f,d.s=o,p=(d=r(d,g,w,m,s)).c,l=d.r,f=d.e),b=p[u=f+w+1],h=s/2,l=l||u<0||null!=p[u+1],l=m<4?(null!=b||l)&&(0==m||m==(d.s<0?3:2)):b>h||b==h&&(4==m||l||6==m&&1&p[u-1]||m==(d.s<0?8:7)),u<1||!p[0])n=l?v(c.charAt(1),-w,c.charAt(0)):c.charAt(0);else{if(p.length=u,l)for(--s;++p[--u]>s;)p[u]=0,u||(++f,p=[1].concat(p));for(h=p.length;!p[--h];);for(b=0,n="";b<=h;n+=c.charAt(p[b++]));n=v(n,f,c.charAt(0))}return n}}(),r=function(){function t(t,e,r){var n,i,s,o,a=0,c=t.length,u=e%l,f=e/l|0;for(t=t.slice();c--;)a=((i=u*(s=t[c]%l)+(n=f*s+(o=t[c]/l|0)*u)%l*l+a)/r|0)+(n/l|0)+f*o,t[c]=i%r;return a&&(t=[a].concat(t)),t}function e(t,e,r,n){var i,s;if(r!=n)s=r>n?1:-1;else for(i=s=0;i<r;i++)if(t[i]!=e[i]){s=t[i]>e[i]?1:-1;break}return s}function r(t,e,r,n){for(var i=0;r--;)t[r]-=i,i=t[r]<e[r]?1:0,t[r]=i*n+t[r]-e[r];for(;!t[0]&&t.length>1;t.splice(0,1));}return function(n,i,o,a,f){var h,l,d,y,g,b,w,m,v,E,_,B,I,x,T,A,S,N=n.s==i.s?1:-1,O=n.c,R=i.c;if(!(O&&O[0]&&R&&R[0]))return new G(n.s&&i.s&&(O?!R||O[0]!=R[0]:R)?O&&0==O[0]||!R?0*N:N/0:NaN);for(v=(m=new G(N)).c=[],N=o+(l=n.e-i.e)+1,f||(f=c,l=p(n.e/u)-p(i.e/u),N=N/u|0),d=0;R[d]==(O[d]||0);d++);if(R[d]>(O[d]||0)&&l--,N<0)v.push(1),y=!0;else{for(x=O.length,A=R.length,d=0,N+=2,(g=s(f/(R[0]+1)))>1&&(R=t(R,g,f),O=t(O,g,f),A=R.length,x=O.length),I=A,_=(E=O.slice(0,A)).length;_<A;E[_++]=0);S=R.slice(),S=[0].concat(S),T=R[0],R[1]>=f/2&&T++;do{if(g=0,(h=e(R,E,A,_))<0){if(B=E[0],A!=_&&(B=B*f+(E[1]||0)),(g=s(B/T))>1)for(g>=f&&(g=f-1),w=(b=t(R,g,f)).length,_=E.length;1==e(b,E,w,_);)g--,r(b,A<w?S:R,w,f),w=b.length,h=1;else 0==g&&(h=g=1),w=(b=R.slice()).length;if(w<_&&(b=[0].concat(b)),r(E,b,_,f),_=E.length,-1==h)for(;e(R,E,A,_)<1;)g++,r(E,A<_?S:R,_,f),_=E.length}else 0===h&&(g++,E=[0]);v[d++]=g,E[0]?E[_++]=O[I]||0:(E=[O[I]],_=1)}while((I++<x||null!=E[0])&&N--);y=null!=E[0],v[0]||v.splice(0,1)}if(f==c){for(d=1,N=v[0];N>=10;N/=10,d++);H(m,o+(m.e=d+l*u-1)+1,a,y)}else m.e=l,m.r=+y;return m}}(),x=/^(-?)0([xbo])(?=\w[\w.]*$)/i,T=/^([^.]+)\.$/,A=/^\.([^.]+)$/,S=/^-?(Infinity|NaN)$/,N=/^\s*\+(?=[\w.])|^\s+|\s+$/g,_=function(t,e,r,n){var i,s=r?e:e.replace(N,"");if(S.test(s))t.s=isNaN(s)?null:s<0?-1:1;else{if(!r&&(s=s.replace(x,function(t,e,r){return i="x"==(r=r.toLowerCase())?16:"b"==r?2:8,n&&n!=i?t:e}),n&&(i=n,s=s.replace(T,"$1").replace(A,"0.$1")),e!=s))return new G(s,i);if(G.DEBUG)throw Error(o+"Not a"+(n?" base "+n:"")+" number: "+e);t.s=null}t.c=t.e=null},O.absoluteValue=O.abs=function(){var t=new G(this);return t.s<0&&(t.s=1),t},O.comparedTo=function(t,e){return g(this,new G(t,e))},O.decimalPlaces=O.dp=function(t,e){var r,n,i,s=this;if(null!=t)return b(t,0,d),null==e?e=F:b(e,0,8),H(new G(s),t+s.e+1,e);if(!(r=s.c))return null;if(n=((i=r.length-1)-p(this.e/u))*u,i=r[i])for(;i%10==0;i/=10,n--);return n<0&&(n=0),n},O.dividedBy=O.div=function(t,e){return r(this,new G(t,e),U,F)},O.dividedToIntegerBy=O.idiv=function(t,e){return r(this,new G(t,e),0,1)},O.exponentiatedBy=O.pow=function(t,e){var r,n,a,c,f,h,l,d,p=this;if((t=new G(t)).c&&!t.isInteger())throw Error(o+"Exponent not an integer: "+Y(t));if(null!=e&&(e=new G(e)),f=t.e>14,!p.c||!p.c[0]||1==p.c[0]&&!p.e&&1==p.c.length||!t.c||!t.c[0])return d=new G(Math.pow(+Y(p),f?t.s*(2-w(t)):+Y(t))),e?d.mod(e):d;if(h=t.s<0,e){if(e.c?!e.c[0]:!e.s)return new G(NaN);(n=!h&&p.isInteger()&&e.isInteger())&&(p=p.mod(e))}else{if(t.e>9&&(p.e>0||p.e<-1||(0==p.e?p.c[0]>1||f&&p.c[1]>=24e7:p.c[0]<8e13||f&&p.c[0]<=9999975e7)))return c=p.s<0&&w(t)?-0:0,p.e>-1&&(c=1/c),new G(h?1/c:c);V&&(c=i(V/u+2))}for(f?(r=new G(.5),h&&(t.s=1),l=w(t)):l=(a=Math.abs(+Y(t)))%2,d=new G(R);;){if(l){if(!(d=d.times(p)).c)break;c?d.c.length>c&&(d.c.length=c):n&&(d=d.mod(e))}if(a){if(0===(a=s(a/2)))break;l=a%2}else if(H(t=t.times(r),t.e+1,1),t.e>14)l=w(t);else{if(0===(a=+Y(t)))break;l=a%2}p=p.times(p),c?p.c&&p.c.length>c&&(p.c.length=c):n&&(p=p.mod(e))}return n?d:(h&&(d=R.div(d)),e?d.mod(e):c?H(d,V,F,void 0):d)},O.integerValue=function(t){var e=new G(this);return null==t?t=F:b(t,0,8),H(e,e.e+1,t)},O.isEqualTo=O.eq=function(t,e){return 0===g(this,new G(t,e))},O.isFinite=function(){return!!this.c},O.isGreaterThan=O.gt=function(t,e){return g(this,new G(t,e))>0},O.isGreaterThanOrEqualTo=O.gte=function(t,e){return 1===(e=g(this,new G(t,e)))||0===e},O.isInteger=function(){return!!this.c&&p(this.e/u)>this.c.length-2},O.isLessThan=O.lt=function(t,e){return g(this,new G(t,e))<0},O.isLessThanOrEqualTo=O.lte=function(t,e){return-1===(e=g(this,new G(t,e)))||0===e},O.isNaN=function(){return!this.s},O.isNegative=function(){return this.s<0},O.isPositive=function(){return this.s>0},O.isZero=function(){return!!this.c&&0==this.c[0]},O.minus=function(t,e){var r,n,i,s,o=this,a=o.s;if(e=(t=new G(t,e)).s,!a||!e)return new G(NaN);if(a!=e)return t.s=-e,o.plus(t);var f=o.e/u,h=t.e/u,l=o.c,d=t.c;if(!f||!h){if(!l||!d)return l?(t.s=-e,t):new G(d?o:NaN);if(!l[0]||!d[0])return d[0]?(t.s=-e,t):new G(l[0]?o:3==F?-0:0)}if(f=p(f),h=p(h),l=l.slice(),a=f-h){for((s=a<0)?(a=-a,i=l):(h=f,i=d),i.reverse(),e=a;e--;i.push(0));i.reverse()}else for(n=(s=(a=l.length)<(e=d.length))?a:e,a=e=0;e<n;e++)if(l[e]!=d[e]){s=l[e]<d[e];break}if(s&&(i=l,l=d,d=i,t.s=-t.s),(e=(n=d.length)-(r=l.length))>0)for(;e--;l[r++]=0);for(e=c-1;n>a;){if(l[--n]<d[n]){for(r=n;r&&!l[--r];l[r]=e);--l[r],l[n]+=c}l[n]-=d[n]}for(;0==l[0];l.splice(0,1),--h);return l[0]?Z(t,l,h):(t.s=3==F?-1:1,t.c=[t.e=0],t)},O.modulo=O.mod=function(t,e){var n,i,s=this;return t=new G(t,e),!s.c||!t.s||t.c&&!t.c[0]?new G(NaN):!t.c||s.c&&!s.c[0]?new G(s):(9==M?(i=t.s,t.s=1,n=r(s,t,0,3),t.s=i,n.s*=i):n=r(s,t,0,M),(t=s.minus(n.times(t))).c[0]||1!=M||(t.s=s.s),t)},O.multipliedBy=O.times=function(t,e){var r,n,i,s,o,a,f,h,d,y,g,b,w,m,v,E=this,_=E.c,B=(t=new G(t,e)).c;if(!(_&&B&&_[0]&&B[0]))return!E.s||!t.s||_&&!_[0]&&!B||B&&!B[0]&&!_?t.c=t.e=t.s=null:(t.s*=E.s,_&&B?(t.c=[0],t.e=0):t.c=t.e=null),t;for(n=p(E.e/u)+p(t.e/u),t.s*=E.s,(f=_.length)<(y=B.length)&&(w=_,_=B,B=w,i=f,f=y,y=i),i=f+y,w=[];i--;w.push(0));for(m=c,v=l,i=y;--i>=0;){for(r=0,g=B[i]%v,b=B[i]/v|0,s=i+(o=f);s>i;)r=((h=g*(h=_[--o]%v)+(a=b*h+(d=_[o]/v|0)*g)%v*v+w[s]+r)/m|0)+(a/v|0)+b*d,w[s--]=h%m;w[s]=r}return r?++n:w.splice(0,1),Z(t,w,n)},O.negated=function(){var t=new G(this);return t.s=-t.s||null,t},O.plus=function(t,e){var r,n=this,i=n.s;if(e=(t=new G(t,e)).s,!i||!e)return new G(NaN);if(i!=e)return t.s=-e,n.minus(t);var s=n.e/u,o=t.e/u,a=n.c,f=t.c;if(!s||!o){if(!a||!f)return new G(i/0);if(!a[0]||!f[0])return f[0]?t:new G(a[0]?n:0*i)}if(s=p(s),o=p(o),a=a.slice(),i=s-o){for(i>0?(o=s,r=f):(i=-i,r=a),r.reverse();i--;r.push(0));r.reverse()}for((i=a.length)-(e=f.length)<0&&(r=f,f=a,a=r,e=i),i=0;e;)i=(a[--e]=a[e]+f[e]+i)/c|0,a[e]=c===a[e]?0:a[e]%c;return i&&(a=[i].concat(a),++o),Z(t,a,o)},O.precision=O.sd=function(t,e){var r,n,i,s=this;if(null!=t&&t!==!!t)return b(t,1,d),null==e?e=F:b(e,0,8),H(new G(s),t,e);if(!(r=s.c))return null;if(n=(i=r.length-1)*u+1,i=r[i]){for(;i%10==0;i/=10,n--);for(i=r[0];i>=10;i/=10,n++);}return t&&s.e+1>n&&(n=s.e+1),n},O.shiftedBy=function(t){return b(t,-9007199254740991,f),this.times("1e"+t)},O.squareRoot=O.sqrt=function(){var t,e,n,i,s,o=this,a=o.c,c=o.s,u=o.e,f=U+4,h=new G("0.5");if(1!==c||!a||!a[0])return new G(!c||c<0&&(!a||a[0])?NaN:a?o:1/0);if(0==(c=Math.sqrt(+Y(o)))||c==1/0?(((e=y(a)).length+u)%2==0&&(e+="0"),c=Math.sqrt(+e),u=p((u+1)/2)-(u<0||u%2),n=new G(e=c==1/0?"5e"+u:(e=c.toExponential()).slice(0,e.indexOf("e")+1)+u)):n=new G(c+""),n.c[0])for((c=(u=n.e)+f)<3&&(c=0);;)if(s=n,n=h.times(s.plus(r(o,s,f,1))),y(s.c).slice(0,c)===(e=y(n.c)).slice(0,c)){if(n.e<u&&--c,"9999"!=(e=e.slice(c-3,c+1))&&(i||"4999"!=e)){+e&&(+e.slice(1)||"5"!=e.charAt(0))||(H(n,n.e+U+2,1),t=!n.times(n).eq(o));break}if(!i&&(H(s,s.e+U+2,0),s.times(s).eq(o))){n=s;break}f+=4,c+=4,i=1}return H(n,n.e+U+1,F,t)},O.toExponential=function(t,e){return null!=t&&(b(t,0,d),t++),z(this,t,e,1)},O.toFixed=function(t,e){return null!=t&&(b(t,0,d),t=t+this.e+1),z(this,t,e)},O.toFormat=function(t,e,r){var n,i=this;if(null==r)null!=t&&e&&"object"==typeof e?(r=e,e=null):t&&"object"==typeof t?(r=t,t=e=null):r=D;else if("object"!=typeof r)throw Error(o+"Argument not an object: "+r);if(n=i.toFixed(t,e),i.c){var s,a=n.split("."),c=+r.groupSize,u=+r.secondaryGroupSize,f=r.groupSeparator||"",h=a[0],l=a[1],d=i.s<0,p=d?h.slice(1):h,y=p.length;if(u&&(s=c,c=u,u=s,y-=s),c>0&&y>0){for(s=y%c||c,h=p.substr(0,s);s<y;s+=c)h+=f+p.substr(s,c);u>0&&(h+=f+p.slice(s)),d&&(h="-"+h)}n=l?h+(r.decimalSeparator||"")+((u=+r.fractionGroupSize)?l.replace(new RegExp("\\d{"+u+"}\\B","g"),"$&"+(r.fractionGroupSeparator||"")):l):h}return(r.prefix||"")+n+(r.suffix||"")},O.toFraction=function(t){var e,n,i,s,a,c,f,l,d,p,g,b,w=this,m=w.c;if(null!=t&&(!(f=new G(t)).isInteger()&&(f.c||1!==f.s)||f.lt(R)))throw Error(o+"Argument "+(f.isInteger()?"out of range: ":"not an integer: ")+Y(f));if(!m)return new G(w);for(e=new G(R),d=n=new G(R),i=l=new G(R),b=y(m),a=e.e=b.length-w.e-1,e.c[0]=h[(c=a%u)<0?u+c:c],t=!t||f.comparedTo(e)>0?a>0?e:d:f,c=C,C=1/0,f=new G(b),l.c[0]=0;p=r(f,e,0,1),1!=(s=n.plus(p.times(i))).comparedTo(t);)n=i,i=s,d=l.plus(p.times(s=d)),l=s,e=f.minus(p.times(s=e)),f=s;return s=r(t.minus(n),i,0,1),l=l.plus(s.times(d)),n=n.plus(s.times(i)),l.s=d.s=w.s,g=r(d,i,a*=2,F).minus(w).abs().comparedTo(r(l,n,a,F).minus(w).abs())<1?[d,i]:[l,n],C=c,g},O.toNumber=function(){return+Y(this)},O.toPrecision=function(t,e){return null!=t&&b(t,1,d),z(this,t,e,2)},O.toString=function(t){var e,r=this,n=r.s,i=r.e;return null===i?n?(e="Infinity",n<0&&(e="-"+e)):e="NaN":(null==t?e=i<=k||i>=L?m(y(r.c),i):v(y(r.c),i,"0"):10===t&&$?e=v(y((r=H(new G(r),U+i+1,F)).c),r.e,"0"):(b(t,2,q.length,"Base"),e=E(v(y(r.c),i,"0"),10,t,n,!0)),n<0&&r.c[0]&&(e="-"+e)),e},O.valueOf=O.toJSON=function(){return Y(this)},O._isBigNumber=!0,null!=e&&G.set(e),G}(),r.default=r.BigNumber=r,t.exports?t.exports=r:(e||(e="undefined"!=typeof self&&self?self:window),e.BigNumber=r)}(or)),sr.exports;var t}var cr,ur,fr,hr,lr,dr,pr,yr,gr,br,wr,mr,vr,Er,_r,Br,Ir,xr,Tr,Ar={},Sr={};function Nr(){if(cr)return Sr;cr=1;const t=ar().BigNumber;return Sr.MT={POS_INT:0,NEG_INT:1,BYTE_STRING:2,UTF8_STRING:3,ARRAY:4,MAP:5,TAG:6,SIMPLE_FLOAT:7},Sr.TAG={DATE_STRING:0,DATE_EPOCH:1,POS_BIGINT:2,NEG_BIGINT:3,DECIMAL_FRAC:4,BIGFLOAT:5,BASE64URL_EXPECTED:21,BASE64_EXPECTED:22,BASE16_EXPECTED:23,CBOR:24,URI:32,BASE64URL:33,BASE64:34,REGEXP:35,MIME:36},Sr.NUMBYTES={ZERO:0,ONE:24,TWO:25,FOUR:26,EIGHT:27,INDEFINITE:31},Sr.SIMPLE={FALSE:20,TRUE:21,NULL:22,UNDEFINED:23},Sr.SYMS={NULL:Symbol("null"),UNDEFINED:Symbol("undef"),PARENT:Symbol("parent"),BREAK:Symbol("break"),STREAM:Symbol("stream")},Sr.SHIFT32=Math.pow(2,32),Sr.SHIFT16=Math.pow(2,16),Sr.MAX_SAFE_HIGH=2097151,Sr.NEG_ONE=new t(-1),Sr.TEN=new t(10),Sr.TWO=new t(2),Sr.PARENT={ARRAY:0,OBJECT:1,MAP:2,TAG:3,BYTE_STRING:4,UTF8_STRING:5},Sr}function Or(){return ur||(ur=1,function(t){const{Buffer:e}=er(),r=ar().BigNumber,n=Nr(),i=n.SHIFT32,s=n.SHIFT16;function o(t){return t<16?"0"+t.toString(16):t.toString(16)}t.parseHalf=function(t){var e,r,n;return n=128&t[0]?-1:1,e=(124&t[0])>>2,r=(3&t[0])<<8|t[1],e?31===e?n*(r?NaN:Infinity):n*Math.pow(2,e-25)*(1024+r):5.960464477539063e-8*n*r},t.arrayBufferToBignumber=function(t){const e=t.byteLength;let n="";for(let r=0;r<e;r++)n+=o(t[r]);return new r(n,16)},t.buildMap=t=>{const e=new Map,r=Object.keys(t),n=r.length;for(let i=0;i<n;i++)e.set(r[i],t[r[i]]);return e},t.buildInt32=(t,e)=>t*s+e,t.buildInt64=(e,n,s,o)=>{const a=t.buildInt32(e,n),c=t.buildInt32(s,o);return a>2097151?new r(a).times(i).plus(c):a*i+c},t.writeHalf=function(t,r){const n=e.allocUnsafe(4);n.writeFloatBE(r,0);const i=n.readUInt32BE(0);if(8191&i)return!1;var s=i>>16&32768;const o=i>>23&255,a=8388607&i;if(o>=113&&o<=142)s+=(o-112<<10)+(a>>13);else{if(!(o>=103&&o<113))return!1;if(a&(1<<126-o)-1)return!1;s+=a+8388608>>126-o}return t.writeUInt16BE(s,0),!0},t.keySorter=function(t,e){var r=t[0].byteLength,n=e[0].byteLength;return r>n?1:n>r?-1:t[0].compare(e[0])},t.isNegativeZero=t=>0===t&&1/t<0,t.nextPowerOf2=t=>{let e=0;if(t&&!(t&t-1))return t;for(;0!==t;)t>>=1,e+=1;return 1<<e}}(Ar)),Ar}function Rr(){if(hr)return fr;hr=1;const t=Nr(),e=t.MT,r=t.SIMPLE,n=t.SYMS;class i{constructor(t){if("number"!=typeof t)throw new Error("Invalid Simple type: "+typeof t);if(t<0||t>255||(0|t)!==t)throw new Error("value must be a small positive integer: "+t);this.value=t}toString(){return"simple("+this.value+")"}inspect(){return"simple("+this.value+")"}encodeCBOR(t){return t._pushInt(this.value,e.SIMPLE_FLOAT)}static isSimple(t){return t instanceof i}static decode(t,e){switch(null==e&&(e=!0),t){case r.FALSE:return!1;case r.TRUE:return!0;case r.NULL:return e?null:n.NULL;case r.UNDEFINED:return e?void 0:n.UNDEFINED;case-1:if(!e)throw new Error("Invalid BREAK");return n.BREAK;default:return new i(t)}}}return fr=i}function Ur(){if(dr)return lr;dr=1;class t{constructor(t,e,r){if(this.tag=t,this.value=e,this.err=r,"number"!=typeof this.tag)throw new Error("Invalid tag type ("+typeof this.tag+")");if(this.tag<0||(0|this.tag)!==this.tag)throw new Error("Tag must be a positive integer: "+this.tag)}toString(){return`${this.tag}(${JSON.stringify(this.value)})`}encodeCBOR(t){return t._pushTag(this.tag),t.pushAny(this.value)}convert(e){var r,n;if("function"!=typeof(n=null!=e?e[this.tag]:void 0)&&"function"!=typeof(n=t["_tag"+this.tag]))return this;try{return n.call(t,this.value)}catch(t){return r=t,this.err=r,this}}}return lr=t}function Fr(){if(yr)return pr;yr=1;const t=self.location?self.location.protocol+"//"+self.location.host:"",e=self.URL;return pr={URLWithLegacySupport:class{constructor(r="",n=t){this.super=new e(r,n),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(t){this.super.hash=t}set host(t){this.super.host=t}set hostname(t){this.super.hostname=t}set href(t){this.super.href=t}set origin(t){this.super.origin=t}set password(t){this.super.password=t}set pathname(t){this.super.pathname=t}set port(t){this.super.port=t}set protocol(t){this.super.protocol=t}set search(t){this.super.search=t}set searchParams(t){this.super.searchParams=t}set username(t){this.super.username=t}createObjectURL(t){return this.super.createObjectURL(t)}revokeObjectURL(t){this.super.revokeObjectURL(t)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}},URLSearchParams:self.URLSearchParams,defaultBase:t,format:function(t){if("string"==typeof t){return new e(t).toString()}if(!(t instanceof e)){const e=t.username&&t.password?`${t.username}:${t.password}@`:"",r=t.auth?t.auth+"@":"",n=t.port?":"+t.port:"",i=t.protocol?t.protocol+"//":"",s=t.host||"",o=t.hostname||"",a=t.search||(t.query?"?"+t.query:""),c=t.hash||"",u=t.pathname||"";return`${i}${e||r}${s||o+n}${t.path||u+a}${c}`}}},pr}function kr(){if(br)return gr;br=1;const{URLWithLegacySupport:t,format:e}=Fr();return gr=(r,n={},i={},s)=>{let o,a=n.protocol?n.protocol.replace(":",""):"http";a=(i[a]||s||a)+":";try{o=new t(r)}catch(t){o={}}const c=Object.assign({},n,{protocol:a||o.protocol,host:n.host||o.host});return new t(r,e(c)).toString()}}function Lr(){if(mr)return wr;mr=1;const{URLWithLegacySupport:t,format:e,URLSearchParams:r,defaultBase:n}=Fr(),i=kr();return wr={URL:t,URLSearchParams:r,format:e,relative:i,defaultBase:n}}function Pr(){if(Er)return vr;Er=1;const{Buffer:e}=er(),r=u(),n=ar().BigNumber,i=(ir||(ir=1,nr=function(t,e,r){"use asm";var n=new t.Uint8Array(r);var i=e.pushInt;var s=e.pushInt32;var o=e.pushInt32Neg;var a=e.pushInt64;var c=e.pushInt64Neg;var u=e.pushFloat;var f=e.pushFloatSingle;var h=e.pushFloatDouble;var l=e.pushTrue;var d=e.pushFalse;var p=e.pushUndefined;var y=e.pushNull;var g=e.pushInfinity;var b=e.pushInfinityNeg;var w=e.pushNaN;var m=e.pushNaNNeg;var v=e.pushArrayStart;var E=e.pushArrayStartFixed;var _=e.pushArrayStartFixed32;var B=e.pushArrayStartFixed64;var I=e.pushObjectStart;var x=e.pushObjectStartFixed;var T=e.pushObjectStartFixed32;var A=e.pushObjectStartFixed64;var S=e.pushByteString;var N=e.pushByteStringStart;var O=e.pushUtf8String;var R=e.pushUtf8StringStart;var U=e.pushSimpleUnassigned;var F=e.pushTagStart;var k=e.pushTagStart4;var L=e.pushTagStart8;var P=e.pushTagUnassigned;var C=e.pushBreak;var j=t.Math.pow;var M=0;var V=0;var D=0;function q(t){t=t|0;M=0;V=t;while((M|0)<(V|0)){D=Wt[n[M]&255](n[M]|0)|0;if((D|0)>0){break}}return D|0}function $(t){t=t|0;if(((M|0)+(t|0)|0)<(V|0)){return 0}return 1}function G(t){t=t|0;return n[t|0]<<8|n[t+1|0]|0}function z(t){t=t|0;return n[t|0]<<24|n[t+1|0]<<16|n[t+2|0]<<8|n[t+3|0]|0}function K(t){t=t|0;i(t|0);M=M+1|0;return 0}function Z(t){t=t|0;if($(1)|0){return 1}i(n[M+1|0]|0);M=M+2|0;return 0}function H(t){t=t|0;if($(2)|0){return 1}i(G(M+1|0)|0);M=M+3|0;return 0}function Y(t){t=t|0;if($(4)|0){return 1}s(G(M+1|0)|0,G(M+3|0)|0);M=M+5|0;return 0}function W(t){t=t|0;if($(8)|0){return 1}a(G(M+1|0)|0,G(M+3|0)|0,G(M+5|0)|0,G(M+7|0)|0);M=M+9|0;return 0}function X(t){t=t|0;i(-1-(t-32|0)|0);M=M+1|0;return 0}function J(t){t=t|0;if($(1)|0){return 1}i(-1-(n[M+1|0]|0)|0);M=M+2|0;return 0}function Q(t){t=t|0;var e=0;if($(2)|0){return 1}e=G(M+1|0)|0;i(-1-(e|0)|0);M=M+3|0;return 0}function tt(t){t=t|0;if($(4)|0){return 1}o(G(M+1|0)|0,G(M+3|0)|0);M=M+5|0;return 0}function et(t){t=t|0;if($(8)|0){return 1}c(G(M+1|0)|0,G(M+3|0)|0,G(M+5|0)|0,G(M+7|0)|0);M=M+9|0;return 0}function rt(t){t=t|0;var e=0;var r=0;var n=0;n=t-64|0;if($(n|0)|0){return 1}e=M+1|0;r=(M+1|0)+(n|0)|0;S(e|0,r|0);M=r|0;return 0}function nt(t){t=t|0;var e=0;var r=0;var i=0;if($(1)|0){return 1}i=n[M+1|0]|0;e=M+2|0;r=(M+2|0)+(i|0)|0;if($(i+1|0)|0){return 1}S(e|0,r|0);M=r|0;return 0}function it(t){t=t|0;var e=0;var r=0;var n=0;if($(2)|0){return 1}n=G(M+1|0)|0;e=M+3|0;r=(M+3|0)+(n|0)|0;if($(n+2|0)|0){return 1}S(e|0,r|0);M=r|0;return 0}function st(t){t=t|0;var e=0;var r=0;var n=0;if($(4)|0){return 1}n=z(M+1|0)|0;e=M+5|0;r=(M+5|0)+(n|0)|0;if($(n+4|0)|0){return 1}S(e|0,r|0);M=r|0;return 0}function ot(t){t=t|0;return 1}function at(t){t=t|0;N();M=M+1|0;return 0}function ct(t){t=t|0;var e=0;var r=0;var n=0;n=t-96|0;if($(n|0)|0){return 1}e=M+1|0;r=(M+1|0)+(n|0)|0;O(e|0,r|0);M=r|0;return 0}function ut(t){t=t|0;var e=0;var r=0;var i=0;if($(1)|0){return 1}i=n[M+1|0]|0;e=M+2|0;r=(M+2|0)+(i|0)|0;if($(i+1|0)|0){return 1}O(e|0,r|0);M=r|0;return 0}function ft(t){t=t|0;var e=0;var r=0;var n=0;if($(2)|0){return 1}n=G(M+1|0)|0;e=M+3|0;r=(M+3|0)+(n|0)|0;if($(n+2|0)|0){return 1}O(e|0,r|0);M=r|0;return 0}function ht(t){t=t|0;var e=0;var r=0;var n=0;if($(4)|0){return 1}n=z(M+1|0)|0;e=M+5|0;r=(M+5|0)+(n|0)|0;if($(n+4|0)|0){return 1}O(e|0,r|0);M=r|0;return 0}function lt(t){t=t|0;return 1}function dt(t){t=t|0;R();M=M+1|0;return 0}function pt(t){t=t|0;E(t-128|0);M=M+1|0;return 0}function yt(t){t=t|0;if($(1)|0){return 1}E(n[M+1|0]|0);M=M+2|0;return 0}function gt(t){t=t|0;if($(2)|0){return 1}E(G(M+1|0)|0);M=M+3|0;return 0}function bt(t){t=t|0;if($(4)|0){return 1}_(G(M+1|0)|0,G(M+3|0)|0);M=M+5|0;return 0}function wt(t){t=t|0;if($(8)|0){return 1}B(G(M+1|0)|0,G(M+3|0)|0,G(M+5|0)|0,G(M+7|0)|0);M=M+9|0;return 0}function mt(t){t=t|0;v();M=M+1|0;return 0}function vt(t){t=t|0;var e=0;e=t-160|0;if($(e|0)|0){return 1}x(e|0);M=M+1|0;return 0}function Et(t){t=t|0;if($(1)|0){return 1}x(n[M+1|0]|0);M=M+2|0;return 0}function _t(t){t=t|0;if($(2)|0){return 1}x(G(M+1|0)|0);M=M+3|0;return 0}function Bt(t){t=t|0;if($(4)|0){return 1}T(G(M+1|0)|0,G(M+3|0)|0);M=M+5|0;return 0}function It(t){t=t|0;if($(8)|0){return 1}A(G(M+1|0)|0,G(M+3|0)|0,G(M+5|0)|0,G(M+7|0)|0);M=M+9|0;return 0}function xt(t){t=t|0;I();M=M+1|0;return 0}function Tt(t){t=t|0;F(t-192|0|0);M=M+1|0;return 0}function At(t){0;F(t|0);M=M+1|0;return 0}function St(t){0;F(t|0);M=M+1|0;return 0}function Nt(t){0;F(t|0);M=M+1|0;return 0}function Ot(t){0;F(t|0);M=M+1|0;return 0}function Rt(t){t=t|0;F(t-192|0|0);M=M+1|0;return 0}function Ut(t){0;F(t|0);M=M+1|0;return 0}function Ft(t){0;F(t|0);M=M+1|0;return 0}function kt(t){0;F(t|0);M=M+1|0;return 0}function Lt(t){t=t|0;if($(1)|0){return 1}F(n[M+1|0]|0);M=M+2|0;return 0}function Pt(t){t=t|0;if($(2)|0){return 1}F(G(M+1|0)|0);M=M+3|0;return 0}function Ct(t){t=t|0;if($(4)|0){return 1}k(G(M+1|0)|0,G(M+3|0)|0);M=M+5|0;return 0}function jt(t){t=t|0;if($(8)|0){return 1}L(G(M+1|0)|0,G(M+3|0)|0,G(M+5|0)|0,G(M+7|0)|0);M=M+9|0;return 0}function Mt(t){t=t|0;U((t|0)-224|0);M=M+1|0;return 0}function Vt(t){t=t|0;d();M=M+1|0;return 0}function Dt(t){t=t|0;l();M=M+1|0;return 0}function qt(t){t=t|0;y();M=M+1|0;return 0}function $t(t){t=t|0;p();M=M+1|0;return 0}function Gt(t){t=t|0;if($(1)|0){return 1}U(n[M+1|0]|0);M=M+2|0;return 0}function zt(t){t=t|0;var e=0;var r=0;var i=1.0;var s=0.0;var o=0.0;var a=0.0;if($(2)|0){return 1}e=n[M+1|0]|0;r=n[M+2|0]|0;if((e|0)&0x80){i=-1.0}s=+(((e|0)&0x7C)>>2);o=+(((e|0)&0x03)<<8|r);if(+s==0.0){u(+(+i*+5.9604644775390625e-8*+o))}else if(+s==31.0){if(+i==1.0){if(+o>0.0){w()}else{g()}}else{if(+o>0.0){m()}else{b()}}}else{u(+(+i*j(+2,+(+s-25.0))*+(1024.0+o)))}M=M+3|0;return 0}function Kt(t){t=t|0;if($(4)|0){return 1}f(n[M+1|0]|0,n[M+2|0]|0,n[M+3|0]|0,n[M+4|0]|0);M=M+5|0;return 0}function Zt(t){t=t|0;if($(8)|0){return 1}h(n[M+1|0]|0,n[M+2|0]|0,n[M+3|0]|0,n[M+4|0]|0,n[M+5|0]|0,n[M+6|0]|0,n[M+7|0]|0,n[M+8|0]|0);M=M+9|0;return 0}function Ht(t){t=t|0;return 1}function Yt(t){t=t|0;C();M=M+1|0;return 0}var Wt=[K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,K,Z,H,Y,W,Ht,Ht,Ht,Ht,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,X,J,Q,tt,et,Ht,Ht,Ht,Ht,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,rt,nt,it,st,ot,Ht,Ht,Ht,at,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ct,ut,ft,ht,lt,Ht,Ht,Ht,dt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,pt,yt,gt,bt,wt,Ht,Ht,Ht,mt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,vt,Et,_t,Bt,It,Ht,Ht,Ht,xt,Tt,Tt,Tt,Tt,Tt,Tt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Rt,Lt,Pt,Ct,jt,Ht,Ht,Ht,Ht,Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt,Mt,Vt,Dt,qt,$t,Gt,zt,Kt,Zt,Ht,Ht,Ht,Yt];return{parse:q}}),nr),s=Or(),o=Nr(),a=Rr(),c=Ur(),{URL:f}=Lr();class h{constructor(r){!(r=r||{}).size||r.size<65536?r.size=65536:r.size=s.nextPowerOf2(r.size),this._heap=new ArrayBuffer(r.size),this._heap8=new Uint8Array(this._heap),this._buffer=e.from(this._heap),this._reset(),this._knownTags=Object.assign({0:t=>new Date(t),1:t=>new Date(1e3*t),2:t=>s.arrayBufferToBignumber(t),3:t=>o.NEG_ONE.minus(s.arrayBufferToBignumber(t)),4:t=>o.TEN.pow(t[0]).times(t[1]),5:t=>o.TWO.pow(t[0]).times(t[1]),32:t=>new f(t),35:t=>new RegExp(t)},r.tags),this.parser=i(t,{log:console.log.bind(console),pushInt:this.pushInt.bind(this),pushInt32:this.pushInt32.bind(this),pushInt32Neg:this.pushInt32Neg.bind(this),pushInt64:this.pushInt64.bind(this),pushInt64Neg:this.pushInt64Neg.bind(this),pushFloat:this.pushFloat.bind(this),pushFloatSingle:this.pushFloatSingle.bind(this),pushFloatDouble:this.pushFloatDouble.bind(this),pushTrue:this.pushTrue.bind(this),pushFalse:this.pushFalse.bind(this),pushUndefined:this.pushUndefined.bind(this),pushNull:this.pushNull.bind(this),pushInfinity:this.pushInfinity.bind(this),pushInfinityNeg:this.pushInfinityNeg.bind(this),pushNaN:this.pushNaN.bind(this),pushNaNNeg:this.pushNaNNeg.bind(this),pushArrayStart:this.pushArrayStart.bind(this),pushArrayStartFixed:this.pushArrayStartFixed.bind(this),pushArrayStartFixed32:this.pushArrayStartFixed32.bind(this),pushArrayStartFixed64:this.pushArrayStartFixed64.bind(this),pushObjectStart:this.pushObjectStart.bind(this),pushObjectStartFixed:this.pushObjectStartFixed.bind(this),pushObjectStartFixed32:this.pushObjectStartFixed32.bind(this),pushObjectStartFixed64:this.pushObjectStartFixed64.bind(this),pushByteString:this.pushByteString.bind(this),pushByteStringStart:this.pushByteStringStart.bind(this),pushUtf8String:this.pushUtf8String.bind(this),pushUtf8StringStart:this.pushUtf8StringStart.bind(this),pushSimpleUnassigned:this.pushSimpleUnassigned.bind(this),pushTagUnassigned:this.pushTagUnassigned.bind(this),pushTagStart:this.pushTagStart.bind(this),pushTagStart4:this.pushTagStart4.bind(this),pushTagStart8:this.pushTagStart8.bind(this),pushBreak:this.pushBreak.bind(this)},this._heap)}get _depth(){return this._parents.length}get _currentParent(){return this._parents[this._depth-1]}get _ref(){return this._currentParent.ref}_closeParent(){var t=this._parents.pop();if(t.length>0)throw new Error(`Missing ${t.length} elements`);switch(t.type){case o.PARENT.TAG:this._push(this.createTag(t.ref[0],t.ref[1]));break;case o.PARENT.BYTE_STRING:this._push(this.createByteString(t.ref,t.length));break;case o.PARENT.UTF8_STRING:this._push(this.createUtf8String(t.ref,t.length));break;case o.PARENT.MAP:if(t.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createMap(t.ref,t.length));break;case o.PARENT.OBJECT:if(t.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createObject(t.ref,t.length));break;case o.PARENT.ARRAY:this._push(this.createArray(t.ref,t.length))}this._currentParent&&this._currentParent.type===o.PARENT.TAG&&this._dec()}_dec(){const t=this._currentParent;t.length<0||(t.length--,0===t.length&&this._closeParent())}_push(t,e){const r=this._currentParent;switch(r.values++,r.type){case o.PARENT.ARRAY:case o.PARENT.BYTE_STRING:case o.PARENT.UTF8_STRING:r.length>-1?this._ref[this._ref.length-r.length]=t:this._ref.push(t),this._dec();break;case o.PARENT.OBJECT:null!=r.tmpKey?(this._ref[r.tmpKey]=t,r.tmpKey=null,this._dec()):(r.tmpKey=t,"string"!=typeof r.tmpKey&&(r.type=o.PARENT.MAP,r.ref=s.buildMap(r.ref)));break;case o.PARENT.MAP:null!=r.tmpKey?(this._ref.set(r.tmpKey,t),r.tmpKey=null,this._dec()):r.tmpKey=t;break;case o.PARENT.TAG:this._ref.push(t),e||this._dec();break;default:throw new Error("Unknown parent type")}}_createParent(t,e,r){this._parents[this._depth]={type:e,length:r,ref:t,values:0,tmpKey:null}}_reset(){this._res=[],this._parents=[{type:o.PARENT.ARRAY,length:-1,ref:this._res,values:0,tmpKey:null}]}createTag(t,e){const r=this._knownTags[t];return r?r(e):new c(t,e)}createMap(t,e){return t}createObject(t,e){return t}createArray(t,e){return t}createByteString(t,r){return e.concat(t)}createByteStringFromHeap(t,r){return t===r?e.alloc(0):e.from(this._heap.slice(t,r))}createInt(t){return t}createInt32(t,e){return s.buildInt32(t,e)}createInt64(t,e,r,n){return s.buildInt64(t,e,r,n)}createFloat(t){return t}createFloatSingle(t,e,n,i){return r.read([t,e,n,i],0,!1,23,4)}createFloatDouble(t,e,n,i,s,o,a,c){return r.read([t,e,n,i,s,o,a,c],0,!1,52,8)}createInt32Neg(t,e){return-1-s.buildInt32(t,e)}createInt64Neg(t,e,r,i){const a=s.buildInt32(t,e),c=s.buildInt32(r,i);return a>o.MAX_SAFE_HIGH?o.NEG_ONE.minus(new n(a).times(o.SHIFT32).plus(c)):-1-(a*o.SHIFT32+c)}createTrue(){return!0}createFalse(){return!1}createNull(){return null}createUndefined(){}createInfinity(){return 1/0}createInfinityNeg(){return-1/0}createNaN(){return NaN}createNaNNeg(){return NaN}createUtf8String(t,e){return t.join("")}createUtf8StringFromHeap(t,e){return t===e?"":this._buffer.toString("utf8",t,e)}createSimpleUnassigned(t){return new a(t)}pushInt(t){this._push(this.createInt(t))}pushInt32(t,e){this._push(this.createInt32(t,e))}pushInt64(t,e,r,n){this._push(this.createInt64(t,e,r,n))}pushFloat(t){this._push(this.createFloat(t))}pushFloatSingle(t,e,r,n){this._push(this.createFloatSingle(t,e,r,n))}pushFloatDouble(t,e,r,n,i,s,o,a){this._push(this.createFloatDouble(t,e,r,n,i,s,o,a))}pushInt32Neg(t,e){this._push(this.createInt32Neg(t,e))}pushInt64Neg(t,e,r,n){this._push(this.createInt64Neg(t,e,r,n))}pushTrue(){this._push(this.createTrue())}pushFalse(){this._push(this.createFalse())}pushNull(){this._push(this.createNull())}pushUndefined(){this._push(this.createUndefined())}pushInfinity(){this._push(this.createInfinity())}pushInfinityNeg(){this._push(this.createInfinityNeg())}pushNaN(){this._push(this.createNaN())}pushNaNNeg(){this._push(this.createNaNNeg())}pushArrayStart(){this._createParent([],o.PARENT.ARRAY,-1)}pushArrayStartFixed(t){this._createArrayStartFixed(t)}pushArrayStartFixed32(t,e){const r=s.buildInt32(t,e);this._createArrayStartFixed(r)}pushArrayStartFixed64(t,e,r,n){const i=s.buildInt64(t,e,r,n);this._createArrayStartFixed(i)}pushObjectStart(){this._createObjectStartFixed(-1)}pushObjectStartFixed(t){this._createObjectStartFixed(t)}pushObjectStartFixed32(t,e){const r=s.buildInt32(t,e);this._createObjectStartFixed(r)}pushObjectStartFixed64(t,e,r,n){const i=s.buildInt64(t,e,r,n);this._createObjectStartFixed(i)}pushByteStringStart(){this._parents[this._depth]={type:o.PARENT.BYTE_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushByteString(t,e){this._push(this.createByteStringFromHeap(t,e))}pushUtf8StringStart(){this._parents[this._depth]={type:o.PARENT.UTF8_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushUtf8String(t,e){this._push(this.createUtf8StringFromHeap(t,e))}pushSimpleUnassigned(t){this._push(this.createSimpleUnassigned(t))}pushTagStart(t){this._parents[this._depth]={type:o.PARENT.TAG,length:1,ref:[t]}}pushTagStart4(t,e){this.pushTagStart(s.buildInt32(t,e))}pushTagStart8(t,e,r,n){this.pushTagStart(s.buildInt64(t,e,r,n))}pushTagUnassigned(t){this._push(this.createTag(t))}pushBreak(){if(this._currentParent.length>-1)throw new Error("Unexpected break");this._closeParent()}_createObjectStartFixed(t){0!==t?this._createParent({},o.PARENT.OBJECT,t):this._push(this.createObject({}))}_createArrayStartFixed(t){0!==t?this._createParent(new Array(t),o.PARENT.ARRAY,t):this._push(this.createArray([]))}_decode(t){if(0===t.byteLength)throw new Error("Input too short");this._reset(),this._heap8.set(t);const e=this.parser.parse(t.byteLength);if(this._depth>1){for(;0===this._currentParent.length;)this._closeParent();if(this._depth>1)throw new Error("Undeterminated nesting")}if(e>0)throw new Error("Failed to parse");if(0===this._res.length)throw new Error("No valid result")}decodeFirst(t){return this._decode(t),this._res[0]}decodeAll(t){return this._decode(t),this._res}static decode(t,r){"string"==typeof t&&(t=e.from(t,r||"hex"));return new h({size:t.length}).decodeFirst(t)}static decodeAll(t,r){"string"==typeof t&&(t=e.from(t,r||"hex"));return new h({size:t.length}).decodeAll(t)}}return h.decodeFirst=h.decode,vr=h}var Cr,jr=(Tr||(Tr=1,(Cr=Qe).Diagnose=function(){if(Br)return _r;Br=1;const{Buffer:t}=er(),e=Pr(),r=Or();class n extends e{createTag(t,e){return`${t}(${e})`}createInt(t){return super.createInt(t).toString()}createInt32(t,e){return super.createInt32(t,e).toString()}createInt64(t,e,r,n){return super.createInt64(t,e,r,n).toString()}createInt32Neg(t,e){return super.createInt32Neg(t,e).toString()}createInt64Neg(t,e,r,n){return super.createInt64Neg(t,e,r,n).toString()}createTrue(){return"true"}createFalse(){return"false"}createFloat(t){const e=super.createFloat(t);return r.isNegativeZero(t)?"-0_1":`${e}_1`}createFloatSingle(t,e,r,n){return`${super.createFloatSingle(t,e,r,n)}_2`}createFloatDouble(t,e,r,n,i,s,o,a){return`${super.createFloatDouble(t,e,r,n,i,s,o,a)}_3`}createByteString(t,e){const r=t.join(", ");return-1===e?`(_ ${r})`:`h'${r}`}createByteStringFromHeap(e,r){return`h'${t.from(super.createByteStringFromHeap(e,r)).toString("hex")}'`}createInfinity(){return"Infinity_1"}createInfinityNeg(){return"-Infinity_1"}createNaN(){return"NaN_1"}createNaNNeg(){return"-NaN_1"}createNull(){return"null"}createUndefined(){return"undefined"}createSimpleUnassigned(t){return`simple(${t})`}createArray(t,e){const r=super.createArray(t,e);return-1===e?`[_ ${r.join(", ")}]`:`[${r.join(", ")}]`}createMap(t,e){const r=super.createMap(t),n=Array.from(r.keys()).reduce(i(r),"");return-1===e?`{_ ${n}}`:`{${n}}`}createObject(t,e){const r=super.createObject(t),n=Object.keys(r).reduce(i(r),"");return-1===e?`{_ ${n}}`:`{${n}}`}createUtf8String(t,e){const r=t.join(", ");return-1===e?`(_ ${r})`:`"${r}"`}createUtf8StringFromHeap(e,r){return`"${t.from(super.createUtf8StringFromHeap(e,r)).toString("utf8")}"`}static diagnose(e,r){return"string"==typeof e&&(e=t.from(e,r||"hex")),(new n).decodeFirst(e)}}function i(t){return(e,r)=>e?`${e}, ${r}: ${t[r]}`:`${r}: ${t[r]}`}return _r=n}(),Cr.Decoder=Pr(),Cr.Encoder=function(){if(xr)return Ir;xr=1;const{Buffer:t}=er(),{URL:e}=Lr(),r=ar().BigNumber,n=Or(),i=Nr(),s=i.MT,o=i.NUMBYTES,a=i.SHIFT32,c=i.SYMS,u=i.TAG,f=i.MT.SIMPLE_FLOAT<<5|i.NUMBYTES.TWO,h=i.MT.SIMPLE_FLOAT<<5|i.NUMBYTES.FOUR,l=i.MT.SIMPLE_FLOAT<<5|i.NUMBYTES.EIGHT,d=i.MT.SIMPLE_FLOAT<<5|i.SIMPLE.TRUE,p=i.MT.SIMPLE_FLOAT<<5|i.SIMPLE.FALSE,y=i.MT.SIMPLE_FLOAT<<5|i.SIMPLE.UNDEFINED,g=i.MT.SIMPLE_FLOAT<<5|i.SIMPLE.NULL,b=new r("0x20000000000000"),w=t.from("f97e00","hex"),m=t.from("f9fc00","hex"),v=t.from("f97c00","hex");class E{constructor(t){t=t||{},this.streaming="function"==typeof t.stream,this.onData=t.stream,this.semanticTypes=[[e,this._pushUrl],[r,this._pushBigNumber]];const n=t.genTypes||[],i=n.length;for(let t=0;t<i;t++)this.addSemanticType(n[t][0],n[t][1]);this._reset()}addSemanticType(t,e){const r=this.semanticTypes.length;for(let n=0;n<r;n++)if(this.semanticTypes[n][0]===t){const t=this.semanticTypes[n][1];return this.semanticTypes[n][1]=e,t}return this.semanticTypes.push([t,e]),null}push(t){return!t||(this.result[this.offset]=t,this.resultMethod[this.offset]=0,this.resultLength[this.offset]=t.length,this.offset++,this.streaming&&this.onData(this.finalize()),!0)}pushWrite(t,e,r){return this.result[this.offset]=t,this.resultMethod[this.offset]=e,this.resultLength[this.offset]=r,this.offset++,this.streaming&&this.onData(this.finalize()),!0}_pushUInt8(t){return this.pushWrite(t,1,1)}_pushUInt16BE(t){return this.pushWrite(t,2,2)}_pushUInt32BE(t){return this.pushWrite(t,3,4)}_pushDoubleBE(t){return this.pushWrite(t,4,8)}_pushNaN(){return this.push(w)}_pushInfinity(t){const e=t<0?m:v;return this.push(e)}_pushFloat(e){const r=t.allocUnsafe(2);if(n.writeHalf(r,e)&&n.parseHalf(r)===e)return this._pushUInt8(f)&&this.push(r);const i=t.allocUnsafe(4);return i.writeFloatBE(e,0),i.readFloatBE(0)===e?this._pushUInt8(h)&&this.push(i):this._pushUInt8(l)&&this._pushDoubleBE(e)}_pushInt(t,e,r){const n=e<<5;return t<24?this._pushUInt8(n|t):t<=255?this._pushUInt8(n|o.ONE)&&this._pushUInt8(t):t<=65535?this._pushUInt8(n|o.TWO)&&this._pushUInt16BE(t):t<=4294967295?this._pushUInt8(n|o.FOUR)&&this._pushUInt32BE(t):t<=Number.MAX_SAFE_INTEGER?this._pushUInt8(n|o.EIGHT)&&this._pushUInt32BE(Math.floor(t/a))&&this._pushUInt32BE(t%a):e===s.NEG_INT?this._pushFloat(r):this._pushFloat(t)}_pushIntNum(t){return t<0?this._pushInt(-t-1,s.NEG_INT,t):this._pushInt(t,s.POS_INT)}_pushNumber(t){switch(!1){case t==t:return this._pushNaN(t);case isFinite(t):return this._pushInfinity(t);case t%1!=0:return this._pushIntNum(t);default:return this._pushFloat(t)}}_pushString(e){const r=t.byteLength(e,"utf8");return this._pushInt(r,s.UTF8_STRING)&&this.pushWrite(e,5,r)}_pushBoolean(t){return this._pushUInt8(t?d:p)}_pushUndefined(t){return this._pushUInt8(y)}_pushArray(t,e){const r=e.length;if(!t._pushInt(r,s.ARRAY))return!1;for(let n=0;n<r;n++)if(!t.pushAny(e[n]))return!1;return!0}_pushTag(t){return this._pushInt(t,s.TAG)}_pushDate(t,e){return t._pushTag(u.DATE_EPOCH)&&t.pushAny(Math.round(e/1e3))}_pushBuffer(t,e){return t._pushInt(e.length,s.BYTE_STRING)&&t.push(e)}_pushNoFilter(t,e){return t._pushBuffer(t,e.slice())}_pushRegexp(t,e){return t._pushTag(u.REGEXP)&&t.pushAny(e.source)}_pushSet(t,e){if(!t._pushInt(e.size,s.ARRAY))return!1;for(const r of e)if(!t.pushAny(r))return!1;return!0}_pushUrl(t,e){return t._pushTag(u.URI)&&t.pushAny(e.format())}_pushBigint(e){let r=u.POS_BIGINT;e.isNegative()&&(e=e.negated().minus(1),r=u.NEG_BIGINT);let n=e.toString(16);n.length%2&&(n="0"+n);const i=t.from(n,"hex");return this._pushTag(r)&&this._pushBuffer(this,i)}_pushBigNumber(t,e){if(e.isNaN())return t._pushNaN();if(!e.isFinite())return t._pushInfinity(e.isNegative()?-1/0:1/0);if(e.isInteger())return t._pushBigint(e);if(!t._pushTag(u.DECIMAL_FRAC)||!t._pushInt(2,s.ARRAY))return!1;const n=e.decimalPlaces(),i=e.multipliedBy(new r(10).pow(n));return!!t._pushIntNum(-n)&&(i.abs().isLessThan(b)?t._pushIntNum(i.toNumber()):t._pushBigint(i))}_pushMap(t,e){return!!t._pushInt(e.size,s.MAP)&&this._pushRawMap(e.size,Array.from(e))}_pushObject(t){if(!t)return this._pushUInt8(g);for(var e=this.semanticTypes.length,r=0;r<e;r++)if(t instanceof this.semanticTypes[r][0])return this.semanticTypes[r][1].call(t,this,t);var n=t.encodeCBOR;if("function"==typeof n)return n.call(t,this);var i=Object.keys(t),o=i.length;return!!this._pushInt(o,s.MAP)&&this._pushRawMap(o,i.map(e=>[e,t[e]]))}_pushRawMap(t,e){e=e.map(function(t){return t[0]=E.encode(t[0]),t}).sort(n.keySorter);for(var r=0;r<t;r++){if(!this.push(e[r][0]))return!1;if(!this.pushAny(e[r][1]))return!1}return!0}write(t){return this.pushAny(t)}pushAny(e){var r=function(t){return{}.toString.call(t).slice(8,-1)}(e);switch(r){case"Number":return this._pushNumber(e);case"String":return this._pushString(e);case"Boolean":return this._pushBoolean(e);case"Object":return this._pushObject(e);case"Array":return this._pushArray(this,e);case"Uint8Array":return this._pushBuffer(this,t.isBuffer(e)?e:t.from(e));case"Null":return this._pushUInt8(g);case"Undefined":return this._pushUndefined(e);case"Map":return this._pushMap(this,e);case"Set":return this._pushSet(this,e);case"URL":return this._pushUrl(this,e);case"BigNumber":return this._pushBigNumber(this,e);case"Date":return this._pushDate(this,e);case"RegExp":return this._pushRegexp(this,e);case"Symbol":switch(e){case c.NULL:return this._pushObject(null);case c.UNDEFINED:return this._pushUndefined(void 0);default:throw new Error("Unknown symbol: "+e.toString())}default:throw new Error("Unknown type: "+typeof e+", "+(e?e.toString():""))}}finalize(){if(0===this.offset)return null;for(var e=this.result,r=this.resultLength,n=this.resultMethod,i=this.offset,s=0,o=0;o<i;o++)s+=r[o];var a=t.allocUnsafe(s),c=0,u=0;for(o=0;o<i;o++){switch(u=r[o],n[o]){case 0:e[o].copy(a,c);break;case 1:a.writeUInt8(e[o],c,!0);break;case 2:a.writeUInt16BE(e[o],c,!0);break;case 3:a.writeUInt32BE(e[o],c,!0);break;case 4:a.writeDoubleBE(e[o],c,!0);break;case 5:a.write(e[o],c,u,"utf8");break;default:throw new Error("unkown method")}c+=u}var f=a;return this._reset(),f}_reset(){this.result=[],this.resultMethod=[],this.resultLength=[],this.offset=0}static encode(t){const e=new E;if(!e.pushAny(t))throw new Error("Failed to encode input");return e.finalize()}}return Ir=E}(),Cr.Simple=Rr(),Cr.Tagged=Ur(),Cr.decodeAll=Cr.Decoder.decodeAll,Cr.decodeFirst=Cr.Decoder.decodeFirst,Cr.diagnose=Cr.Diagnose.diagnose,Cr.encode=Cr.Encoder.encode,Cr.decode=Cr.Decoder.decode,Cr.leveldb={decode:Cr.Decoder.decodeAll,encode:Cr.Encoder.encode,buffer:!0,name:"cbor"}),Qe),Mr=e(jr);function Vr(t){return Ot(vt.create().update(new Uint8Array(t)).digest())}function Dr(t){if(t instanceof Mr.Tagged)return Dr(t.value);if("string"==typeof t)return qr(t);if("number"==typeof t)return Vr(Dt(t));if(t instanceof ArrayBuffer||ArrayBuffer.isView(t))return Vr(t);if(Array.isArray(t)){return Vr(It(...t.map(Dr)))}if(t&&"object"==typeof t&&t._isPrincipal)return Vr(t.toUint8Array());if("object"==typeof t&&null!==t&&"function"==typeof t.toHash)return Dr(t.toHash());if("object"==typeof t)return Gr(t);if("bigint"==typeof t)return Vr(Dt(t));throw Object.assign(new Error(`Attempt to hash a value of unsupported type: ${t}`),{value:t})}const qr=t=>Vr((new TextEncoder).encode(t));function $r(t){return Gr(t)}function Gr(t){const e=Object.entries(t).filter(([,t])=>void 0!==t).map(([t,e])=>[qr(t),Dr(e)]);return Vr(It(...e.sort(([t],[e])=>St(t,e)).map(t=>It(...t))))}(new TextEncoder).encode("\nic-request");class zr{getPrincipal(){return Bt.anonymous()}async transformRequest(t){return Object.assign(Object.assign({},t),{body:{content:t.body}})}}var Kr,Zr,Hr,Yr={},Wr={},Xr={};function Jr(){if(Kr)return Xr;Kr=1,Object.defineProperty(Xr,"__esModule",{value:!0});function t(t,...e){const r=new Uint8Array(t.byteLength+e.reduce((t,e)=>t+e.byteLength,0));r.set(new Uint8Array(t),0);let n=t.byteLength;for(const t of e)r.set(new Uint8Array(t),n),n+=t.byteLength;return r.buffer}function e(t,e,r){const n=2**(e-24);r=(r=r.replace(/[^0-9a-fA-F]/g,"")).slice(2*-n).padStart(2*n,"0");const i=[(t<<5)+e].concat(r.match(/../g).map(t=>parseInt(t,16)));return new Uint8Array(i).buffer}function r(t,r){if(r<24)return new Uint8Array([(t<<5)+r]).buffer;return e(t,r<=255?24:r<=65535?25:r<=4294967295?26:27,r.toString(16))}function n(e){const n=[];for(let t=0;t<e.length;t++){let r=e.charCodeAt(t);r<128?n.push(r):r<2048?n.push(192|r>>6,128|63&r):r<55296||r>=57344?n.push(224|r>>12,128|r>>6&63,128|63&r):(t++,r=(1023&r)<<10|1023&e.charCodeAt(t),n.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r))}return t(new Uint8Array(r(3,e.length)),new Uint8Array(n))}function i(t){return new Uint8Array(t).buffer}function s(t){if(isNaN(t))throw new RangeError("Invalid number.");t=Math.min(Math.max(0,t),23);return new Uint8Array([0+t]).buffer}function o(t,r){if(t=parseInt(""+t,r),isNaN(t))throw new RangeError("Invalid number.");return e(0,24,t=(t=Math.min(Math.max(0,t),255)).toString(16))}function a(t,r){if(t=parseInt(""+t,r),isNaN(t))throw new RangeError("Invalid number.");return e(0,25,t=(t=Math.min(Math.max(0,t),65535)).toString(16))}function c(t,r){if(t=parseInt(""+t,r),isNaN(t))throw new RangeError("Invalid number.");return e(0,26,t=(t=Math.min(Math.max(0,t),4294967295)).toString(16))}function u(t,r){if("string"==typeof t&&16==r){if(t.match(/[^0-9a-fA-F]/))throw new RangeError("Invalid number.");return e(0,27,t)}if(t=parseInt(""+t,r),isNaN(t))throw new RangeError("Invalid number.");return e(0,27,t=(t=Math.min(Math.max(0,t),9007199254740992)).toString(16))}function f(t){if(isNaN(t))throw new RangeError("Invalid number.");if(0===t)return s(0);t=Math.min(Math.max(0,-t),24)-1;return new Uint8Array([32+t]).buffer}function h(t,r){if(t=parseInt(""+t,r),isNaN(t))throw new RangeError("Invalid number.");return e(1,24,t=(t=Math.min(Math.max(0,-t-1),255)).toString(16))}function l(t,r){if(t=parseInt(""+t,r),isNaN(t))throw new RangeError("Invalid number.");return e(1,25,t=(t=Math.min(Math.max(0,-t-1),65535)).toString(16))}function d(t,r){if(t=parseInt(""+t,r),isNaN(t))throw new RangeError("Invalid number.");return e(1,26,t=(t=Math.min(Math.max(0,-t-1),4294967295)).toString(16))}function p(t,r){if("string"==typeof t&&16==r){if((t=t.startsWith("-")?t.slice(1):"0").match(/[^0-9a-fA-F]/)||t.length>16)throw new RangeError("Invalid number.");let r=!1,n=t.split("").reduceRight((t,e)=>{if(r)return e+t;let n=parseInt(e,16)-1;return n>=0?(r=!0,n.toString(16)+t):"f"+t},"");return r?e(1,27,n):u(0)}if(t=parseInt(""+t,r),isNaN(t))throw new RangeError("Invalid number.");return e(1,27,t=(t=Math.min(Math.max(0,-t-1),9007199254740992)).toString(16))}function y(){return i(new Uint8Array([245]))}function g(){return i(new Uint8Array([244]))}return Xr.tagged=function(e,r){if(14277111==e)return t(new Uint8Array([217,217,247]),r);if(e<24)return t(new Uint8Array([192+e]),r);{const t=e<=255?24:e<=65535?25:e<=4294967295?26:27,r=2**(t-24),n=e.toString(16).slice(2*-r).padStart(2*r,"0"),i=[192+t].concat(n.match(/../g).map(t=>parseInt(t,16)));return new Uint8Array(i).buffer}},Xr.raw=i,Xr.uSmall=s,Xr.u8=o,Xr.u16=a,Xr.u32=c,Xr.u64=u,Xr.iSmall=f,Xr.i8=h,Xr.i16=l,Xr.i32=d,Xr.i64=p,Xr.number=function(t){return t>=0?t<24?s(t):t<=255?o(t):t<=65535?a(t):t<=4294967295?c(t):u(t):t>=-24?f(t):t>=-255?h(t):t>=-65535?l(t):t>=-4294967295?d(t):p(t)},Xr.bytes=function(e){return t(r(2,e.byteLength),e)},Xr.string=function(t){return n(t)},Xr.array=function(e){return t(r(4,e.length),...e)},Xr.map=function(e,i=!1){e instanceof Map||(e=new Map(Object.entries(e)));let s=Array.from(e.entries());return i&&(s=s.sort(([t],[e])=>t.localeCompare(e))),t(r(5,e.size),...s.map(([e,r])=>t(n(e),r)))},Xr.singleFloat=function(e){const r=new Float32Array([e]);return t(new Uint8Array([250]),new Uint8Array(r.buffer))},Xr.doubleFloat=function(e){const r=new Float64Array([e]);return t(new Uint8Array([251]),new Uint8Array(r.buffer))},Xr.bool=function(t){return t?y():g()},Xr.true_=y,Xr.false_=g,Xr.null_=function(){return i(new Uint8Array([246]))},Xr.undefined_=function(){return i(new Uint8Array([247]))},Xr}var Qr=(Hr||(Hr=1,function(t){var e=Yr&&Yr.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(function(){if(Zr)return Wr;Zr=1;var t=Wr&&Wr.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(Wr,"__esModule",{value:!0});const e=t(Jr()),r=[ArrayBuffer,Uint8Array,Uint16Array,Uint32Array,Int8Array,Int16Array,Int32Array,Float32Array,Float64Array];class n{constructor(t,e=!1){this._serializer=t,this._stable=e,this.name="jsonDefault",this.priority=-100}match(t){return-1!=["undefined","boolean","number","string","object"].indexOf(typeof t)}encode(t){switch(typeof t){case"undefined":return e.undefined_();case"boolean":return e.bool(t);case"number":return Math.floor(t)===t?e.number(t):e.doubleFloat(t);case"string":return e.string(t);case"object":if(null===t)return e.null_();if(Array.isArray(t))return e.array(t.map(t=>this._serializer.serializeValue(t)));if(r.find(e=>t instanceof e))return e.bytes(t.buffer);if(-1!==Object.getOwnPropertyNames(t).indexOf("toJSON"))return this.encode(t.toJSON());if(t instanceof Map){const r=new Map;for(const[e,n]of t.entries())r.set(e,this._serializer.serializeValue(n));return e.map(r,this._stable)}{const r=new Map;for(const[e,n]of Object.entries(t))r.set(e,this._serializer.serializeValue(n));return e.map(r,this._stable)}default:throw new Error("Invalid value.")}}}Wr.JsonDefaultCborEncoder=n;class i{constructor(){this.name="cborEncoder",this.priority=-90}match(t){return"object"==typeof t&&"function"==typeof t.toCBOR}encode(t){return t.toCBOR()}}Wr.ToCborEncoder=i;class s{constructor(){this._encoders=new Set}static withDefaultEncoders(t=!1){const e=new this;return e.addEncoder(new n(e,t)),e.addEncoder(new i),e}removeEncoder(t){for(const e of this._encoders.values())e.name==t&&this._encoders.delete(e)}addEncoder(t){this._encoders.add(t)}getEncoderFor(t){let e=null;for(const r of this._encoders)(!e||r.priority>e.priority)&&r.match(t)&&(e=r);if(null===e)throw new Error("Could not find an encoder for value.");return e}serializeValue(t){return this.getEncoderFor(t).encode(t)}serialize(t){return this.serializeValue(t)}}return Wr.CborSerializer=s,Wr.SelfDescribeCborSerializer=class extends s{serialize(t){return e.raw(new Uint8Array([...new Uint8Array([217,217,247]),...new Uint8Array(super.serializeValue(t))]))}},Wr}());const r=e(Jr());t.value=r}(Yr)),Yr);const tn=Qr.SelfDescribeCborSerializer.withDefaultEncoders(!0);var en;function rn(t){return tn.serialize(t)}function nn(t){const e=t.byteLength;let r=BigInt(0);for(let n=0;n<e;n++)r=r*BigInt(256)+BigInt(t[n]);return r}tn.addEncoder(new class{get name(){return"Principal"}get priority(){return 0}match(t){return t&&!0===t._isPrincipal}encode(t){return Qr.value.bytes(t.toUint8Array())}}),tn.addEncoder(new class{get name(){return"Buffer"}get priority(){return 1}match(t){return t instanceof ArrayBuffer||ArrayBuffer.isView(t)}encode(t){return Qr.value.bytes(new Uint8Array(t))}}),tn.addEncoder(new class{get name(){return"BigInt"}get priority(){return 1}match(t){return"bigint"==typeof t}encode(t){return t>BigInt(0)?Qr.value.tagged(2,Qr.value.bytes(At(t.toString(16)))):Qr.value.tagged(3,Qr.value.bytes(At((BigInt("-1")*t).toString(16))))}}),function(t){t[t.Uint64LittleEndian=71]="Uint64LittleEndian",t[t.Semantic=55799]="Semantic"}(en||(en={}));class sn extends Mr.Decoder{createByteString(t){return It(...t)}createByteStringFromHeap(t,e){return t===e?new ArrayBuffer(0):new Uint8Array(this._heap.slice(t,e))}}function on(t){const e=new Uint8Array(t),r=new sn({size:e.byteLength,tags:{2:t=>nn(t),3:t=>-nn(t),[en.Semantic]:t=>t}});try{return r.decodeFirst(e)}catch(t){throw new Error(`Failed to decode CBOR: ${t}, input: ${xt(e)}`)}}const an=()=>{if("undefined"!=typeof window&&window.crypto&&window.crypto.getRandomValues){const t=new Uint32Array(1);return window.crypto.getRandomValues(t),t[0]}if("undefined"!=typeof crypto&&crypto.getRandomValues){const t=new Uint32Array(1);return crypto.getRandomValues(t),t[0]}return"undefined"!=typeof crypto&&crypto.randomInt?crypto.randomInt(0,4294967295):Math.floor(4294967295*Math.random())};var cn;function un(){const t=new ArrayBuffer(16),e=new DataView(t),r=an(),n=an(),i=an(),s=an();return e.setUint32(0,r),e.setUint32(4,n),e.setUint32(8,i),e.setUint32(12,s),t}!function(t){t.Call="call"}(cn||(cn={}));const fn=BigInt(1e6);class hn{constructor(t){if(t<9e4){const e=BigInt(Date.now()+t)*fn/BigInt(1e9);return void(this._value=e*BigInt(1e9))}const e=BigInt(Math.floor(Date.now()+t-6e4))*fn/BigInt(1e9)/BigInt(60)*BigInt(60)*BigInt(1e9);this._value=e}toCBOR(){return Qr.value.u64(this._value.toString(16),16)}toHash(){return Dt(this._value)}}function ln(t=un){return async e=>{const r=e.request.headers;e.request.headers=r,"call"===e.endpoint&&(e.body.nonce=t())}}function dn(t){const e=[];return t.forEach((t,r)=>{e.push([r,t])}),e}class pn extends Ut{constructor(t,e){super(t),this.response=e,this.name=this.constructor.name,Object.setPrototypeOf(this,new.target.prototype)}}class yn extends Ut{constructor(t,e,r,n,i,s){super(t),this.response=e,this.requestId=r,this.senderPubkey=n,this.senderSig=i,this.ingressExpiry=s,this.name="AgentCallError",Object.setPrototypeOf(this,new.target.prototype)}}class gn extends Ut{constructor(t,e,r,n,i,s){super(t),this.response=e,this.requestId=r,this.senderPubkey=n,this.senderSig=i,this.ingressExpiry=s,this.name="AgentQueryError",Object.setPrototypeOf(this,new.target.prototype)}}class bn extends Ut{constructor(t,e,r,n,i,s){super(t),this.response=e,this.requestId=r,this.senderPubkey=n,this.senderSig=i,this.ingressExpiry=s,this.name="AgentReadStateError",Object.setPrototypeOf(this,new.target.prototype)}}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const wn=BigInt(0),mn=BigInt(1);function vn(t,e=""){if("boolean"!=typeof t){throw new Error((e&&`"${e}"`)+"expected boolean, got type="+typeof t)}return t}function En(t,e,r=""){const n=g(t),i=t?.length,s=void 0!==e;if(!n||s&&i!==e){throw new Error((r&&`"${r}" `)+"expected Uint8Array"+(s?` of length ${e}`:"")+", got "+(n?`length=${i}`:"type="+typeof t))}return t}function _n(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);return""===t?wn:BigInt("0x"+t)}function Bn(t){return _n(I(t))}function In(t){return b(t),_n(I(Uint8Array.from(t).reverse()))}function xn(t,e){return U(t.toString(16).padStart(2*e,"0"))}function Tn(t,e){return xn(t,e).reverse()}function An(t,e,r){let n;if("string"==typeof e)try{n=U(e)}catch(e){throw new Error(t+" must be hex string or Uint8Array, cause: "+e)}else{if(!g(e))throw new Error(t+" must be hex string or Uint8Array");n=Uint8Array.from(e)}const i=n.length;if("number"==typeof r&&i!==r)throw new Error(t+" of length "+r+" expected, got "+i);return n}function Sn(t){return Uint8Array.from(t)}const Nn=t=>"bigint"==typeof t&&wn<=t;function On(t,e,r){return Nn(t)&&Nn(e)&&Nn(r)&&e<=t&&t<r}function Rn(t,e,r,n){if(!On(e,r,n))throw new Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}function Un(t){let e;for(e=0;t>wn;t>>=mn,e+=1);return e}function Fn(t,e){return t>>BigInt(e)&mn}const kn=t=>(mn<<BigInt(t))-mn;function Ln(t,e,r={}){if(!t||"object"!=typeof t)throw new Error("expected valid options object");function n(e,r,n){const i=t[e];if(n&&void 0===i)return;const s=typeof i;if(s!==r||null===i)throw new Error(`param "${e}" is invalid: expected ${r}, got ${s}`)}Object.entries(e).forEach(([t,e])=>n(t,e,!1)),Object.entries(r).forEach(([t,e])=>n(t,e,!0))}const Pn=()=>{throw new Error("not implemented")};function Cn(t){const e=new WeakMap;return(r,...n)=>{const i=e.get(r);if(void 0!==i)return i;const s=t(r,...n);return e.set(r,s),s}}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const jn=BigInt(0),Mn=BigInt(1),Vn=BigInt(2),Dn=BigInt(3),qn=BigInt(4),$n=BigInt(5),Gn=BigInt(7),zn=BigInt(8),Kn=BigInt(9),Zn=BigInt(16);function Hn(t,e){const r=t%e;return r>=jn?r:e+r}function Yn(t,e,r){let n=t;for(;e-- >jn;)n*=n,n%=r;return n}function Wn(t,e){if(t===jn)throw new Error("invert: expected non-zero number");if(e<=jn)throw new Error("invert: expected positive modulus, got "+e);let r=Hn(t,e),n=e,i=jn,s=Mn;for(;r!==jn;){const t=n%r,e=i-s*(n/r);n=r,r=t,i=s,s=e}if(n!==Mn)throw new Error("invert: does not exist");return Hn(i,e)}function Xn(t,e,r){if(!t.eql(t.sqr(e),r))throw new Error("Cannot find square root")}function Jn(t,e){const r=(t.ORDER+Mn)/qn,n=t.pow(e,r);return Xn(t,n,e),n}function Qn(t,e){const r=(t.ORDER-$n)/zn,n=t.mul(e,Vn),i=t.pow(n,r),s=t.mul(e,i),o=t.mul(t.mul(s,Vn),i),a=t.mul(s,t.sub(o,t.ONE));return Xn(t,a,e),a}function ti(t){if(t<Dn)throw new Error("sqrt is not defined for small field");let e=t-Mn,r=0;for(;e%Vn===jn;)e/=Vn,r++;let n=Vn;const i=ci(t);for(;1===oi(i,n);)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(1===r)return Jn;let s=i.pow(n,e);const o=(e+Mn)/Vn;return function(t,n){if(t.is0(n))return n;if(1!==oi(t,n))throw new Error("Cannot find square root");let i=r,a=t.mul(t.ONE,s),c=t.pow(n,e),u=t.pow(n,o);for(;!t.eql(c,t.ONE);){if(t.is0(c))return t.ZERO;let e=1,r=t.sqr(c);for(;!t.eql(r,t.ONE);)if(e++,r=t.sqr(r),e===i)throw new Error("Cannot find square root");const n=Mn<<BigInt(i-e-1),s=t.pow(a,n);i=e,a=t.sqr(s),c=t.mul(c,a),u=t.mul(u,s)}return u}}function ei(t){return t%qn===Dn?Jn:t%zn===$n?Qn:t%Zn===Kn?function(t){const e=ci(t),r=ti(t),n=r(e,e.neg(e.ONE)),i=r(e,n),s=r(e,e.neg(n)),o=(t+Gn)/Zn;return(t,e)=>{let r=t.pow(e,o),a=t.mul(r,n);const c=t.mul(r,i),u=t.mul(r,s),f=t.eql(t.sqr(a),e),h=t.eql(t.sqr(c),e);r=t.cmov(r,a,f),a=t.cmov(u,c,h);const l=t.eql(t.sqr(a),e),d=t.cmov(r,a,l);return Xn(t,d,e),d}}(t):ti(t)}const ri=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function ni(t){return Ln(t,ri.reduce((t,e)=>(t[e]="function",t),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"})),t}function ii(t,e,r){if(r<jn)throw new Error("invalid exponent, negatives unsupported");if(r===jn)return t.ONE;if(r===Mn)return e;let n=t.ONE,i=e;for(;r>jn;)r&Mn&&(n=t.mul(n,i)),i=t.sqr(i),r>>=Mn;return n}function si(t,e,r=!1){const n=new Array(e.length).fill(r?t.ZERO:void 0),i=e.reduce((e,r,i)=>t.is0(r)?e:(n[i]=e,t.mul(e,r)),t.ONE),s=t.inv(i);return e.reduceRight((e,r,i)=>t.is0(r)?e:(n[i]=t.mul(e,n[i]),t.mul(e,r)),s),n}function oi(t,e){const r=(t.ORDER-Mn)/Vn,n=t.pow(e,r),i=t.eql(n,t.ONE),s=t.eql(n,t.ZERO),o=t.eql(n,t.neg(t.ONE));if(!i&&!s&&!o)throw new Error("invalid Legendre symbol result");return i?1:s?0:-1}function ai(t,e){void 0!==e&&function(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}(e);const r=void 0!==e?e:t.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function ci(t,e,r=!1,n={}){if(t<=jn)throw new Error("invalid field: expected ORDER > 0, got "+t);let i,s,o,a=!1;if("object"==typeof e&&null!=e){if(n.sqrt||r)throw new Error("cannot specify opts in two arguments");const t=e;t.BITS&&(i=t.BITS),t.sqrt&&(s=t.sqrt),"boolean"==typeof t.isLE&&(r=t.isLE),"boolean"==typeof t.modFromBytes&&(a=t.modFromBytes),o=t.allowedLengths}else"number"==typeof e&&(i=e),n.sqrt&&(s=n.sqrt);const{nBitLength:c,nByteLength:u}=ai(t,i);if(u>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let f;const h=Object.freeze({ORDER:t,isLE:r,BITS:c,BYTES:u,MASK:kn(c),ZERO:jn,ONE:Mn,allowedLengths:o,create:e=>Hn(e,t),isValid:e=>{if("bigint"!=typeof e)throw new Error("invalid field element: expected bigint, got "+typeof e);return jn<=e&&e<t},is0:t=>t===jn,isValidNot0:t=>!h.is0(t)&&h.isValid(t),isOdd:t=>(t&Mn)===Mn,neg:e=>Hn(-e,t),eql:(t,e)=>t===e,sqr:e=>Hn(e*e,t),add:(e,r)=>Hn(e+r,t),sub:(e,r)=>Hn(e-r,t),mul:(e,r)=>Hn(e*r,t),pow:(t,e)=>ii(h,t,e),div:(e,r)=>Hn(e*Wn(r,t),t),sqrN:t=>t*t,addN:(t,e)=>t+e,subN:(t,e)=>t-e,mulN:(t,e)=>t*e,inv:e=>Wn(e,t),sqrt:s||(e=>(f||(f=ei(t)),f(h,e))),toBytes:t=>r?Tn(t,u):xn(t,u),fromBytes:(e,n=!0)=>{if(o){if(!o.includes(e.length)||e.length>u)throw new Error("Field.fromBytes: expected "+o+" bytes, got "+e.length);const t=new Uint8Array(u);t.set(e,r?0:t.length-e.length),e=t}if(e.length!==u)throw new Error("Field.fromBytes: expected "+u+" bytes, got "+e.length);let i=r?In(e):Bn(e);if(a&&(i=Hn(i,t)),!n&&!h.isValid(i))throw new Error("invalid field element: outside of range 0..ORDER");return i},invertBatch:t=>si(h,t),cmov:(t,e,r)=>r?e:t});return Object.freeze(h)}function ui(t){if("bigint"!=typeof t)throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function fi(t){const e=ui(t);return e+Math.ceil(e/2)}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const hi=BigInt(0),li=BigInt(1);function di(t,e){const r=e.negate();return t?r:e}function pi(t,e){const r=si(t.Fp,e.map(t=>t.Z));return e.map((e,n)=>t.fromAffine(e.toAffine(r[n])))}function yi(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function gi(t,e){yi(t,e);const r=2**t;return{windows:Math.ceil(e/t)+1,windowSize:2**(t-1),mask:kn(t),maxNumber:r,shiftBy:BigInt(t)}}function bi(t,e,r){const{windowSize:n,mask:i,maxNumber:s,shiftBy:o}=r;let a=Number(t&i),c=t>>o;a>n&&(a-=s,c+=li);const u=e*n;return{nextN:c,offset:u+Math.abs(a)-1,isZero:0===a,isNeg:a<0,isNegF:e%2!=0,offsetF:u}}const wi=new WeakMap,mi=new WeakMap;function vi(t){return mi.get(t)||1}function Ei(t){if(t!==hi)throw new Error("invalid wNAF")}class _i{constructor(t,e){this.BASE=t.BASE,this.ZERO=t.ZERO,this.Fn=t.Fn,this.bits=e}_unsafeLadder(t,e,r=this.ZERO){let n=t;for(;e>hi;)e&li&&(r=r.add(n)),n=n.double(),e>>=li;return r}precomputeWindow(t,e){const{windows:r,windowSize:n}=gi(e,this.bits),i=[];let s=t,o=s;for(let t=0;t<r;t++){o=s,i.push(o);for(let t=1;t<n;t++)o=o.add(s),i.push(o);s=o.double()}return i}wNAF(t,e,r){if(!this.Fn.isValid(r))throw new Error("invalid scalar");let n=this.ZERO,i=this.BASE;const s=gi(t,this.bits);for(let t=0;t<s.windows;t++){const{nextN:o,offset:a,isZero:c,isNeg:u,isNegF:f,offsetF:h}=bi(r,t,s);r=o,c?i=i.add(di(f,e[h])):n=n.add(di(u,e[a]))}return Ei(r),{p:n,f:i}}wNAFUnsafe(t,e,r,n=this.ZERO){const i=gi(t,this.bits);for(let t=0;t<i.windows&&r!==hi;t++){const{nextN:s,offset:o,isZero:a,isNeg:c}=bi(r,t,i);if(r=s,!a){const t=e[o];n=n.add(c?t.negate():t)}}return Ei(r),n}getPrecomputes(t,e,r){let n=wi.get(e);return n||(n=this.precomputeWindow(e,t),1!==t&&("function"==typeof r&&(n=r(n)),wi.set(e,n))),n}cached(t,e,r){const n=vi(t);return this.wNAF(n,this.getPrecomputes(n,t,r),e)}unsafe(t,e,r,n){const i=vi(t);return 1===i?this._unsafeLadder(t,e,n):this.wNAFUnsafe(i,this.getPrecomputes(i,t,r),e,n)}createCache(t,e){yi(e,this.bits),mi.set(t,e),wi.delete(t)}hasCache(t){return 1!==vi(t)}}function Bi(t,e,r,n){!function(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((t,r)=>{if(!(t instanceof e))throw new Error("invalid point at index "+r)})}(r,t),function(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((t,r)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+r)})}(n,e);const i=r.length,s=n.length;if(i!==s)throw new Error("arrays of points and scalars must have equal length");const o=t.ZERO,a=Un(BigInt(i));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const u=kn(c),f=new Array(Number(u)+1).fill(o);let h=o;for(let t=Math.floor((e.BITS-1)/c)*c;t>=0;t-=c){f.fill(o);for(let e=0;e<s;e++){const i=n[e],s=Number(i>>BigInt(t)&u);f[s]=f[s].add(r[e])}let e=o;for(let t=f.length-1,r=o;t>0;t--)r=r.add(f[t]),e=e.add(r);if(h=h.add(e),0!==t)for(let t=0;t<c;t++)h=h.double()}return h}function Ii(t,e,r){if(e){if(e.ORDER!==t)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return ni(e),e}return ci(t,{isLE:r})}function xi(t,e,r={},n){if(void 0===n&&(n="edwards"===t),!e||"object"!=typeof e)throw new Error(`expected valid ${t} CURVE object`);for(const t of["p","n","h"]){const r=e[t];if(!("bigint"==typeof r&&r>hi))throw new Error(`CURVE.${t} must be positive bigint`)}const i=Ii(e.p,r.Fp,n),s=Ii(e.n,r.Fn,n),o=["Gx","Gy","a","weierstrass"===t?"b":"d"];for(const t of o)if(!i.isValid(e[t]))throw new Error(`CURVE.${t} must be valid field element of CURVE.Fp`);return{CURVE:e=Object.freeze(Object.assign({},e)),Fp:i,Fn:s}}const Ti=Bn;function Ai(t,e){if(Ni(t),Ni(e),t<0||t>=1<<8*e)throw new Error("invalid I2OSP input: "+t);const r=Array.from({length:e}).fill(0);for(let n=e-1;n>=0;n--)r[n]=255&t,t>>>=8;return new Uint8Array(r)}function Si(t,e){const r=new Uint8Array(t.length);for(let n=0;n<t.length;n++)r[n]=t[n]^e[n];return r}function Ni(t){if(!Number.isSafeInteger(t))throw new Error("number expected")}function Oi(t){if(!g(t)&&"string"!=typeof t)throw new Error("DST must be Uint8Array or string");return"string"==typeof t?F(t):t}function Ri(t,e,r){Ln(r,{p:"bigint",m:"number",k:"number",hash:"function"});const{p:n,k:i,m:s,hash:o,expand:a,DST:c}=r;if("function"!=typeof(u=r.hash)||!Number.isSafeInteger(u.outputLen))throw new Error("expected valid hash");var u;b(t),Ni(e);const f=n.toString(2).length,h=Math.ceil((f+i)/8),l=e*s*h;let d;if("xmd"===a)d=function(t,e,r,n){b(t),Ni(r),(e=Oi(e)).length>255&&(e=n(L(F("H2C-OVERSIZE-DST-"),e)));const{outputLen:i,blockLen:s}=n,o=Math.ceil(r/i);if(r>65535||o>255)throw new Error("expand_message_xmd: invalid lenInBytes");const a=L(e,Ai(e.length,1)),c=Ai(0,s),u=Ai(r,2),f=new Array(o),h=n(L(c,t,u,Ai(0,1),a));f[0]=n(L(h,Ai(1,1),a));for(let t=1;t<=o;t++){const e=[Si(h,f[t-1]),Ai(t+1,1),a];f[t]=n(L(...e))}return L(...f).slice(0,r)}(t,c,l,o);else if("xof"===a)d=function(t,e,r,n,i){if(b(t),Ni(r),(e=Oi(e)).length>255){const t=Math.ceil(2*n/8);e=i.create({dkLen:t}).update(F("H2C-OVERSIZE-DST-")).update(e).digest()}if(r>65535||e.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:r}).update(t).update(Ai(r,2)).update(e).update(Ai(e.length,1)).digest()}(t,c,l,i,o);else{if("_internal_pass"!==a)throw new Error('expand must be "xmd" or "xof"');d=t}const p=new Array(e);for(let t=0;t<e;t++){const e=new Array(s);for(let r=0;r<s;r++){const i=h*(r+t*s),o=d.subarray(i,i+h);e[r]=Hn(Ti(o),n)}p[t]=e}return p}function Ui(t,e){const r=e.map(t=>Array.from(t).reverse());return(e,n)=>{const[i,s,o,a]=r.map(r=>r.reduce((r,n)=>t.add(t.mul(r,e),n))),[c,u]=si(t,[s,a],!0);return e=t.mul(i,c),n=t.mul(n,t.mul(o,u)),{x:e,y:n}}}const Fi=F("HashToScalar-");function ki(t,e,r){if("function"!=typeof e)throw new Error("mapToCurve() must be defined");function n(r){return t.fromAffine(e(r))}function i(e){const r=e.clearCofactor();return r.equals(t.ZERO)?t.ZERO:(r.assertValidity(),r)}return{defaults:r,hashToCurve(t,e){const s=Ri(t,2,Object.assign({},r,e)),o=n(s[0]),a=n(s[1]);return i(o.add(a))},encodeToCurve(t,e){const s=r.encodeDST?{DST:r.encodeDST}:{};return i(n(Ri(t,1,Object.assign({},r,s,e))[0]))},mapToCurve(t){if(!Array.isArray(t))throw new Error("expected array of bigints");for(const e of t)if("bigint"!=typeof e)throw new Error("expected array of bigints");return i(n(t))},hashToScalar(e,n){const i=t.Fn.ORDER;return Ri(e,1,Object.assign({},r,{p:i,m:1,DST:Fi},n))[0][0]}}}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Li=(t,e)=>(t+(t>=0?e:-e)/ji)/e;const Pi=BigInt(0),Ci=BigInt(1),ji=BigInt(2),Mi=BigInt(3),Vi=BigInt(4);function Di(t,e){const{BYTES:r}=t;let n;if("bigint"==typeof e)n=e;else{let i=An("private key",e);try{n=t.fromBytes(i)}catch(t){throw new Error(`invalid private key: expected ui8a of size ${r}, got ${typeof e}`)}}if(!t.isValidNot0(n))throw new Error("invalid private key: out of range [1..N-1]");return n}function qi(t,e={}){const r=xi("weierstrass",t,e),{Fp:n,Fn:i}=r;let s=r.CURVE;const{h:o,n:a}=s;Ln(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:c}=e;if(c&&(!n.is0(s.a)||"bigint"!=typeof c.beta||!Array.isArray(c.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');const u=function(t,e){return{secretKey:e.BYTES,publicKey:1+t.BYTES,publicKeyUncompressed:1+2*t.BYTES,publicKeyHasPrefix:!0,signature:2*e.BYTES}}(n,i);function f(){if(!n.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}const h=e.toBytes||function(t,e,r){const{x:i,y:s}=e.toAffine(),o=n.toBytes(i);if(vn(r,"isCompressed"),r){f();return L(function(t){return Uint8Array.of(t?2:3)}(!n.isOdd(s)),o)}return L(Uint8Array.of(4),o,n.toBytes(s))},l=e.fromBytes||function(t){En(t,void 0,"Point");const{publicKey:e,publicKeyUncompressed:r}=u,i=t.length,s=t[0],o=t.subarray(1);if(i!==e||2!==s&&3!==s){if(i===r&&4===s){const t=n.BYTES,e=n.fromBytes(o.subarray(0,t)),r=n.fromBytes(o.subarray(t,2*t));if(!p(e,r))throw new Error("bad point: is not on curve");return{x:e,y:r}}throw new Error(`bad point: got length ${i}, expected compressed=${e} or uncompressed=${r}`)}{const t=n.fromBytes(o);if(!n.isValid(t))throw new Error("bad point: is not on curve, wrong x");const e=d(t);let r;try{r=n.sqrt(e)}catch(t){const e=t instanceof Error?": "+t.message:"";throw new Error("bad point: is not on curve, sqrt error"+e)}f();return!(1&~s)!==n.isOdd(r)&&(r=n.neg(r)),{x:t,y:r}}};function d(t){const e=n.sqr(t),r=n.mul(e,t);return n.add(n.add(r,n.mul(t,s.a)),s.b)}function p(t,e){const r=n.sqr(e),i=d(t);return n.eql(r,i)}if(!p(s.Gx,s.Gy))throw new Error("bad curve params: generator point");const y=n.mul(n.pow(s.a,Mi),Vi),g=n.mul(n.sqr(s.b),BigInt(27));if(n.is0(n.add(y,g)))throw new Error("bad curve params: a or b");function b(t,e,r=!1){if(!n.isValid(e)||r&&n.is0(e))throw new Error(`bad point coordinate ${t}`);return e}function w(t){if(!(t instanceof B))throw new Error("ProjectivePoint expected")}function m(t){if(!c||!c.basises)throw new Error("no endo");return function(t,e,r){const[[n,i],[s,o]]=e,a=Li(o*t,r),c=Li(-i*t,r);let u=t-a*n-c*s,f=-a*i-c*o;const h=u<Pi,l=f<Pi;h&&(u=-u),l&&(f=-f);const d=kn(Math.ceil(Un(r)/2))+Ci;if(u<Pi||u>=d||f<Pi||f>=d)throw new Error("splitScalar (endomorphism): failed, k="+t);return{k1neg:h,k1:u,k2neg:l,k2:f}}(t,c.basises,i.ORDER)}const v=Cn((t,e)=>{const{X:r,Y:i,Z:s}=t;if(n.eql(s,n.ONE))return{x:r,y:i};const o=t.is0();null==e&&(e=o?n.ONE:n.inv(s));const a=n.mul(r,e),c=n.mul(i,e),u=n.mul(s,e);if(o)return{x:n.ZERO,y:n.ZERO};if(!n.eql(u,n.ONE))throw new Error("invZ was invalid");return{x:a,y:c}}),E=Cn(t=>{if(t.is0()){if(e.allowInfinityPoint&&!n.is0(t.Y))return;throw new Error("bad point: ZERO")}const{x:r,y:i}=t.toAffine();if(!n.isValid(r)||!n.isValid(i))throw new Error("bad point: x or y not field elements");if(!p(r,i))throw new Error("bad point: equation left != right");if(!t.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function _(t,e,r,i,s){return r=new B(n.mul(r.X,t),r.Y,r.Z),e=di(i,e),r=di(s,r),e.add(r)}class B{constructor(t,e,r){this.X=b("x",t),this.Y=b("y",e,!0),this.Z=b("z",r),Object.freeze(this)}static CURVE(){return s}static fromAffine(t){const{x:e,y:r}=t||{};if(!t||!n.isValid(e)||!n.isValid(r))throw new Error("invalid affine point");if(t instanceof B)throw new Error("projective point not allowed");return n.is0(e)&&n.is0(r)?B.ZERO:new B(e,r,n.ONE)}static fromBytes(t){const e=B.fromAffine(l(En(t,void 0,"point")));return e.assertValidity(),e}static fromHex(t){return B.fromBytes(An("pointHex",t))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(t=8,e=!0){return T.createCache(this,t),e||this.multiply(Mi),this}assertValidity(){E(this)}hasEvenY(){const{y:t}=this.toAffine();if(!n.isOdd)throw new Error("Field doesn't support isOdd");return!n.isOdd(t)}equals(t){w(t);const{X:e,Y:r,Z:i}=this,{X:s,Y:o,Z:a}=t,c=n.eql(n.mul(e,a),n.mul(s,i)),u=n.eql(n.mul(r,a),n.mul(o,i));return c&&u}negate(){return new B(this.X,n.neg(this.Y),this.Z)}double(){const{a:t,b:e}=s,r=n.mul(e,Mi),{X:i,Y:o,Z:a}=this;let c=n.ZERO,u=n.ZERO,f=n.ZERO,h=n.mul(i,i),l=n.mul(o,o),d=n.mul(a,a),p=n.mul(i,o);return p=n.add(p,p),f=n.mul(i,a),f=n.add(f,f),c=n.mul(t,f),u=n.mul(r,d),u=n.add(c,u),c=n.sub(l,u),u=n.add(l,u),u=n.mul(c,u),c=n.mul(p,c),f=n.mul(r,f),d=n.mul(t,d),p=n.sub(h,d),p=n.mul(t,p),p=n.add(p,f),f=n.add(h,h),h=n.add(f,h),h=n.add(h,d),h=n.mul(h,p),u=n.add(u,h),d=n.mul(o,a),d=n.add(d,d),h=n.mul(d,p),c=n.sub(c,h),f=n.mul(d,l),f=n.add(f,f),f=n.add(f,f),new B(c,u,f)}add(t){w(t);const{X:e,Y:r,Z:i}=this,{X:o,Y:a,Z:c}=t;let u=n.ZERO,f=n.ZERO,h=n.ZERO;const l=s.a,d=n.mul(s.b,Mi);let p=n.mul(e,o),y=n.mul(r,a),g=n.mul(i,c),b=n.add(e,r),m=n.add(o,a);b=n.mul(b,m),m=n.add(p,y),b=n.sub(b,m),m=n.add(e,i);let v=n.add(o,c);return m=n.mul(m,v),v=n.add(p,g),m=n.sub(m,v),v=n.add(r,i),u=n.add(a,c),v=n.mul(v,u),u=n.add(y,g),v=n.sub(v,u),h=n.mul(l,m),u=n.mul(d,g),h=n.add(u,h),u=n.sub(y,h),h=n.add(y,h),f=n.mul(u,h),y=n.add(p,p),y=n.add(y,p),g=n.mul(l,g),m=n.mul(d,m),y=n.add(y,g),g=n.sub(p,g),g=n.mul(l,g),m=n.add(m,g),p=n.mul(y,m),f=n.add(f,p),p=n.mul(v,m),u=n.mul(b,u),u=n.sub(u,p),p=n.mul(b,y),h=n.mul(v,h),h=n.add(h,p),new B(u,f,h)}subtract(t){return this.add(t.negate())}is0(){return this.equals(B.ZERO)}multiply(t){const{endo:r}=e;if(!i.isValidNot0(t))throw new Error("invalid scalar: out of range");let n,s;const o=t=>T.cached(this,t,t=>pi(B,t));if(r){const{k1neg:e,k1:i,k2neg:a,k2:c}=m(t),{p:u,f:f}=o(i),{p:h,f:l}=o(c);s=f.add(l),n=_(r.beta,u,h,e,a)}else{const{p:e,f:r}=o(t);n=e,s=r}return pi(B,[n,s])[0]}multiplyUnsafe(t){const{endo:r}=e,n=this;if(!i.isValid(t))throw new Error("invalid scalar: out of range");if(t===Pi||n.is0())return B.ZERO;if(t===Ci)return n;if(T.hasCache(this))return this.multiply(t);if(r){const{k1neg:e,k1:i,k2neg:s,k2:o}=m(t),{p1:a,p2:c}=function(t,e,r,n){let i=e,s=t.ZERO,o=t.ZERO;for(;r>hi||n>hi;)r&li&&(s=s.add(i)),n&li&&(o=o.add(i)),i=i.double(),r>>=li,n>>=li;return{p1:s,p2:o}}(B,n,i,o);return _(r.beta,a,c,e,s)}return T.unsafe(n,t)}multiplyAndAddUnsafe(t,e,r){const n=this.multiplyUnsafe(e).add(t.multiplyUnsafe(r));return n.is0()?void 0:n}toAffine(t){return v(this,t)}isTorsionFree(){const{isTorsionFree:t}=e;return o===Ci||(t?t(B,this):T.unsafe(this,a).is0())}clearCofactor(){const{clearCofactor:t}=e;return o===Ci?this:t?t(B,this):this.multiplyUnsafe(o)}isSmallOrder(){return this.multiplyUnsafe(o).is0()}toBytes(t=!0){return vn(t,"isCompressed"),this.assertValidity(),h(B,this,t)}toHex(t=!0){return I(this.toBytes(t))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(t=!0){return this.toBytes(t)}_setWindowSize(t){this.precompute(t)}static normalizeZ(t){return pi(B,t)}static msm(t,e){return Bi(B,i,t,e)}static fromPrivateKey(t){return B.BASE.multiply(Di(i,t))}}B.BASE=new B(s.Gx,s.Gy,n.ONE),B.ZERO=new B(n.ZERO,n.ONE,n.ZERO),B.Fp=n,B.Fn=i;const x=i.BITS,T=new _i(B,e.endo?Math.ceil(x/2):x);return B.BASE.precompute(8),B}function $i(t,e){ni(t);const{A:r,B:n,Z:i}=e;if(!t.isValid(r)||!t.isValid(n)||!t.isValid(i))throw new Error("mapToCurveSimpleSWU: invalid opts");const s=function(t,e){const r=t.ORDER;let n=Pi;for(let t=r-Ci;t%ji===Pi;t/=ji)n+=Ci;const i=n,s=ji<<i-Ci-Ci,o=s*ji,a=(r-Ci)/o,c=(a-Ci)/ji,u=o-Ci,f=s,h=t.pow(e,a),l=t.pow(e,(a+Ci)/ji);let d=(e,r)=>{let n=h,s=t.pow(r,u),o=t.sqr(s);o=t.mul(o,r);let a=t.mul(e,o);a=t.pow(a,c),a=t.mul(a,s),s=t.mul(a,r),o=t.mul(a,e);let d=t.mul(o,s);a=t.pow(d,f);let p=t.eql(a,t.ONE);s=t.mul(o,l),a=t.mul(d,n),o=t.cmov(s,o,p),d=t.cmov(a,d,p);for(let e=i;e>Ci;e--){let r=e-ji;r=ji<<r-Ci;let i=t.pow(d,r);const a=t.eql(i,t.ONE);s=t.mul(o,n),n=t.mul(n,n),i=t.mul(d,n),o=t.cmov(s,o,a),d=t.cmov(i,d,a)}return{isValid:p,value:o}};if(t.ORDER%Vi===Mi){const r=(t.ORDER-Mi)/Vi,n=t.sqrt(t.neg(e));d=(e,i)=>{let s=t.sqr(i);const o=t.mul(e,i);s=t.mul(s,o);let a=t.pow(s,r);a=t.mul(a,o);const c=t.mul(a,n),u=t.mul(t.sqr(a),i),f=t.eql(u,e);return{isValid:f,value:t.cmov(c,a,f)}}}return d}(t,i);if(!t.isOdd)throw new Error("Field does not have .isOdd()");return e=>{let o,a,c,u,f,h,l,d;o=t.sqr(e),o=t.mul(o,i),a=t.sqr(o),a=t.add(a,o),c=t.add(a,t.ONE),c=t.mul(c,n),u=t.cmov(i,t.neg(a),!t.eql(a,t.ZERO)),u=t.mul(u,r),a=t.sqr(c),h=t.sqr(u),f=t.mul(h,r),a=t.add(a,f),a=t.mul(a,c),h=t.mul(h,u),f=t.mul(h,n),a=t.add(a,f),l=t.mul(o,c);const{isValid:p,value:y}=s(a,h);d=t.mul(o,e),d=t.mul(d,y),l=t.cmov(l,c,p),d=t.cmov(d,y,p);const g=t.isOdd(e)===t.isOdd(d);d=t.cmov(t.neg(d),d,g);const b=si(t,[u],!0)[0];return l=t.mul(l,b),{x:l,y:d}}}function Gi(t){const{CURVE:e,curveOpts:r}=function(t){const e={a:t.a,b:t.b,p:t.Fp.ORDER,n:t.n,h:t.h,Gx:t.Gx,Gy:t.Gy},r=t.Fp;let n=t.allowedPrivateKeyLengths?Array.from(new Set(t.allowedPrivateKeyLengths.map(t=>Math.ceil(t/2)))):void 0;const i=ci(e.n,{BITS:t.nBitLength,allowedLengths:n,modFromBytes:t.wrapPrivateKey}),s={Fp:r,Fn:i,allowInfinityPoint:t.allowInfinityPoint,endo:t.endo,isTorsionFree:t.isTorsionFree,clearCofactor:t.clearCofactor,fromBytes:t.fromBytes,toBytes:t.toBytes};return{CURVE:e,curveOpts:s}}(t);return function(t,e){const{Fp:r,Fn:n}=e;function i(t){return On(t,Ci,n.ORDER)}const s=function(t,e,r){function n(n){const i=t.sqr(n),s=t.mul(i,n);return t.add(t.add(s,t.mul(n,e)),r)}return n}(r,t.a,t.b);return Object.assign({},{CURVE:t,Point:e,ProjectivePoint:e,normPrivateKeyToScalar:t=>Di(n,t),weierstrassEquation:s,isWithinCurveOrder:i})}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */(t,qi(e,r))}const zi=BigInt(0),Ki=BigInt(1),Zi=BigInt(2),Hi=BigInt(3);function Yi(t){if(!Array.isArray(t)||0===t.length)throw new Error("expected non-empty array")}function Wi(t,e,r,n){const{Fp2:i,Fp12:s}=t,{twistType:o,ateLoopSize:a,xNegative:c,postPrecompute:u}=n;let f;if("multiplicative"===o)f=(t,e,r,n,o,a)=>s.mul014(n,t,i.mul(e,o),i.mul(r,a));else{if("divisive"!==o)throw new Error("bls: unknown twist type");f=(t,e,r,n,o,a)=>s.mul034(n,i.mul(r,a),i.mul(e,o),t)}const h=i.div(i.ONE,i.mul(i.ONE,Zi));function l(t,e,r,n){const s=i.sqr(r),o=i.sqr(n),a=i.mulByB(i.mul(o,Hi)),c=i.mul(a,Hi),u=i.sub(i.sub(i.sqr(i.add(r,n)),o),s),f=i.sub(a,s),l=i.mul(i.sqr(e),Hi),d=i.neg(u);return t.push([f,l,d]),{Rx:e=i.mul(i.mul(i.mul(i.sub(s,c),e),r),h),Ry:r=i.sub(i.sqr(i.mul(i.add(s,c),h)),i.mul(i.sqr(a),Hi)),Rz:n=i.mul(s,u)}}function d(t,e,r,n,s,o){const a=i.sub(r,i.mul(o,n)),c=i.sub(e,i.mul(s,n)),u=i.sub(i.mul(a,s),i.mul(c,o)),f=i.neg(a),h=c;t.push([u,f,h]);const l=i.sqr(c),d=i.mul(l,c),p=i.mul(l,e),y=i.add(i.sub(d,i.mul(p,Zi)),i.mul(i.sqr(a),n));return{Rx:e=i.mul(c,y),Ry:r=i.sub(i.mul(i.sub(p,y),a),i.mul(d,r)),Rz:n=i.mul(n,d)}}const p=function(t){const e=[];for(;t>Ki;t>>=Ki)(t&Ki)===zi?e.unshift(0):(t&Hi)===Hi?(e.unshift(-1),t+=Ki):e.unshift(1);return e}(a),y=Cn(t=>{const e=t,{x:r,y:n}=e.toAffine(),s=r,o=n,a=i.neg(n);let c=s,f=o,h=i.ONE;const y=[];for(const t of p){const e=[];({Rx:c,Ry:f,Rz:h}=l(e,c,f,h)),t&&({Rx:c,Ry:f,Rz:h}=d(e,c,f,h,s,-1===t?a:o)),y.push(e)}if(u){const t=y[y.length-1];u(c,f,h,s,o,d.bind(null,t))}return y});function g(t,e=!1){let r=s.ONE;if(t.length){const e=t[0][0].length;for(let n=0;n<e;n++){r=s.sqr(r);for(const[e,i,s]of t)for(const[t,o,a]of e[n])r=f(t,o,a,r,i,s)}}return c&&(r=s.conjugate(r)),e?s.finalExponentiate(r):r}function b(t,n=!0){const i=[];pi(e,t.map(({g1:t})=>t)),pi(r,t.map(({g2:t})=>t));for(const{g1:e,g2:r}of t){if(e.is0()||r.is0())throw new Error("pairing is not available for ZERO point");e.assertValidity(),r.assertValidity();const t=e.toAffine();i.push([y(r),t.x,t.y])}return g(i,n)}return{Fp12:s,millerLoopBatch:g,pairing:function(t,e,r=!0){return b([{g1:t,g2:e}],r)},pairingBatch:b,calcPairingPrecomputes:y}}function Xi(t,e,r,n,i){const{Fp12:s,pairingBatch:o}=t;function a(t){return t instanceof e.Point?t:e.Point.fromHex(t)}function c(t){return t instanceof r.Point?t:r.Point.fromHex(t)}function u(t){if(!(t instanceof r.Point))throw new Error(`expected valid message hashed to ${i?"G1":"G2"} curve`);return t}const f=i?(t,e)=>({g1:e,g2:t}):(t,e)=>({g1:t,g2:e});return{getPublicKey(t){const r=Di(e.Point.Fn,t);return e.Point.BASE.multiply(r)},sign(t,r,n){if(null!=n)throw new Error("sign() expects 2 arguments");const i=Di(e.Point.Fn,r);return u(t).assertValidity(),t.multiply(i)},verify(t,r,n,i){if(null!=i)throw new Error("verify() expects 3 arguments");t=c(t);const h=(n=a(n)).negate(),l=e.Point.BASE,d=u(r),p=t,y=o([f(h,d),f(l,p)]);return s.eql(y,s.ONE)},verifyBatch(t,r,n){if(Yi(r),n.length!==r.length)throw new Error("amount of public keys and messages should be equal");const i=c(t),u=r,h=n.map(a),l=new Map;for(let t=0;t<h.length;t++){const e=h[t],r=u[t];let n=l.get(r);void 0===n&&(n=[],l.set(r,n)),n.push(e)}const d=[],p=e.Point.BASE;try{for(const[t,e]of l){const r=e.reduce((t,e)=>t.add(e));d.push(f(r,t))}return d.push(f(p.negate(),i)),s.eql(o(d),s.ONE)}catch{return!1}},aggregatePublicKeys(t){Yi(t);const r=(t=t.map(t=>a(t))).reduce((t,e)=>t.add(e),e.Point.ZERO);return r.assertValidity(),r},aggregateSignatures(t){Yi(t);const e=(t=t.map(t=>c(t))).reduce((t,e)=>t.add(e),r.Point.ZERO);return e.assertValidity(),e},hash(t,e){b(t);const n=e?{DST:e}:void 0;return r.hashToCurve(t,n)},Signature:n}}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const Ji=BigInt(0),Qi=BigInt(1),ts=BigInt(2),es=BigInt(3);function rs(t,e,r,n,i=1,s){const o=BigInt(void 0===s?n:s),a=r**BigInt(n),c=[];for(let s=0;s<i;s++){const i=BigInt(s+1),u=[];for(let s=0,c=Qi;s<n;s++){const n=(i*c-i)/o%a;u.push(t.pow(e,n)),c*=r}c.push(u)}return c}const ns=(t,e)=>{if(2!==e.length)throw new Error("invalid tuple");const r=e.map(e=>t.create(e));return{c0:r[0],c1:r[1]}};class is{constructor(t,e={}){this.MASK=Qi;const r=t.ORDER,n=r*r;this.Fp=t,this.ORDER=n,this.BITS=Un(n),this.BYTES=Math.ceil(Un(n)/8),this.isLE=t.isLE,this.ZERO={c0:t.ZERO,c1:t.ZERO},this.ONE={c0:t.ONE,c1:t.ZERO},this.Fp_NONRESIDUE=t.create(e.NONRESIDUE||BigInt(-1)),this.Fp_div2=t.div(t.ONE,ts),this.NONRESIDUE=ns(t,e.FP2_NONRESIDUE),this.FROBENIUS_COEFFICIENTS=rs(t,this.Fp_NONRESIDUE,t.ORDER,2)[0],this.mulByB=e.Fp2mulByB,Object.seal(this)}fromBigTuple(t){return ns(this.Fp,t)}create(t){return t}isValid({c0:t,c1:e}){function r(t,e){return"bigint"==typeof t&&Ji<=t&&t<e}return r(t,this.ORDER)&&r(e,this.ORDER)}is0({c0:t,c1:e}){return this.Fp.is0(t)&&this.Fp.is0(e)}isValidNot0(t){return!this.is0(t)&&this.isValid(t)}eql({c0:t,c1:e},{c0:r,c1:n}){return this.Fp.eql(t,r)&&this.Fp.eql(e,n)}neg({c0:t,c1:e}){return{c0:this.Fp.neg(t),c1:this.Fp.neg(e)}}pow(t,e){return ii(this,t,e)}invertBatch(t){return si(this,t)}add(t,e){const{c0:r,c1:n}=t,{c0:i,c1:s}=e;return{c0:this.Fp.add(r,i),c1:this.Fp.add(n,s)}}sub({c0:t,c1:e},{c0:r,c1:n}){return{c0:this.Fp.sub(t,r),c1:this.Fp.sub(e,n)}}mul({c0:t,c1:e},r){const{Fp:n}=this;if("bigint"==typeof r)return{c0:n.mul(t,r),c1:n.mul(e,r)};const{c0:i,c1:s}=r;let o=n.mul(t,i),a=n.mul(e,s);return{c0:n.sub(o,a),c1:n.sub(n.mul(n.add(t,e),n.add(i,s)),n.add(o,a))}}sqr({c0:t,c1:e}){const{Fp:r}=this,n=r.add(t,e),i=r.sub(t,e),s=r.add(t,t);return{c0:r.mul(n,i),c1:r.mul(s,e)}}addN(t,e){return this.add(t,e)}subN(t,e){return this.sub(t,e)}mulN(t,e){return this.mul(t,e)}sqrN(t){return this.sqr(t)}div(t,e){const{Fp:r}=this;return this.mul(t,"bigint"==typeof e?r.inv(r.create(e)):this.inv(e))}inv({c0:t,c1:e}){const{Fp:r}=this,n=r.inv(r.create(t*t+e*e));return{c0:r.mul(n,r.create(t)),c1:r.mul(n,r.create(-e))}}sqrt(t){const{Fp:e}=this,r=this,{c0:n,c1:i}=t;if(e.is0(i))return 1===oi(e,n)?r.create({c0:e.sqrt(n),c1:e.ZERO}):r.create({c0:e.ZERO,c1:e.sqrt(e.div(n,this.Fp_NONRESIDUE))});const s=e.sqrt(e.sub(e.sqr(n),e.mul(e.sqr(i),this.Fp_NONRESIDUE)));let o=e.mul(e.add(s,n),this.Fp_div2);-1===oi(e,o)&&(o=e.sub(o,s));const a=e.sqrt(o),c=r.create({c0:a,c1:e.div(e.mul(i,this.Fp_div2),a)});if(!r.eql(r.sqr(c),t))throw new Error("Cannot find square root");const u=c,f=r.neg(u),{re:h,im:l}=r.reim(u),{re:d,im:p}=r.reim(f);return l>p||l===p&&h>d?u:f}isOdd(t){const{re:e,im:r}=this.reim(t);return BigInt(e%ts||e===Ji&&r%ts)==Qi}fromBytes(t){const{Fp:e}=this;if(t.length!==this.BYTES)throw new Error("fromBytes invalid length="+t.length);return{c0:e.fromBytes(t.subarray(0,e.BYTES)),c1:e.fromBytes(t.subarray(e.BYTES))}}toBytes({c0:t,c1:e}){return L(this.Fp.toBytes(t),this.Fp.toBytes(e))}cmov({c0:t,c1:e},{c0:r,c1:n},i){return{c0:this.Fp.cmov(t,r,i),c1:this.Fp.cmov(e,n,i)}}reim({c0:t,c1:e}){return{re:t,im:e}}Fp4Square(t,e){const r=this,n=r.sqr(t),i=r.sqr(e);return{first:r.add(r.mulByNonresidue(i),n),second:r.sub(r.sub(r.sqr(r.add(t,e)),n),i)}}mulByNonresidue({c0:t,c1:e}){return this.mul({c0:t,c1:e},this.NONRESIDUE)}frobeniusMap({c0:t,c1:e},r){return{c0:t,c1:this.Fp.mul(e,this.FROBENIUS_COEFFICIENTS[r%2])}}}class ss{constructor(t){this.MASK=Qi,this.Fp2=t,this.ORDER=t.ORDER,this.BITS=3*t.BITS,this.BYTES=3*t.BYTES,this.isLE=t.isLE,this.ZERO={c0:t.ZERO,c1:t.ZERO,c2:t.ZERO},this.ONE={c0:t.ONE,c1:t.ZERO,c2:t.ZERO};const{Fp:e}=t,r=rs(t,t.NONRESIDUE,e.ORDER,6,2,3);this.FROBENIUS_COEFFICIENTS_1=r[0],this.FROBENIUS_COEFFICIENTS_2=r[1],Object.seal(this)}add({c0:t,c1:e,c2:r},{c0:n,c1:i,c2:s}){const{Fp2:o}=this;return{c0:o.add(t,n),c1:o.add(e,i),c2:o.add(r,s)}}sub({c0:t,c1:e,c2:r},{c0:n,c1:i,c2:s}){const{Fp2:o}=this;return{c0:o.sub(t,n),c1:o.sub(e,i),c2:o.sub(r,s)}}mul({c0:t,c1:e,c2:r},n){const{Fp2:i}=this;if("bigint"==typeof n)return{c0:i.mul(t,n),c1:i.mul(e,n),c2:i.mul(r,n)};const{c0:s,c1:o,c2:a}=n,c=i.mul(t,s),u=i.mul(e,o),f=i.mul(r,a);return{c0:i.add(c,i.mulByNonresidue(i.sub(i.mul(i.add(e,r),i.add(o,a)),i.add(u,f)))),c1:i.add(i.sub(i.mul(i.add(t,e),i.add(s,o)),i.add(c,u)),i.mulByNonresidue(f)),c2:i.sub(i.add(u,i.mul(i.add(t,r),i.add(s,a))),i.add(c,f))}}sqr({c0:t,c1:e,c2:r}){const{Fp2:n}=this;let i=n.sqr(t),s=n.mul(n.mul(t,e),ts),o=n.mul(n.mul(e,r),ts),a=n.sqr(r);return{c0:n.add(n.mulByNonresidue(o),i),c1:n.add(n.mulByNonresidue(a),s),c2:n.sub(n.sub(n.add(n.add(s,n.sqr(n.add(n.sub(t,e),r))),o),i),a)}}addN(t,e){return this.add(t,e)}subN(t,e){return this.sub(t,e)}mulN(t,e){return this.mul(t,e)}sqrN(t){return this.sqr(t)}create(t){return t}isValid({c0:t,c1:e,c2:r}){const{Fp2:n}=this;return n.isValid(t)&&n.isValid(e)&&n.isValid(r)}is0({c0:t,c1:e,c2:r}){const{Fp2:n}=this;return n.is0(t)&&n.is0(e)&&n.is0(r)}isValidNot0(t){return!this.is0(t)&&this.isValid(t)}neg({c0:t,c1:e,c2:r}){const{Fp2:n}=this;return{c0:n.neg(t),c1:n.neg(e),c2:n.neg(r)}}eql({c0:t,c1:e,c2:r},{c0:n,c1:i,c2:s}){const{Fp2:o}=this;return o.eql(t,n)&&o.eql(e,i)&&o.eql(r,s)}sqrt(t){return Pn()}div(t,e){const{Fp2:r}=this,{Fp:n}=r;return this.mul(t,"bigint"==typeof e?n.inv(n.create(e)):this.inv(e))}pow(t,e){return ii(this,t,e)}invertBatch(t){return si(this,t)}inv({c0:t,c1:e,c2:r}){const{Fp2:n}=this;let i=n.sub(n.sqr(t),n.mulByNonresidue(n.mul(r,e))),s=n.sub(n.mulByNonresidue(n.sqr(r)),n.mul(t,e)),o=n.sub(n.sqr(e),n.mul(t,r)),a=n.inv(n.add(n.mulByNonresidue(n.add(n.mul(r,s),n.mul(e,o))),n.mul(t,i)));return{c0:n.mul(a,i),c1:n.mul(a,s),c2:n.mul(a,o)}}fromBytes(t){const{Fp2:e}=this;if(t.length!==this.BYTES)throw new Error("fromBytes invalid length="+t.length);const r=e.BYTES;return{c0:e.fromBytes(t.subarray(0,r)),c1:e.fromBytes(t.subarray(r,2*r)),c2:e.fromBytes(t.subarray(2*r))}}toBytes({c0:t,c1:e,c2:r}){const{Fp2:n}=this;return L(n.toBytes(t),n.toBytes(e),n.toBytes(r))}cmov({c0:t,c1:e,c2:r},{c0:n,c1:i,c2:s},o){const{Fp2:a}=this;return{c0:a.cmov(t,n,o),c1:a.cmov(e,i,o),c2:a.cmov(r,s,o)}}fromBigSix(t){const{Fp2:e}=this;if(!Array.isArray(t)||6!==t.length)throw new Error("invalid Fp6 usage");return{c0:e.fromBigTuple(t.slice(0,2)),c1:e.fromBigTuple(t.slice(2,4)),c2:e.fromBigTuple(t.slice(4,6))}}frobeniusMap({c0:t,c1:e,c2:r},n){const{Fp2:i}=this;return{c0:i.frobeniusMap(t,n),c1:i.mul(i.frobeniusMap(e,n),this.FROBENIUS_COEFFICIENTS_1[n%6]),c2:i.mul(i.frobeniusMap(r,n),this.FROBENIUS_COEFFICIENTS_2[n%6])}}mulByFp2({c0:t,c1:e,c2:r},n){const{Fp2:i}=this;return{c0:i.mul(t,n),c1:i.mul(e,n),c2:i.mul(r,n)}}mulByNonresidue({c0:t,c1:e,c2:r}){const{Fp2:n}=this;return{c0:n.mulByNonresidue(r),c1:t,c2:e}}mul1({c0:t,c1:e,c2:r},n){const{Fp2:i}=this;return{c0:i.mulByNonresidue(i.mul(r,n)),c1:i.mul(t,n),c2:i.mul(e,n)}}mul01({c0:t,c1:e,c2:r},n,i){const{Fp2:s}=this;let o=s.mul(t,n),a=s.mul(e,i);return{c0:s.add(s.mulByNonresidue(s.sub(s.mul(s.add(e,r),i),a)),o),c1:s.sub(s.sub(s.mul(s.add(n,i),s.add(t,e)),o),a),c2:s.add(s.sub(s.mul(s.add(t,r),n),o),a)}}}class os{constructor(t,e){this.MASK=Qi;const{Fp2:r}=t,{Fp:n}=r;this.Fp6=t,this.ORDER=r.ORDER,this.BITS=2*t.BITS,this.BYTES=2*t.BYTES,this.isLE=t.isLE,this.ZERO={c0:t.ZERO,c1:t.ZERO},this.ONE={c0:t.ONE,c1:t.ZERO},this.FROBENIUS_COEFFICIENTS=rs(r,r.NONRESIDUE,n.ORDER,12,1,6)[0],this.X_LEN=e.X_LEN,this.finalExponentiate=e.Fp12finalExponentiate}create(t){return t}isValid({c0:t,c1:e}){const{Fp6:r}=this;return r.isValid(t)&&r.isValid(e)}is0({c0:t,c1:e}){const{Fp6:r}=this;return r.is0(t)&&r.is0(e)}isValidNot0(t){return!this.is0(t)&&this.isValid(t)}neg({c0:t,c1:e}){const{Fp6:r}=this;return{c0:r.neg(t),c1:r.neg(e)}}eql({c0:t,c1:e},{c0:r,c1:n}){const{Fp6:i}=this;return i.eql(t,r)&&i.eql(e,n)}sqrt(t){Pn()}inv({c0:t,c1:e}){const{Fp6:r}=this;let n=r.inv(r.sub(r.sqr(t),r.mulByNonresidue(r.sqr(e))));return{c0:r.mul(t,n),c1:r.neg(r.mul(e,n))}}div(t,e){const{Fp6:r}=this,{Fp2:n}=r,{Fp:i}=n;return this.mul(t,"bigint"==typeof e?i.inv(i.create(e)):this.inv(e))}pow(t,e){return ii(this,t,e)}invertBatch(t){return si(this,t)}add({c0:t,c1:e},{c0:r,c1:n}){const{Fp6:i}=this;return{c0:i.add(t,r),c1:i.add(e,n)}}sub({c0:t,c1:e},{c0:r,c1:n}){const{Fp6:i}=this;return{c0:i.sub(t,r),c1:i.sub(e,n)}}mul({c0:t,c1:e},r){const{Fp6:n}=this;if("bigint"==typeof r)return{c0:n.mul(t,r),c1:n.mul(e,r)};let{c0:i,c1:s}=r,o=n.mul(t,i),a=n.mul(e,s);return{c0:n.add(o,n.mulByNonresidue(a)),c1:n.sub(n.mul(n.add(t,e),n.add(i,s)),n.add(o,a))}}sqr({c0:t,c1:e}){const{Fp6:r}=this;let n=r.mul(t,e);return{c0:r.sub(r.sub(r.mul(r.add(r.mulByNonresidue(e),t),r.add(t,e)),n),r.mulByNonresidue(n)),c1:r.add(n,n)}}addN(t,e){return this.add(t,e)}subN(t,e){return this.sub(t,e)}mulN(t,e){return this.mul(t,e)}sqrN(t){return this.sqr(t)}fromBytes(t){const{Fp6:e}=this;if(t.length!==this.BYTES)throw new Error("fromBytes invalid length="+t.length);return{c0:e.fromBytes(t.subarray(0,e.BYTES)),c1:e.fromBytes(t.subarray(e.BYTES))}}toBytes({c0:t,c1:e}){const{Fp6:r}=this;return L(r.toBytes(t),r.toBytes(e))}cmov({c0:t,c1:e},{c0:r,c1:n},i){const{Fp6:s}=this;return{c0:s.cmov(t,r,i),c1:s.cmov(e,n,i)}}fromBigTwelve(t){const{Fp6:e}=this;return{c0:e.fromBigSix(t.slice(0,6)),c1:e.fromBigSix(t.slice(6,12))}}frobeniusMap(t,e){const{Fp6:r}=this,{Fp2:n}=r,{c0:i,c1:s,c2:o}=r.frobeniusMap(t.c1,e),a=this.FROBENIUS_COEFFICIENTS[e%12];return{c0:r.frobeniusMap(t.c0,e),c1:r.create({c0:n.mul(i,a),c1:n.mul(s,a),c2:n.mul(o,a)})}}mulByFp2({c0:t,c1:e},r){const{Fp6:n}=this;return{c0:n.mulByFp2(t,r),c1:n.mulByFp2(e,r)}}conjugate({c0:t,c1:e}){return{c0:t,c1:this.Fp6.neg(e)}}mul014({c0:t,c1:e},r,n,i){const{Fp6:s}=this,{Fp2:o}=s;let a=s.mul01(t,r,n),c=s.mul1(e,i);return{c0:s.add(s.mulByNonresidue(c),a),c1:s.sub(s.sub(s.mul01(s.add(e,t),r,o.add(n,i)),a),c)}}mul034({c0:t,c1:e},r,n,i){const{Fp6:s}=this,{Fp2:o}=s,a=s.create({c0:o.mul(t.c0,r),c1:o.mul(t.c1,r),c2:o.mul(t.c2,r)}),c=s.mul01(e,n,i),u=s.mul01(s.add(t,e),o.add(r,n),i);return{c0:s.add(s.mulByNonresidue(c),a),c1:s.sub(u,s.add(a,c))}}_cyclotomicSquare({c0:t,c1:e}){const{Fp6:r}=this,{Fp2:n}=r,{c0:i,c1:s,c2:o}=t,{c0:a,c1:c,c2:u}=e,{first:f,second:h}=n.Fp4Square(i,c),{first:l,second:d}=n.Fp4Square(a,o),{first:p,second:y}=n.Fp4Square(s,u),g=n.mulByNonresidue(y);return{c0:r.create({c0:n.add(n.mul(n.sub(f,i),ts),f),c1:n.add(n.mul(n.sub(l,s),ts),l),c2:n.add(n.mul(n.sub(p,o),ts),p)}),c1:r.create({c0:n.add(n.mul(n.add(g,a),ts),g),c1:n.add(n.mul(n.add(h,c),ts),h),c2:n.add(n.mul(n.add(d,u),ts),d)})}}_cyclotomicExp(t,e){let r=this.ONE;for(let n=this.X_LEN-1;n>=0;n--)r=this._cyclotomicSquare(r),Fn(e,n)&&(r=this.mul(r,t));return r}}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const as=BigInt(0),cs=BigInt(1),us=BigInt(2),fs=BigInt(3),hs=BigInt(4),ls=BigInt("0xd201000000010000"),ds=Un(ls),ps={p:BigInt("0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab"),n:BigInt("0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001"),h:BigInt("0x396c8c005555e1568c00aaab0000aaab"),a:as,b:hs,Gx:BigInt("0x17f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586c55e83ff97a1aeffb3af00adb22c6bb"),Gy:BigInt("0x08b3f481e3aaa0f1a09e30ed741d8ae4fcf5e095d5d00af600db18cb2c04b3edd03cc744a2888ae40caa232946c5e7e1")},ys=ci(ps.n,{modFromBytes:!0,isLE:!0}),{Fp:gs,Fp2:bs,Fp6:ws,Fp12:ms}=function(t){const e=ci(t.ORDER),r=new is(e,t),n=new ss(r);return{Fp:e,Fp2:r,Fp6:n,Fp12:new os(n,t)}}({ORDER:ps.p,X_LEN:ds,FP2_NONRESIDUE:[cs,cs],Fp2mulByB:({c0:t,c1:e})=>{const r=gs.mul(t,hs),n=gs.mul(e,hs);return{c0:gs.sub(r,n),c1:gs.add(r,n)}},Fp12finalExponentiate:t=>{const e=ls,r=ms.div(ms.frobeniusMap(t,6),t),n=ms.mul(ms.frobeniusMap(r,2),r),i=ms.conjugate(ms._cyclotomicExp(n,e)),s=ms.mul(ms.conjugate(ms._cyclotomicSquare(n)),i),o=ms.conjugate(ms._cyclotomicExp(s,e)),a=ms.conjugate(ms._cyclotomicExp(o,e)),c=ms.mul(ms.conjugate(ms._cyclotomicExp(a,e)),ms._cyclotomicSquare(i)),u=ms.conjugate(ms._cyclotomicExp(c,e)),f=ms.frobeniusMap(ms.mul(i,a),2),h=ms.frobeniusMap(ms.mul(o,n),3),l=ms.frobeniusMap(ms.mul(c,ms.conjugate(n)),1),d=ms.mul(ms.mul(u,ms.conjugate(s)),n);return ms.mul(ms.mul(ms.mul(f,h),l),d)}}),{G2psi:vs,G2psi2:Es}=function(t,e,r){const n=e.pow(r,(t.ORDER-Qi)/es),i=e.pow(r,(t.ORDER-Qi)/ts);function s(t,r){return[e.mul(e.frobeniusMap(t,1),n),e.mul(e.frobeniusMap(r,1),i)]}const o=e.pow(r,(t.ORDER**ts-Qi)/es),a=e.pow(r,(t.ORDER**ts-Qi)/ts);if(!e.eql(a,e.neg(e.ONE)))throw new Error("psiFrobenius: PSI2_Y!==-1");function c(t,r){return[e.mul(t,o),e.neg(r)]}const u=t=>(e,r)=>{const n=r.toAffine(),i=t(n.x,n.y);return e.fromAffine({x:i[0],y:i[1]})};return{psi:s,psi2:c,G2psi:u(s),G2psi2:u(c),PSI_X:n,PSI_Y:i,PSI2_X:o,PSI2_Y:a}}(gs,bs,bs.div(bs.ONE,bs.NONRESIDUE)),_s=Object.freeze({DST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",encodeDST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",p:gs.ORDER,m:2,k:128,expand:"xmd",hash:bt}),Bs={p:bs.ORDER,n:ps.n,h:BigInt("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5"),a:bs.ZERO,b:bs.fromBigTuple([hs,hs]),Gx:bs.fromBigTuple([BigInt("0x024aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8"),BigInt("0x13e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e")]),Gy:bs.fromBigTuple([BigInt("0x0ce5d527727d6e118cc9cdc6da2e351aadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801"),BigInt("0x0606c4a02ea734cc32acd2b02bc28b99cb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79be")])},Is=Ts(gs.toBytes(as),{infinity:!0,compressed:!0});function xs(t){const e=224&(t=t.slice())[0],r=!!(e>>7&1),n=!!(e>>6&1),i=!!(e>>5&1);return t[0]&=31,{compressed:r,infinity:n,sort:i,value:t}}function Ts(t,e){if(224&t[0])throw new Error("setMask: non-empty mask");return e.compressed&&(t[0]|=128),e.infinity&&(t[0]|=64),e.sort&&(t[0]|=32),t}function As(t){t.assertValidity();const{BYTES:e,ORDER:r}=gs,{x:n,y:i}=t.toAffine();if(t.is0())return Is.slice();const s=Boolean(i*us/r);return Ts(xn(n,e),{compressed:!0,sort:s})}function Ss(t){const{infinity:e,sort:r,value:n}=xs(An("signatureHex",t,48)),i=gs.ORDER,s=Rs.G1.Point,o=Bn(n);if(e)return s.ZERO;const a=gs.create(o&kn(gs.BITS)),c=gs.add(gs.pow(a,fs),gs.create(ps.b));let u=gs.sqrt(c);if(!u)throw new Error("invalid G1 point: compressed");const f=BigInt(r);u*us/i!==f&&(u=gs.neg(u));const h=s.fromAffine({x:a,y:u});return h.assertValidity(),h}function Ns(t){t.assertValidity();const{BYTES:e}=gs;if(t.is0())return L(Is,xn(as,e));const{x:r,y:n}=t.toAffine(),{re:i,im:s}=bs.reim(r),{re:o,im:a}=bs.reim(n),c=Boolean((a>as?a*us:o*us)/gs.ORDER&cs),u=i;return L(Ts(xn(s,e),{sort:c,compressed:!0}),xn(u,e))}function Os(t){const{ORDER:e}=gs,{infinity:r,sort:n,value:i}=xs(An("signatureHex",t)),s=Rs.G2.Point,o=i.length/2;if(48!==o&&96!==o)throw new Error("invalid compressed signature length, expected 96/192 bytes");const a=Bn(i.slice(0,o)),c=Bn(i.slice(o));if(r)return s.ZERO;const u=gs.create(a&kn(gs.BITS)),f=gs.create(c),h=bs.create({c0:f,c1:u}),l=bs.add(bs.pow(h,fs),Bs.b);let d=bs.sqrt(l);if(!d)throw new Error("Failed to find a square root");const{re:p,im:y}=bs.reim(d),g=BigInt(n);(y>as&&y*us/e!==g||y===as&&p*us/e!==g)&&(d=bs.neg(d));const b=s.fromAffine({x:h,y:d});return b.assertValidity(),b}const Rs=function(t){const{Fp:e,Fr:r,Fp2:n,Fp6:i,Fp12:s}=t.fields,o=Gi(t.G1),a=Object.assign(o,ki(o.Point,t.G1.mapToCurve,{...t.htfDefaults,...t.G1.htfDefaults})),c=Gi(t.G2),u=Object.assign(c,ki(c.Point,t.G2.mapToCurve,{...t.htfDefaults,...t.G2.htfDefaults})),f=Wi(t.fields,a.Point,u.Point,{...t.params,postPrecompute:t.postPrecompute}),{millerLoopBatch:h,pairing:l,pairingBatch:d,calcPairingPrecomputes:p}=f,y=Xi(f,a,u,t.G2.Signature,!1),g=Xi(f,u,a,t.G1.ShortSignature,!0),b=t.randomBytes||j,w=()=>{const t=fi(r.ORDER);return function(t,e,r=!1){const n=t.length,i=ui(e),s=fi(e);if(n<16||n<s||n>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+n);const o=Hn(r?In(t):Bn(t),e-Mn)+Mn;return r?Tn(o,i):xn(o,i)}(b(t),r.ORDER)},m={randomSecretKey:w,randomPrivateKey:w,calcPairingPrecomputes:p},{ShortSignature:v}=t.G1,{Signature:E}=t.G2;function _(t,e){return t instanceof a.Point?t:g.hash(An("point",t),e?.DST)}function B(t,e){return t instanceof u.Point?t:y.hash(An("point",t),e?.DST)}return a.Point.BASE.precompute(4),{longSignatures:y,shortSignatures:g,millerLoopBatch:h,pairing:l,pairingBatch:d,verifyBatch:function(t,e,r,n){const i=e.map(t=>B(t,n));return y.verifyBatch(t,i,r)},fields:{Fr:r,Fp:e,Fp2:n,Fp6:i,Fp12:s},params:{ateLoopSize:t.params.ateLoopSize,twistType:t.params.twistType,r:t.params.r,G1b:t.G1.b,G2b:t.G2.b},utils:m,getPublicKey:function(t){return y.getPublicKey(t).toBytes(!0)},getPublicKeyForShortSignatures:function(t){return g.getPublicKey(t).toBytes(!0)},sign:function(t,e,r){const n=B(t,r),i=y.sign(n,e);return t instanceof u.Point?i:E.toBytes(i)},signShortSignature:function(t,e,r){const n=_(t,r),i=g.sign(n,e);return t instanceof a.Point?i:v.toBytes(i)},verify:function(t,e,r,n){const i=B(e,n);return y.verify(t,i,r)},verifyShortSignature:function(t,e,r,n){const i=_(e,n);return g.verify(t,i,r)},aggregatePublicKeys:function(t){const e=y.aggregatePublicKeys(t);return t[0]instanceof a.Point?e:e.toBytes(!0)},aggregateSignatures:function(t){const e=y.aggregateSignatures(t);return t[0]instanceof u.Point?e:E.toBytes(e)},aggregateShortSignatures:function(t){const e=g.aggregateSignatures(t);return t[0]instanceof a.Point?e:v.toBytes(e)},G1:a,G2:u,Signature:E,ShortSignature:v}}({fields:{Fp:gs,Fp2:bs,Fp6:ws,Fp12:ms,Fr:ys},G1:{...ps,Fp:gs,htfDefaults:{..._s,m:1,DST:"BLS_SIG_BLS12381G1_XMD:SHA-256_SSWU_RO_NUL_"},wrapPrivateKey:!0,allowInfinityPoint:!0,isTorsionFree:(t,e)=>{const r=BigInt("0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffe"),n=new t(gs.mul(e.X,r),e.Y,e.Z);return e.multiplyUnsafe(ls).negate().multiplyUnsafe(ls).equals(n)},clearCofactor:(t,e)=>e.multiplyUnsafe(ls).add(e),mapToCurve:function(t){const{x:e,y:r}=ks(gs.create(t[0]));return Fs(e,r)},fromBytes:function(t){const{compressed:e,infinity:r,sort:n,value:i}=xs(t),{BYTES:s,ORDER:o}=gs;if(48===i.length&&e){const t=Bn(i),e=gs.create(t&kn(gs.BITS));if(r){if(e!==as)throw new Error("invalid G1 point: non-empty, at infinity, with compression");return{x:as,y:as}}const s=gs.add(gs.pow(e,fs),gs.create(ps.b));let a=gs.sqrt(s);if(!a)throw new Error("invalid G1 point: compressed point");return a*us/o!==BigInt(n)&&(a=gs.neg(a)),{x:gs.create(e),y:gs.create(a)}}if(96!==i.length||e)throw new Error("invalid G1 point: expected 48/96 bytes");{const t=Bn(i.subarray(0,s)),e=Bn(i.subarray(s));if(r){if(t!==as||e!==as)throw new Error("G1: non-empty point at infinity");return Rs.G1.Point.ZERO.toAffine()}return{x:gs.create(t),y:gs.create(e)}}},toBytes:function(t,e,r){const{BYTES:n,ORDER:i}=gs,s=e.is0(),{x:o,y:a}=e.toAffine();if(r){if(s)return Is.slice();const t=Boolean(a*us/i);return Ts(xn(o,n),{compressed:!0,sort:t})}return s?L(Uint8Array.of(64),new Uint8Array(2*n-1)):L(xn(o,n),xn(a,n))},ShortSignature:{fromBytes:t=>(b(t),Ss(t)),fromHex:t=>Ss(t),toBytes:t=>As(t),toRawBytes:t=>As(t),toHex:t=>I(As(t))}},G2:{...Bs,Fp:bs,hEff:BigInt("0xbc69f08f2ee75b3584c6a0ea91b352888e2a8e9145ad7689986ff031508ffe1329c2f178731db956d82bf015d1212b02ec0ec69d7477c1ae954cbc06689f6a359894c0adebbf6b4e8020005aaa95551"),htfDefaults:{..._s},wrapPrivateKey:!0,allowInfinityPoint:!0,mapToCurve:function(t){const{x:e,y:r}=Ls(bs.fromBigTuple(t));return Us(e,r)},isTorsionFree:(t,e)=>e.multiplyUnsafe(ls).negate().equals(vs(t,e)),clearCofactor:(t,e)=>{const r=ls;let n=e.multiplyUnsafe(r).negate(),i=vs(t,e),s=e.double();s=Es(t,s),s=s.subtract(i),i=n.add(i),i=i.multiplyUnsafe(r).negate(),s=s.add(i),s=s.subtract(n);return s.subtract(e)},fromBytes:function(t){const{BYTES:e,ORDER:r}=gs,{compressed:n,infinity:i,sort:s,value:o}=xs(t);if(!n&&!i&&s||!n&&i&&s||s&&i&&n)throw new Error("invalid encoding flag: "+(224&t[0]));const a=(t,e,r)=>Bn(t.slice(e,r));if(96===o.length&&n){if(i){if(o.reduce((t,e)=>0!==t?e+1:e,0)>0)throw new Error("invalid G2 point: compressed");return{x:bs.ZERO,y:bs.ZERO}}const t=a(o,0,e),n=a(o,e,2*e),c=bs.create({c0:gs.create(n),c1:gs.create(t)}),u=bs.add(bs.pow(c,fs),Bs.b);let f=bs.sqrt(u);const h=f.c1===as?f.c0*us/r:f.c1*us/r?cs:as;return f=s&&h>0?f:bs.neg(f),{x:c,y:f}}if(192!==o.length||n)throw new Error("invalid G2 point: expected 96/192 bytes");{if(i){if(o.reduce((t,e)=>0!==t?e+1:e,0)>0)throw new Error("invalid G2 point: uncompressed");return{x:bs.ZERO,y:bs.ZERO}}const t=a(o,0*e,1*e),r=a(o,1*e,2*e),n=a(o,2*e,3*e),s=a(o,3*e,4*e);return{x:bs.fromBigTuple([r,t]),y:bs.fromBigTuple([s,n])}}},toBytes:function(t,e,r){const{BYTES:n,ORDER:i}=gs,s=e.is0(),{x:o,y:a}=e.toAffine();if(r){if(s)return L(Is,xn(as,n));const t=Boolean(a.c1===as?a.c0*us/i:a.c1*us/i);return L(Ts(xn(o.c1,n),{compressed:!0,sort:t}),xn(o.c0,n))}{if(s)return L(Uint8Array.of(64),new Uint8Array(4*n-1));const{re:t,im:e}=bs.reim(o),{re:r,im:i}=bs.reim(a);return L(xn(e,n),xn(t,n),xn(i,n),xn(r,n))}},Signature:{fromBytes:t=>(b(t),Os(t)),fromHex:t=>Os(t),toBytes:t=>Ns(t),toRawBytes:t=>Ns(t),toHex:t=>I(Ns(t))}},params:{ateLoopSize:ls,r:ps.n,xNegative:!0,twistType:"multiplicative"},htfDefaults:_s,hash:bt}),Us=Ui(bs,[[["0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6"],["0x0","0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71a"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71e","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38d"],["0x171d6541fa38ccfaed6dea691f5fb614cb14b4e7f4e810aa22d6108f142b85757098e38d0f671c7188e2aaaaaaaa5ed1","0x0"]],[["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa63"],["0xc","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa9f"],["0x1","0x0"]],[["0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706","0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706"],["0x0","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97be"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71c","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38f"],["0x124c9ad43b6cf79bfbf7043de3811ad0761b0f37a1e26286b0e977c69aa274524e79097a56dc4bd9e1b371c71c718b10","0x0"]],[["0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb"],["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa9d3"],["0x12","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa99"],["0x1","0x0"]]].map(t=>t.map(t=>bs.fromBigTuple(t.map(BigInt))))),Fs=Ui(gs,[["0x11a05f2b1e833340b809101dd99815856b303e88a2d7005ff2627b56cdb4e2c85610c2d5f2e62d6eaeac1662734649b7","0x17294ed3e943ab2f0588bab22147a81c7c17e75b2f6a8417f565e33c70d1e86b4838f2a6f318c356e834eef1b3cb83bb","0xd54005db97678ec1d1048c5d10a9a1bce032473295983e56878e501ec68e25c958c3e3d2a09729fe0179f9dac9edcb0","0x1778e7166fcc6db74e0609d307e55412d7f5e4656a8dbf25f1b33289f1b330835336e25ce3107193c5b388641d9b6861","0xe99726a3199f4436642b4b3e4118e5499db995a1257fb3f086eeb65982fac18985a286f301e77c451154ce9ac8895d9","0x1630c3250d7313ff01d1201bf7a74ab5db3cb17dd952799b9ed3ab9097e68f90a0870d2dcae73d19cd13c1c66f652983","0xd6ed6553fe44d296a3726c38ae652bfb11586264f0f8ce19008e218f9c86b2a8da25128c1052ecaddd7f225a139ed84","0x17b81e7701abdbe2e8743884d1117e53356de5ab275b4db1a682c62ef0f2753339b7c8f8c8f475af9ccb5618e3f0c88e","0x80d3cf1f9a78fc47b90b33563be990dc43b756ce79f5574a2c596c928c5d1de4fa295f296b74e956d71986a8497e317","0x169b1f8e1bcfa7c42e0c37515d138f22dd2ecb803a0c5c99676314baf4bb1b7fa3190b2edc0327797f241067be390c9e","0x10321da079ce07e272d8ec09d2565b0dfa7dccdde6787f96d50af36003b14866f69b771f8c285decca67df3f1605fb7b","0x6e08c248e260e70bd1e962381edee3d31d79d7e22c837bc23c0bf1bc24c6b68c24b1b80b64d391fa9c8ba2e8ba2d229"],["0x8ca8d548cff19ae18b2e62f4bd3fa6f01d5ef4ba35b48ba9c9588617fc8ac62b558d681be343df8993cf9fa40d21b1c","0x12561a5deb559c4348b4711298e536367041e8ca0cf0800c0126c2588c48bf5713daa8846cb026e9e5c8276ec82b3bff","0xb2962fe57a3225e8137e629bff2991f6f89416f5a718cd1fca64e00b11aceacd6a3d0967c94fedcfcc239ba5cb83e19","0x3425581a58ae2fec83aafef7c40eb545b08243f16b1655154cca8abc28d6fd04976d5243eecf5c4130de8938dc62cd8","0x13a8e162022914a80a6f1d5f43e7a07dffdfc759a12062bb8d6b44e833b306da9bd29ba81f35781d539d395b3532a21e","0xe7355f8e4e667b955390f7f0506c6e9395735e9ce9cad4d0a43bcef24b8982f7400d24bc4228f11c02df9a29f6304a5","0x772caacf16936190f3e0c63e0596721570f5799af53a1894e2e073062aede9cea73b3538f0de06cec2574496ee84a3a","0x14a7ac2a9d64a8b230b3f5b074cf01996e7f63c21bca68a81996e1cdf9822c580fa5b9489d11e2d311f7d99bbdcc5a5e","0xa10ecf6ada54f825e920b3dafc7a3cce07f8d1d7161366b74100da67f39883503826692abba43704776ec3a79a1d641","0x95fc13ab9e92ad4476d6e3eb3a56680f682b4ee96f7d03776df533978f31c1593174e4b4b7865002d6384d168ecdd0a","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"],["0x90d97c81ba24ee0259d1f094980dcfa11ad138e48a869522b52af6c956543d3cd0c7aee9b3ba3c2be9845719707bb33","0x134996a104ee5811d51036d776fb46831223e96c254f383d0f906343eb67ad34d6c56711962fa8bfe097e75a2e41c696","0xcc786baa966e66f4a384c86a3b49942552e2d658a31ce2c344be4b91400da7d26d521628b00523b8dfe240c72de1f6","0x1f86376e8981c217898751ad8746757d42aa7b90eeb791c09e4a3ec03251cf9de405aba9ec61deca6355c77b0e5f4cb","0x8cc03fdefe0ff135caf4fe2a21529c4195536fbe3ce50b879833fd221351adc2ee7f8dc099040a841b6daecf2e8fedb","0x16603fca40634b6a2211e11db8f0a6a074a7d0d4afadb7bd76505c3d3ad5544e203f6326c95a807299b23ab13633a5f0","0x4ab0b9bcfac1bbcb2c977d027796b3ce75bb8ca2be184cb5231413c4d634f3747a87ac2460f415ec961f8855fe9d6f2","0x987c8d5333ab86fde9926bd2ca6c674170a05bfe3bdd81ffd038da6c26c842642f64550fedfe935a15e4ca31870fb29","0x9fc4018bd96684be88c9e221e4da1bb8f3abd16679dc26c1e8b6e6a1f20cabe69d65201c78607a360370e577bdba587","0xe1bba7a1186bdb5223abde7ada14a23c42a0ca7915af6fe06985e7ed1e4d43b9b3f7055dd4eba6f2bafaaebca731c30","0x19713e47937cd1be0dfd0b8f1d43fb93cd2fcbcb6caf493fd1183e416389e61031bf3a5cce3fbafce813711ad011c132","0x18b46a908f36f6deb918c143fed2edcc523559b8aaf0c2462e6bfe7f911f643249d9cdf41b44d606ce07c8a4d0074d8e","0xb182cac101b9399d155096004f53f447aa7b12a3426b08ec02710e807b4633f06c851c1919211f20d4c04f00b971ef8","0x245a394ad1eca9b72fc00ae7be315dc757b3b080d4c158013e6632d3c40659cc6cf90ad1c232a6442d9d3f5db980133","0x5c129645e44cf1102a159f748c4a3fc5e673d81d7e86568d9ab0f5d396a7ce46ba1049b6579afb7866b1e715475224b","0x15e6be4e990f03ce4ea50b3b42df2eb5cb181d8f84965a3957add4fa95af01b2b665027efec01c7704b456be69c8b604"],["0x16112c4c3a9c98b252181140fad0eae9601a6de578980be6eec3232b5be72e7a07f3688ef60c206d01479253b03663c1","0x1962d75c2381201e1a0cbd6c43c348b885c84ff731c4d59ca4a10356f453e01f78a4260763529e3532f6102c2e49a03d","0x58df3306640da276faaae7d6e8eb15778c4855551ae7f310c35a5dd279cd2eca6757cd636f96f891e2538b53dbf67f2","0x16b7d288798e5395f20d23bf89edb4d1d115c5dbddbcd30e123da489e726af41727364f2c28297ada8d26d98445f5416","0xbe0e079545f43e4b00cc912f8228ddcc6d19c9f0f69bbb0542eda0fc9dec916a20b15dc0fd2ededda39142311a5001d","0x8d9e5297186db2d9fb266eaac783182b70152c65550d881c5ecd87b6f0f5a6449f38db9dfa9cce202c6477faaf9b7ac","0x166007c08a99db2fc3ba8734ace9824b5eecfdfa8d0cf8ef5dd365bc400a0051d5fa9c01a58b1fb93d1a1399126a775c","0x16a3ef08be3ea7ea03bcddfabba6ff6ee5a4375efa1f4fd7feb34fd206357132b920f5b00801dee460ee415a15812ed9","0x1866c8ed336c61231a1be54fd1d74cc4f9fb0ce4c6af5920abc5750c4bf39b4852cfe2f7bb9248836b233d9d55535d4a","0x167a55cda70a6e1cea820597d94a84903216f763e13d87bb5308592e7ea7d4fbc7385ea3d529b35e346ef48bb8913f55","0x4d2f259eea405bd48f010a01ad2911d9c6dd039bb61a6290e591b36e636a5c871a5c29f4f83060400f8b49cba8f6aa8","0xaccbb67481d033ff5852c1e48c50c477f94ff8aefce42d28c0f9a88cea7913516f968986f7ebbea9684b529e2561092","0xad6b9514c767fe3c3613144b45f1496543346d98adf02267d5ceef9a00d9b8693000763e3b90ac11e99b138573345cc","0x2660400eb2e4f3b628bdd0d53cd76f2bf565b94e72927c1cb748df27942480e420517bd8714cc80d1fadc1326ed06f7","0xe0fa1d816ddc03e6b24255e0d7819c171c40f65e273b853324efcd6356caa205ca2f570f13497804415473a1d634b8f","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"]].map(t=>t.map(t=>BigInt(t)))),ks=$i(gs,{A:gs.create(BigInt("0x144698a3b8e9433d693a02c96d4982b0ea985383ee66a8d8e8981aefd881ac98936f8da0e0f97f5cf428082d584c1d")),B:gs.create(BigInt("0x12e2908d11688030018b12e8753eee3b2016c1f0f24f4070a0b9c14fcef35ef55a23215a316ceaa5d1cc48e98e172be0")),Z:gs.create(BigInt(11))}),Ls=$i(bs,{A:bs.create({c0:gs.create(as),c1:gs.create(BigInt(240))}),B:bs.create({c0:gs.create(BigInt(1012)),c1:gs.create(BigInt(1012))}),Z:bs.create({c0:gs.create(BigInt(-2)),c1:gs.create(BigInt(-1))})});function Ps(t,e,r){const n="string"==typeof t?t:xt(t),i="string"==typeof e?e:xt(e),s="string"==typeof r?r:xt(r);return Rs.verifyShortSignature(i,s,n)}const Cs=t=>qt(new kt(t)),js=t=>{const e=Cs(t);return new Date(Number(e)/1e6)};var Ms,Vs,Ds=function(t,e,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(t,r):i?i.value=r:e.set(t,r),r},qs=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};class $s extends Ut{constructor(t){super(`Invalid certificate: ${t}`)}}!function(t){t[t.Empty=0]="Empty",t[t.Fork=1]="Fork",t[t.Labeled=2]="Labeled",t[t.Leaf=3]="Leaf",t[t.Pruned=4]="Pruned"}(Vs||(Vs={}));class Gs{constructor(t,e,r,n,i=5,s=!1){this._rootKey=e,this._canisterId=r,this._blsVerify=n,this._maxAgeInMinutes=i,Ms.set(this,!1),Ds(this,Ms,s,"f"),this.cert=on(new Uint8Array(t))}static async create(t){const e=Gs.createUnverified(t);return await e.verify(),e}static createUnverified(t){let e=t.blsVerify;return e||(e=Ps),new Gs(t.certificate,t.rootKey,t.canisterId,e,t.maxAgeInMinutes,t.disableTimeVerification)}lookup(t){return Js(t,this.cert.tree)}lookup_label(t){return this.lookup([t])}async verify(){const t=await Hs(this.cert.tree),e=await this._checkDelegationAndGetKey(this.cert.delegation),r=this.cert.signature,n=function(t){const e=zs.byteLength+Ks;if(t.byteLength!==e)throw new TypeError(`BLS DER-encoded public key must be ${e} bytes long`);const r=t.slice(0,zs.byteLength);if(!Nt(r,zs))throw new TypeError(`BLS DER-encoded public key is invalid. Expect the following prefix: ${zs}, but get ${r}`);return t.slice(zs.byteLength)}(e),i=It(Ys("ic-state-root"),t);let s=!1;const o=Zs(this.lookup(["time"]));if(!o)throw new $s("Certificate does not contain a time");if(!qs(this,Ms,"f")){const t=3e5,e=60*this._maxAgeInMinutes*1e3,r=Date.now(),n=r-e,i=r+t,s=js(o);if(s.getTime()<n)throw new $s(`Certificate is signed more than ${this._maxAgeInMinutes} minutes in the past. Certificate time: `+s.toISOString()+" Current time: "+new Date(r).toISOString());if(s.getTime()>i)throw new $s("Certificate is signed more than 5 minutes in the future. Certificate time: "+s.toISOString()+" Current time: "+new Date(r).toISOString())}try{s=await this._blsVerify(new Uint8Array(n),new Uint8Array(r),new Uint8Array(i))}catch(t){s=!1}if(!s)throw new $s("Signature verification failed")}async _checkDelegationAndGetKey(t){if(!t)return this._rootKey;const e=await Gs.createUnverified({certificate:t.certificate,rootKey:this._rootKey,canisterId:this._canisterId,blsVerify:this._blsVerify,maxAgeInMinutes:1/0});if(e.cert.delegation)throw new $s("Delegation certificates cannot be nested");if(await e.verify(),this._canisterId.toString()!==Ca){if(!eo({canisterId:this._canisterId,subnetId:Bt.fromUint8Array(new Uint8Array(t.subnet_id)),tree:e.cert.tree}))throw new $s(`Canister ${this._canisterId} not in range of delegations for subnet 0x${xt(t.subnet_id)}`)}const r=Zs(e.lookup(["subnet",t.subnet_id,"public_key"]));if(!r)throw new Error(`Could not find subnet key for subnet 0x${xt(t.subnet_id)}`);return r}}Ms=new WeakMap;const zs=At("308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100"),Ks=96;function Zs(t){if(t.status===Ws.Found)return t.value instanceof ArrayBuffer?t.value:t.value instanceof Uint8Array?t.value.buffer:void 0}async function Hs(t){switch(t[0]){case Vs.Empty:return Vr(Ys("ic-hashtree-empty"));case Vs.Pruned:return t[1];case Vs.Leaf:return Vr(It(Ys("ic-hashtree-leaf"),t[1]));case Vs.Labeled:return Vr(It(Ys("ic-hashtree-labeled"),t[1],await Hs(t[2])));case Vs.Fork:return Vr(It(Ys("ic-hashtree-fork"),await Hs(t[1]),await Hs(t[2])));default:throw new Error("unreachable")}}function Ys(t){return It(new Uint8Array([t.length]),(new TextEncoder).encode(t))}var Ws,Xs;function Js(t,e){if(0===t.length){if(e[0]===Vs.Leaf){if(!e[1])throw new Error("Invalid tree structure for leaf");return e[1]instanceof ArrayBuffer?{status:Ws.Found,value:e[1]}:e[1]instanceof Uint8Array?{status:Ws.Found,value:e[1].buffer}:{status:Ws.Found,value:e[1]}}return{status:Ws.Found,value:e}}const r=to("string"==typeof t[0]?(new TextEncoder).encode(t[0]):t[0],e);switch(r.status){case Ws.Found:return Js(t.slice(1),r.value);case Xs.Greater:case Xs.Less:return{status:Ws.Absent};default:return r}}function Qs(t){switch(t[0]){case Vs.Empty:return[];case Vs.Fork:return Qs(t[1]).concat(Qs(t[2]));default:return[t]}}function to(t,e){switch(e[0]){case Vs.Labeled:return function(t,e){const r=new Uint8Array(t),n=new Uint8Array(e);for(let t=0;t<r.length;t++)if(r[t]>n[t])return!0;return!1}(t,e[1])?{status:Xs.Greater}:Nt(t,e[1])?{status:Ws.Found,value:e[2]}:{status:Xs.Less};case Vs.Fork:const r=to(t,e[1]);switch(r.status){case Xs.Greater:{const r=to(t,e[2]);return r.status===Xs.Less?{status:Ws.Absent}:r}case Ws.Unknown:{let r=to(t,e[2]);return r.status===Xs.Less?{status:Ws.Unknown}:r}default:return r}case Vs.Pruned:return{status:Ws.Unknown};default:return{status:Ws.Absent}}}function eo(t){const{canisterId:e,subnetId:r,tree:n}=t,i=Js(["subnet",r.toUint8Array(),"canister_ranges"],n);if(i.status!==Ws.Found||!(i.value instanceof ArrayBuffer))throw new Error(`Could not find canister ranges for subnet ${r}`);return on(i.value).map(t=>[Bt.fromUint8Array(t[0]),Bt.fromUint8Array(t[1])]).some(t=>t[0].ltEq(e)&&t[1].gtEq(e))}!function(t){t.Unknown="unknown",t.Absent="absent",t.Found="found"}(Ws||(Ws={})),function(t){t.Less="less",t.Greater="greater"}(Xs||(Xs={}));const ro=async t=>{const{agent:e,paths:r}=t,n=Bt.from(t.canisterId),i=[...new Set(r)],s=i.map(t=>io(t,n)),o=new Map,a=i.map((t,r)=>(async()=>{var a;try{const t=await e.readState(n,{paths:[s[r]]});if(null==e.rootKey)throw new Error("Agent is missing root key");const a=await Gs.create({certificate:t.certificate,rootKey:e.rootKey,canisterId:n,disableTimeVerification:!0}),c=(r,i)=>{if("subnet"===i){if(null==e.rootKey)throw new Error("Agent is missing root key");return{path:i,data:no(t.certificate,n,e.rootKey)}}return{path:i,data:Zs(r.lookup(io(i,n)))}},{path:u,data:f}=c(a,i[r]);if(f)switch(u){case"time":o.set(u,js(f));break;case"controllers":o.set(u,co(f));break;case"module_hash":o.set(u,so(f));break;case"subnet":o.set(u,f);break;case"candid":o.set(u,(new TextDecoder).decode(f));break;default:if("string"!=typeof u&&"key"in u&&"path"in u)switch(u.decodeStrategy){case"raw":o.set(u.key,f);break;case"leb128":o.set(u.key,Cs(f));break;case"cbor":o.set(u.key,oo(f));break;case"hex":o.set(u.key,so(f));break;case"utf-8":o.set(u.key,ao(f))}}else console.warn(`Expected to find result for path ${u}, but instead found nothing.`),"string"==typeof u?o.set(u,null):o.set(u.key,null)}catch(e){if(null===(a=null==e?void 0:e.message)||void 0===a?void 0:a.includes("Invalid certificate"))throw new Ut(e.message);"string"!=typeof t&&"key"in t&&"path"in t?o.set(t.key,null):o.set(t,null),console.group(),console.warn(`Expected to find result for path ${t}, but instead found nothing.`),console.warn(e),console.groupEnd()}})());return await Promise.all(a),o},no=(t,e,r)=>{if(!e._isPrincipal)throw new Error("Invalid canisterId");const n=on(new Uint8Array(t)),i=n.tree;let s,o=n.delegation;o&&o.subnet_id?s=Bt.fromUint8Array(new Uint8Array(o.subnet_id)):o||void 0===r?(s=Bt.selfAuthenticating(Bt.fromText("tdb26-jop6k-aogll-7ltgs-eruif-6kk7m-qpktf-gdiqx-mxtrf-vb5e6-eqe").toUint8Array()),o={subnet_id:s.toUint8Array(),certificate:new ArrayBuffer(0)}):(s=Bt.selfAuthenticating(new Uint8Array(r)),o={subnet_id:s.toUint8Array(),certificate:new ArrayBuffer(0)});if(!eo({canisterId:e,subnetId:s,tree:i}))throw new Error("Canister not in range");const a=Js(["subnet",o.subnet_id,"node"],i);if(a.status!==Ws.Found)throw new Error("Node not found");if(a.value instanceof ArrayBuffer)throw new Error("Invalid node tree");const c=Qs(a.value),u=new Map;return c.forEach(t=>{const e=Bt.from(new Uint8Array(t[1])).toText(),r=Js(["public_key"],t[2]);if(r.status!==Ws.Found)throw new Error("Public key not found");const n=r.value;if(44!==n.byteLength)throw new Error("Invalid public key length");u.set(e,n)}),{subnetId:Bt.fromUint8Array(new Uint8Array(o.subnet_id)).toText(),nodeKeys:u}},io=(t,e)=>{const r=new TextEncoder,n=t=>new DataView(r.encode(t).buffer).buffer,i=new DataView(e.toUint8Array().buffer).buffer;switch(t){case"time":return[n("time")];case"controllers":return[n("canister"),i,n("controllers")];case"module_hash":return[n("canister"),i,n("module_hash")];case"subnet":return[n("subnet")];case"candid":return[n("canister"),i,n("metadata"),n("candid:service")];default:if("key"in t&&"path"in t){if("string"==typeof t.path||t.path instanceof ArrayBuffer){const e=t.path,r="string"==typeof e?n(e):e;return[n("canister"),i,n("metadata"),r]}return t.path}}throw new Error(`An unexpeected error was encountered while encoding your path for canister status. Please ensure that your path, ${t} was formatted correctly.`)},so=t=>xt(t),oo=t=>on(t),ao=t=>(new TextDecoder).decode(t),co=t=>oo(t).map(t=>Bt.fromUint8Array(new Uint8Array(t)));var uo=Object.freeze({__proto__:null,CustomPath:class{constructor(t,e,r){this.key=t,this.path=e,this.decodeStrategy=r}},encodePath:io,fetchNodeKeys:no,request:ro});
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const fo=BigInt(0),ho=BigInt(1),lo=BigInt(2),po=BigInt(8);function yo(t,e,r={}){if("function"!=typeof e)throw new Error('"hash" function param is required');Ln(r,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});const{prehash:n}=r,{BASE:i,Fp:s,Fn:o}=t,a=r.randomBytes||j,c=r.adjustScalarBytes||(t=>t),u=r.domain||((t,e,r)=>{if(vn(r,"phflag"),e.length||r)throw new Error("Contexts/pre-hash are not supported");return t});function f(t){return o.create(In(t))}function h(t){const{head:r,prefix:n,scalar:s}=function(t){const r=b.secretKey;t=An("private key",t,r);const n=An("hashed private key",e(t),2*r),i=c(n.slice(0,r));return{head:i,prefix:n.slice(r,2*r),scalar:f(i)}}(t),o=i.multiply(s),a=o.toBytes();return{head:r,prefix:n,scalar:s,point:o,pointBytes:a}}function l(t){return h(t).pointBytes}function d(t=Uint8Array.of(),...r){const i=L(...r);return f(e(u(i,An("context",t),!!n)))}const p={zip215:!0};const y=s.BYTES,b={secretKey:y,publicKey:y,signature:2*y,seed:y};function w(t=a(b.seed)){return En(t,b.seed,"seed")}const m={getExtendedPublicKey:h,randomSecretKey:w,isValidSecretKey:function(t){return g(t)&&t.length===o.BYTES},isValidPublicKey:function(e,r){try{return!!t.fromBytes(e,r)}catch(t){return!1}},toMontgomery(e){const{y:r}=t.fromBytes(e),n=b.publicKey,i=32===n;if(!i&&57!==n)throw new Error("only defined for 25519 and 448");const o=i?s.div(ho+r,ho-r):s.div(r-ho,r+ho);return s.toBytes(o)},toMontgomerySecret(t){const r=b.secretKey;En(t,r);const n=e(t.subarray(0,r));return c(n).subarray(0,r)},randomPrivateKey:w,precompute:(e=8,r=t.BASE)=>r.precompute(e,!1)};return Object.freeze({keygen:function(t){const e=m.randomSecretKey(t);return{secretKey:e,publicKey:l(e)}},getPublicKey:l,sign:function(t,e,r={}){t=An("message",t),n&&(t=n(t));const{prefix:s,scalar:a,pointBytes:c}=h(e),u=d(r.context,s,t),f=i.multiply(u).toBytes(),l=d(r.context,f,c,t),p=o.create(u+l*a);if(!o.isValid(p))throw new Error("sign failed: invalid s");return En(L(f,o.toBytes(p)),b.signature,"result")},verify:function(e,r,s,o=p){const{context:a,zip215:c}=o,u=b.signature;e=An("signature",e,u),r=An("message",r),s=An("publicKey",s,b.publicKey),void 0!==c&&vn(c,"zip215"),n&&(r=n(r));const f=u/2,h=e.subarray(0,f),l=In(e.subarray(f,u));let y,g,w;try{y=t.fromBytes(s,c),g=t.fromBytes(h,c),w=i.multiplyUnsafe(l)}catch(t){return!1}if(!c&&y.isSmallOrder())return!1;const m=d(a,g.toBytes(),y.toBytes(),r);return g.add(y.multiplyUnsafe(m)).subtract(w).clearCofactor().is0()},utils:m,Point:t,lengths:b})}function go(t){const{CURVE:e,curveOpts:r,hash:n,eddsaOpts:i}=function(t){const e={a:t.a,d:t.d,p:t.Fp.ORDER,n:t.n,h:t.h,Gx:t.Gx,Gy:t.Gy},r={Fp:t.Fp,Fn:ci(e.n,t.nBitLength,!0),uvRatio:t.uvRatio},n={randomBytes:t.randomBytes,adjustScalarBytes:t.adjustScalarBytes,domain:t.domain,prehash:t.prehash,mapToCurve:t.mapToCurve};return{CURVE:e,curveOpts:r,hash:t.hash,eddsaOpts:n}}(t),s=function(t,e={}){const r=xi("edwards",t,e,e.FpFnLE),{Fp:n,Fn:i}=r;let s=r.CURVE;const{h:o}=s;Ln(e,{},{uvRatio:"function"});const a=lo<<BigInt(8*i.BYTES)-ho,c=t=>n.create(t),u=e.uvRatio||((t,e)=>{try{return{isValid:!0,value:n.sqrt(n.div(t,e))}}catch(t){return{isValid:!1,value:fo}}});if(!function(t,e,r,n){const i=t.sqr(r),s=t.sqr(n),o=t.add(t.mul(e.a,i),s),a=t.add(t.ONE,t.mul(e.d,t.mul(i,s)));return t.eql(o,a)}(n,s,s.Gx,s.Gy))throw new Error("bad curve params: generator point");function f(t,e,r=!1){return Rn("coordinate "+t,e,r?ho:fo,a),e}function h(t){if(!(t instanceof p))throw new Error("ExtendedPoint expected")}const l=Cn((t,e)=>{const{X:r,Y:i,Z:s}=t,o=t.is0();null==e&&(e=o?po:n.inv(s));const a=c(r*e),u=c(i*e),f=n.mul(s,e);if(o)return{x:fo,y:ho};if(f!==ho)throw new Error("invZ was invalid");return{x:a,y:u}}),d=Cn(t=>{const{a:e,d:r}=s;if(t.is0())throw new Error("bad point: ZERO");const{X:n,Y:i,Z:o,T:a}=t,u=c(n*n),f=c(i*i),h=c(o*o),l=c(h*h),d=c(u*e);if(c(h*c(d+f))!==c(l+c(r*c(u*f))))throw new Error("bad point: equation left != right (1)");if(c(n*i)!==c(o*a))throw new Error("bad point: equation left != right (2)");return!0});class p{constructor(t,e,r,n){this.X=f("x",t),this.Y=f("y",e),this.Z=f("z",r,!0),this.T=f("t",n),Object.freeze(this)}static CURVE(){return s}static fromAffine(t){if(t instanceof p)throw new Error("extended point not allowed");const{x:e,y:r}=t||{};return f("x",e),f("y",r),new p(e,r,ho,c(e*r))}static fromBytes(t,e=!1){const r=n.BYTES,{a:i,d:o}=s;t=Sn(En(t,r,"point")),vn(e,"zip215");const f=Sn(t),h=t[r-1];f[r-1]=-129&h;const l=In(f),d=e?a:n.ORDER;Rn("point.y",l,fo,d);const y=c(l*l),g=c(y-ho),b=c(o*y-i);let{isValid:w,value:m}=u(g,b);if(!w)throw new Error("bad point: invalid y coordinate");const v=(m&ho)===ho,E=!!(128&h);if(!e&&m===fo&&E)throw new Error("bad point: x=0 and x_0=1");return E!==v&&(m=c(-m)),p.fromAffine({x:m,y:l})}static fromHex(t,e=!1){return p.fromBytes(An("point",t),e)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(t=8,e=!0){return y.createCache(this,t),e||this.multiply(lo),this}assertValidity(){d(this)}equals(t){h(t);const{X:e,Y:r,Z:n}=this,{X:i,Y:s,Z:o}=t,a=c(e*o),u=c(i*n),f=c(r*o),l=c(s*n);return a===u&&f===l}is0(){return this.equals(p.ZERO)}negate(){return new p(c(-this.X),this.Y,this.Z,c(-this.T))}double(){const{a:t}=s,{X:e,Y:r,Z:n}=this,i=c(e*e),o=c(r*r),a=c(lo*c(n*n)),u=c(t*i),f=e+r,h=c(c(f*f)-i-o),l=u+o,d=l-a,y=u-o,g=c(h*d),b=c(l*y),w=c(h*y),m=c(d*l);return new p(g,b,m,w)}add(t){h(t);const{a:e,d:r}=s,{X:n,Y:i,Z:o,T:a}=this,{X:u,Y:f,Z:l,T:d}=t,y=c(n*u),g=c(i*f),b=c(a*r*d),w=c(o*l),m=c((n+i)*(u+f)-y-g),v=w-b,E=w+b,_=c(g-e*y),B=c(m*v),I=c(E*_),x=c(m*_),T=c(v*E);return new p(B,I,T,x)}subtract(t){return this.add(t.negate())}multiply(t){if(!i.isValidNot0(t))throw new Error("invalid scalar: expected 1 <= sc < curve.n");const{p:e,f:r}=y.cached(this,t,t=>pi(p,t));return pi(p,[e,r])[0]}multiplyUnsafe(t,e=p.ZERO){if(!i.isValid(t))throw new Error("invalid scalar: expected 0 <= sc < curve.n");return t===fo?p.ZERO:this.is0()||t===ho?this:y.unsafe(this,t,t=>pi(p,t),e)}isSmallOrder(){return this.multiplyUnsafe(o).is0()}isTorsionFree(){return y.unsafe(this,s.n).is0()}toAffine(t){return l(this,t)}clearCofactor(){return o===ho?this:this.multiplyUnsafe(o)}toBytes(){const{x:t,y:e}=this.toAffine(),r=n.toBytes(e);return r[r.length-1]|=t&ho?128:0,r}toHex(){return I(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get ex(){return this.X}get ey(){return this.Y}get ez(){return this.Z}get et(){return this.T}static normalizeZ(t){return pi(p,t)}static msm(t,e){return Bi(p,i,t,e)}_setWindowSize(t){this.precompute(t)}toRawBytes(){return this.toBytes()}}p.BASE=new p(s.Gx,s.Gy,ho,c(s.Gx*s.Gy)),p.ZERO=new p(fo,ho,ho,fo),p.Fp=n,p.Fn=i;const y=new _i(p,i.BITS);return p.BASE.precompute(8),p}(e,r);return function(t,e){const r=e.Point;return Object.assign({},e,{ExtendedPoint:r,CURVE:t,nBitLength:r.Fn.BITS,nByteLength:r.Fn.BYTES})}(t,yo(s,n,i))}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const bo=BigInt(1),wo=BigInt(2);BigInt(3);const mo=BigInt(5),vo=BigInt(8),Eo=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),_o=(()=>({p:Eo,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:vo,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")}))();function Bo(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}const Io=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");function xo(t,e){const r=Eo,n=Hn(e*e*e,r),i=function(t){const e=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),s=Eo,o=t*t%s*t%s,a=Yn(o,wo,s)*o%s,c=Yn(a,bo,s)*t%s,u=Yn(c,mo,s)*c%s,f=Yn(u,e,s)*u%s,h=Yn(f,r,s)*f%s,l=Yn(h,n,s)*h%s,d=Yn(l,i,s)*l%s,p=Yn(d,i,s)*l%s,y=Yn(p,e,s)*u%s;return{pow_p_5_8:Yn(y,wo,s)*t%s,b2:o}}(t*Hn(n*n*e,r)).pow_p_5_8;let s=Hn(t*n*i,r);const o=Hn(e*s*s,r),a=s,c=Hn(s*Io,r),u=o===t,f=o===Hn(-t,r),h=o===Hn(-t*Io,r);return u&&(s=a),(f||h)&&(s=c),(Hn(s,r)&Mn)===Mn&&(s=Hn(-s,r)),{isValid:u||f,value:s}}const To=(()=>ci(_o.p,{isLE:!0}))(),Ao=(()=>({..._o,Fp:To,hash:mt,adjustScalarBytes:Bo,uvRatio:xo}))(),So=(()=>go(Ao))();var No,Oo,Ro,Uo,Fo=function(t,e,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(t,r):i?i.value=r:e.set(t,r),r},ko=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};class Lo{constructor(t={}){No.set(this,void 0),Oo.set(this,void 0),this[Ro]=this.entries.bind(this),this[Uo]="ExpirableMap";const{source:e=[],expirationTime:r=6e5}=t,n=Date.now();Fo(this,No,new Map([...e].map(([t,e])=>[t,{value:e,timestamp:n}])),"f"),Fo(this,Oo,r,"f")}prune(){const t=Date.now();for(const[e,r]of ko(this,No,"f").entries())t-r.timestamp>ko(this,Oo,"f")&&ko(this,No,"f").delete(e);return this}set(t,e){this.prune();const r={value:e,timestamp:Date.now()};return ko(this,No,"f").set(t,r),this}get(t){const e=ko(this,No,"f").get(t);if(void 0!==e){if(!(Date.now()-e.timestamp>ko(this,Oo,"f")))return e.value;ko(this,No,"f").delete(t)}}clear(){ko(this,No,"f").clear()}entries(){const t=ko(this,No,"f").entries();return function*(){for(const[e,r]of t)yield[e,r.value]}()}values(){const t=ko(this,No,"f").values();return function*(){for(const e of t)yield e.value}()}keys(){return ko(this,No,"f").keys()}forEach(t,e){for(const[r,n]of ko(this,No,"f").entries())t.call(e,n.value,r,this)}has(t){return ko(this,No,"f").has(t)}delete(t){return ko(this,No,"f").delete(t)}get size(){return ko(this,No,"f").size}}No=new WeakMap,Oo=new WeakMap,Ro=Symbol.iterator,Uo=Symbol.toStringTag;const Po=t=>{if(t<=127)return 1;if(t<=255)return 2;if(t<=65535)return 3;if(t<=16777215)return 4;throw new Error("Length too long (> 4 bytes)")},Co=(t,e,r)=>{if(r<=127)return t[e]=r,1;if(r<=255)return t[e]=129,t[e+1]=r,2;if(r<=65535)return t[e]=130,t[e+1]=r>>8,t[e+2]=r,3;if(r<=16777215)return t[e]=131,t[e+1]=r>>16,t[e+2]=r>>8,t[e+3]=r,4;throw new Error("Length too long (> 4 bytes)")},jo=(t,e)=>{if(t[e]<128)return 1;if(128===t[e])throw new Error("Invalid length 0");if(129===t[e])return 2;if(130===t[e])return 3;if(131===t[e])return 4;throw new Error("Length too long (> 4 bytes)")};Uint8Array.from([48,12,6,10,43,6,1,4,1,131,184,67,1,1]);const Mo=Uint8Array.from([48,5,6,3,43,101,112]);Uint8Array.from([48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,10]);const Vo=(t,e)=>{let r=0;const n=(t,e)=>{if(i[r++]!==t)throw new Error("Expected: "+e)},i=new Uint8Array(t);if(n(48,"sequence"),r+=jo(i,r),!Nt(i.slice(r,r+e.byteLength),e))throw new Error("Not the expected OID.");r+=e.byteLength,n(3,"bit string");const s=((t,e)=>{const r=jo(t,e);if(1===r)return t[e];if(2===r)return t[e+1];if(3===r)return(t[e+1]<<8)+t[e+2];if(4===r)return(t[e+1]<<16)+(t[e+2]<<8)+t[e+3];throw new Error("Length too long (> 4 bytes)")})(i,r)-1;r+=jo(i,r),n(0,"0 padding");const o=i.slice(r);if(s!==o.length)throw new Error(`DER payload mismatch: Expected length ${s} actual length ${o.length}`);return o};var Do,qo,$o=function(t,e,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(t,r):i?i.value=r:e.set(t,r),r},Go=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};class zo{constructor(t){if(Do.set(this,void 0),qo.set(this,void 0),t.byteLength!==zo.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");$o(this,Do,t,"f"),$o(this,qo,zo.derEncode(t),"f")}static from(t){return this.fromDer(t.toDer())}static fromRaw(t){return new zo(t)}static fromDer(t){return new zo(this.derDecode(t))}static derEncode(t){return function(t,e){const r=2+Po(t.byteLength+1),n=e.byteLength+r+t.byteLength;let i=0;const s=new Uint8Array(1+Po(n)+n);return s[i++]=48,i+=Co(s,i,n),s.set(e,i),i+=e.byteLength,s[i++]=3,i+=Co(s,i,t.byteLength+1),s[i++]=0,s.set(new Uint8Array(t),i),s}(t,Mo).buffer}static derDecode(t){const e=Vo(t,Mo);if(e.length!==this.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");return e}get rawKey(){return Go(this,Do,"f")}get derKey(){return Go(this,qo,"f")}toDer(){return this.derKey}toRaw(){return this.rawKey}}Do=new WeakMap,qo=new WeakMap,zo.RAW_KEY_LENGTH=32;class Ko{constructor(){this.observers=[]}subscribe(t){this.observers.push(t)}unsubscribe(t){this.observers=this.observers.filter(e=>e!==t)}notify(t,...e){this.observers.forEach(r=>r(t,...e))}}class Zo extends Ko{constructor(){super()}print(t,...e){this.notify({message:t,level:"info"},...e)}warn(t,...e){this.notify({message:t,level:"warn"},...e)}error(t,e,...r){this.notify({message:t,level:"error",error:e},...r)}}var Ho,Yo,Wo,Xo,Jo,Qo,ta,ea,ra,na=function(t,e,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(t,r):i?i.value=r:e.set(t,r),r},ia=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};const sa=.5,oa=1.5,aa=500,ca=6e4,ua=9e5,fa=10;class ha{constructor(t=ha.default){Ho.set(this,void 0),Yo.set(this,void 0),Wo.set(this,void 0),Xo.set(this,void 0),Jo.set(this,void 0),Qo.set(this,void 0),ta.set(this,void 0),ea.set(this,void 0),ra.set(this,0);const{initialInterval:e=aa,randomizationFactor:r=sa,multiplier:n=oa,maxInterval:i=ca,maxElapsedTime:s=ua,maxIterations:o=fa,date:a=Date}=t;na(this,Ho,e,"f"),na(this,Yo,r,"f"),na(this,Wo,n,"f"),na(this,Xo,i,"f"),na(this,ea,a,"f"),na(this,Jo,a.now(),"f"),na(this,Qo,s,"f"),na(this,ta,o,"f")}get ellapsedTimeInMsec(){return ia(this,ea,"f").now()-ia(this,Jo,"f")}get currentInterval(){return ia(this,Ho,"f")}get count(){return ia(this,ra,"f")}get randomValueFromInterval(){const t=ia(this,Yo,"f")*ia(this,Ho,"f"),e=ia(this,Ho,"f")-t,r=ia(this,Ho,"f")+t;return Math.random()*(r-e)+e}incrementCurrentInterval(){var t;return na(this,Ho,Math.min(ia(this,Ho,"f")*ia(this,Wo,"f"),ia(this,Xo,"f")),"f"),na(this,ra,(t=ia(this,ra,"f"),++t),"f"),ia(this,Ho,"f")}next(){return this.ellapsedTimeInMsec>=ia(this,Qo,"f")||ia(this,ra,"f")>=ia(this,ta,"f")?null:(this.incrementCurrentInterval(),this.randomValueFromInterval)}}Ho=new WeakMap,Yo=new WeakMap,Wo=new WeakMap,Xo=new WeakMap,Jo=new WeakMap,Qo=new WeakMap,ta=new WeakMap,ea=new WeakMap,ra=new WeakMap,ha.default={initialInterval:aa,randomizationFactor:sa,multiplier:oa,maxInterval:ca,maxElapsedTime:ua,maxIterations:fa,date:Date};var la,da,pa,ya,ga,ba,wa,ma,va,Ea,_a,Ba,Ia,xa,Ta,Aa,Sa,Na,Oa,Ra,Ua,Fa,ka=function(t,e,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(t,r):i?i.value=r:e.set(t,r),r},La=function(t,e,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(t):n?n.value:e.get(t)};!function(t){t.Received="received",t.Processing="processing",t.Replied="replied",t.Rejected="rejected",t.Unknown="unknown",t.Done="done"}(Fa||(Fa={}));const Pa=6e4,Ca="aaaaa-aa";class ja extends Ut{constructor(t){super(t),this.message=t}}class Ma extends Ut{constructor(t){super(t),this.message=t}}class Va{constructor(t={}){var e,r;la.add(this),da.set(this,null),pa.set(this,!1),ya.set(this,void 0),ga.set(this,void 0),ba.set(this,void 0),wa.set(this,void 0),ma.set(this,0),va.set(this,void 0),Ea.set(this,void 0),_a.set(this,void 0),Ba.set(this,void 0),this._isAgent=!0,this.config={},Ia.set(this,0),this.log=new Zo,xa.set(this,[]),Ta.set(this,[]),Aa.set(this,new Lo({expirationTime:3e5})),Sa.set(this,!0),Ra.set(this,(t,e)=>{if(!1===La(this,Sa,"f"))return t;if(!e)throw new $s("Invalid signature from replica signed query: no matching node key found.");const{status:r,signatures:n=[],requestId:i}=t,s=Rt((new TextEncoder).encode("\vic-response"));for(const o of n){const{timestamp:n,identity:a}=o,c=Bt.fromUint8Array(a).toText();let u;if("replied"===r){const{reply:e}=t;u=Gr({status:r,reply:e,timestamp:BigInt(n),request_id:i})}else{if("rejected"!==r)throw new Error(`Unknown status: ${r}`);{const{reject_code:e,reject_message:s,error_code:o}=t;u=Gr({status:r,reject_code:e,reject_message:s,error_code:o,timestamp:BigInt(n),request_id:i})}}const f=It(s,Rt(new Uint8Array(u))),h=null==e?void 0:e.nodeKeys.get(c);if(!h)throw new $s("Invalid signature from replica signed query: no matching node key found.");const l=zo.fromDer(h).rawKey;if(So.verify(o.signature,new Uint8Array(f),new Uint8Array(l)))return t;throw new $s(`Invalid signature from replica ${c} signed query.`)}return t}),this.config=t,ka(this,ga,t.fetch||function(){let t;if("undefined"!=typeof window){if(!window.fetch)throw new ja("Fetch implementation was not available. You appear to be in a browser context, but window.fetch was not present.");t=window.fetch.bind(window)}else if("undefined"!=typeof global){if(!global.fetch)throw new ja("Fetch implementation was not available. You appear to be in a Node.js context, but global.fetch was not available.");t=global.fetch.bind(global)}else"undefined"!=typeof self&&self.fetch&&(t=self.fetch.bind(self));if(t)return t;throw new ja("Fetch implementation was not available. Please provide fetch to the HttpAgent constructor, or ensure it is available in the window or global context.")}()||fetch.bind(global),"f"),ka(this,ba,t.fetchOptions,"f"),ka(this,wa,t.callOptions,"f"),ka(this,pa,null!==(e=t.shouldFetchRootKey)&&void 0!==e&&e,"f"),t.rootKey?this.rootKey=t.rootKey:La(this,pa,"f")?this.rootKey=null:this.rootKey=At("308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100814c0e6ec71fab583b08bd81373c255c3c371b2e84863c98a4f1e08b74235d14fb5d9c0cd546d9685f913a0c0b2cc5341583bf4b4392e467db96d65b9bb4cb717112f8472e0d5a4d14505ffd7484b01291091c5f87b98883463f98091a0baaae");const n=function(t){let e;if(void 0!==t)e=t.match(/^[a-z]+:/)||"undefined"==typeof window?new URL(t):new URL(window.location.protocol+"//"+t);else{const t=["ic0.app","icp0.io","127.0.0.1","localhost"],r=[".github.dev",".gitpod.io"],n="undefined"!=typeof window?window.location:void 0,i=null==n?void 0:n.hostname;let s;i&&"string"==typeof i&&(s=r.some(t=>i.endsWith(t))?i:t.find(t=>i.endsWith(t))),e=n&&s?new URL(`${n.protocol}//${s}${n.port?":"+n.port:""}`):new URL("https://icp-api.io")}return e.toString()}(t.host);this.host=new URL(n),void 0!==t.verifyQuerySignatures&&ka(this,Sa,t.verifyQuerySignatures,"f"),ka(this,Ea,null!==(r=t.retryTimes)&&void 0!==r?r:3,"f");if(ka(this,_a,t.backoffStrategy||(()=>new ha({maxIterations:La(this,Ea,"f")})),"f"),this.host.hostname.endsWith(".ic0.app")?this.host.hostname="ic0.app":this.host.hostname.endsWith(".icp0.io")?this.host.hostname="icp0.io":this.host.hostname.endsWith(".icp-api.io")&&(this.host.hostname="icp-api.io"),t.credentials){const{name:e,password:r}=t.credentials;ka(this,va,`${e}${r?":"+r:""}`,"f")}if(ka(this,ya,Promise.resolve(t.identity||new zr),"f"),t.ingressExpiryInMinutes&&t.ingressExpiryInMinutes>5)throw new Ut(`The maximum ingress expiry time is 5 minutes. Provided ingress expiry time is ${t.ingressExpiryInMinutes} minutes.`);if(t.ingressExpiryInMinutes&&t.ingressExpiryInMinutes<=0)throw new Ut(`Ingress expiry time must be greater than 0. Provided ingress expiry time is ${t.ingressExpiryInMinutes} minutes.`);ka(this,Ba,t.ingressExpiryInMinutes||5,"f"),this.addTransform("update",ln(un)),t.useQueryNonces&&this.addTransform("query",ln(un)),t.logToConsole&&this.log.subscribe(t=>{"error"===t.level?console.error(t.message):"warn"===t.level?console.warn(t.message):console.log(t.message)})}get waterMark(){return La(this,Ia,"f")}static createSync(t={}){return new this(Object.assign({},t))}static async create(t={shouldFetchRootKey:!1}){const e=Va.createSync(t),r=[e.syncTime()];return"https://icp-api.io"!==e.host.toString()&&t.shouldFetchRootKey&&r.push(e.fetchRootKey()),await Promise.all(r),e}static async from(t){var e;try{return"config"in t?await Va.create(t.config):await Va.create({fetch:t._fetch,fetchOptions:t._fetchOptions,callOptions:t._callOptions,host:t._host.toString(),identity:null!==(e=t._identity)&&void 0!==e?e:void 0})}catch(t){throw new Ut("Failed to create agent from provided agent")}}isLocal(){const t=this.host.hostname;return"127.0.0.1"===t||t.endsWith("127.0.0.1")}addTransform(t,e,r=e.priority||0){if("update"===t){const t=La(this,Ta,"f").findIndex(t=>(t.priority||0)<r);La(this,Ta,"f").splice(t>=0?t:La(this,Ta,"f").length,0,Object.assign(e,{priority:r}))}else if("query"===t){const t=La(this,xa,"f").findIndex(t=>(t.priority||0)<r);La(this,xa,"f").splice(t>=0?t:La(this,xa,"f").length,0,Object.assign(e,{priority:r}))}}async getPrincipal(){if(!La(this,ya,"f"))throw new Ma("This identity has expired due this application's security policy. Please refresh your authentication.");return(await La(this,ya,"f")).getPrincipal()}async call(t,e,r){var n,i;await La(this,la,"m",Ua).call(this);const s=null===(n=e.callSync)||void 0===n||n,o=await(void 0!==r?await r:await La(this,ya,"f"));if(!o)throw new Ma("This identity has expired due this application's security policy. Please refresh your authentication.");const a=Bt.from(t),c=e.effectiveCanisterId?Bt.from(e.effectiveCanisterId):a,u=o.getPrincipal()||Bt.anonymous();let f=new hn(La(this,Ba,"f")*Pa);Math.abs(La(this,ma,"f"))>3e4&&(f=new hn(La(this,Ba,"f")*Pa+La(this,ma,"f")));const h={request_type:cn.Call,canister_id:a,method_name:e.methodName,arg:e.arg,sender:u,ingress_expiry:f};let l,d=await this._transform({request:{body:null,method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},La(this,va,"f")?{Authorization:"Basic "+btoa(La(this,va,"f"))}:{})},endpoint:"call",body:h});function p(t){return new Uint8Array(t)}l=(null==e?void 0:e.nonce)?p(e.nonce):d.body.nonce?p(d.body.nonce):void 0,h.nonce=l,d=await o.transformRequest(d);const y=rn(d.body),g=La(this,_a,"f").call(this),b=$r(h);try{const t=()=>(this.log.print(`fetching "/api/v3/canister/${c.toText()}/call" with request:`,d),La(this,ga,"f").call(this,""+new URL(`/api/v3/canister/${c.toText()}/call`,this.host),Object.assign(Object.assign(Object.assign({},La(this,wa,"f")),d.request),{body:y}))),e=()=>(this.log.print(`fetching "/api/v2/canister/${c.toText()}/call" with request:`,d),La(this,ga,"f").call(this,""+new URL(`/api/v2/canister/${c.toText()}/call`,this.host),Object.assign(Object.assign(Object.assign({},La(this,wa,"f")),d.request),{body:y}))),r=La(this,la,"m",Oa).call(this,{request:s?t:e,backoff:g,tries:0}),n=await r,i=await n.arrayBuffer(),o=200===n.status&&i.byteLength>0?on(i):null;if(o&&"certificate"in o){const t=await this.parseTimeFromResponse({certificate:o.certificate});ka(this,Ia,t,"f")}return{requestId:b,response:{ok:n.ok,status:n.status,statusText:n.statusText,body:o,headers:dn(n.headers)},requestDetails:h}}catch(n){if(n.message.includes("v3 api not supported."))return this.log.warn("v3 api not supported. Fall back to v2"),this.call(t,Object.assign(Object.assign({},e),{callSync:!1}),r);const s=`Error while making call: ${null!==(i=n.message)&&void 0!==i?i:String(n)}`,o=new yn(s,n,xt(b),xt(d.body.sender_pubkey),xt(d.body.sender_sig),String(d.body.content.ingress_expiry._value));throw this.log.error(s,o),o}}async query(t,e,r){var n,i,s,o;await La(this,la,"m",Ua).call(this);const a=La(this,_a,"f").call(this),c=e.effectiveCanisterId?Bt.from(e.effectiveCanisterId):Bt.from(t);let u,f;this.log.print(`ecid ${c.toString()}`),this.log.print(`canisterId ${t.toString()}`);const h=await(void 0!==r?r:La(this,ya,"f"));if(!h)throw new Ma("This identity has expired due this application's security policy. Please refresh your authentication.");const l=Bt.from(t),d=(null==h?void 0:h.getPrincipal())||Bt.anonymous(),p={request_type:"query",canister_id:l,method_name:e.methodName,arg:e.arg,sender:d,ingress_expiry:new hn(La(this,Ba,"f")*Pa)},y=$r(p);u=await this._transform({request:{method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},La(this,va,"f")?{Authorization:"Basic "+btoa(La(this,va,"f"))}:{})},endpoint:"read",body:p}),u=await(null==h?void 0:h.transformRequest(u));const g=rn(u.body),b={canister:l.toText(),ecid:c,transformedRequest:u,body:g,requestId:y,backoff:a,tries:0},w=async()=>({requestDetails:p,query:await La(this,la,"m",Na).call(this,b)}),m=async()=>{if(!La(this,Sa,"f"))return;const t=La(this,Aa,"f").get(c.toString());return t||(await this.fetchSubnetKeys(c.toString()),La(this,Aa,"f").get(c.toString()))};try{const[e,r]=await Promise.all([w(),m()]);f=e;const{requestDetails:n,query:i}=f,s=Object.assign(Object.assign({},i),{requestDetails:n});if(this.log.print("Query response:",s),!La(this,Sa,"f"))return s;try{return La(this,Ra,"f").call(this,s,r)}catch(e){this.log.warn("Query response verification failed. Retrying with fresh subnet keys."),La(this,Aa,"f").delete(t.toString()),await this.fetchSubnetKeys(c.toString());const r=La(this,Aa,"f").get(t.toString());if(!r)throw new $s("Invalid signature from replica signed query: no matching node key found.");return La(this,Ra,"f").call(this,s,r)}}catch(t){const e=`Error while making call: ${null!==(n=t.message)&&void 0!==n?n:String(t)}`,r=new gn(e,t,String(y),xt(null===(i=null==u?void 0:u.body)||void 0===i?void 0:i.sender_pubkey),xt(null===(s=null==u?void 0:u.body)||void 0===s?void 0:s.sender_sig),String(null===(o=null==u?void 0:u.body)||void 0===o?void 0:o.content.ingress_expiry._value));throw this.log.error(e,r),r}}async createReadStateRequest(t,e){await La(this,la,"m",Ua).call(this);const r=await(void 0!==e?await e:await La(this,ya,"f"));if(!r)throw new Ma("This identity has expired due this application's security policy. Please refresh your authentication.");const n=(null==r?void 0:r.getPrincipal())||Bt.anonymous(),i=await this._transform({request:{method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},La(this,va,"f")?{Authorization:"Basic "+btoa(La(this,va,"f"))}:{})},endpoint:"read_state",body:{request_type:"read_state",paths:t.paths,sender:n,ingress_expiry:new hn(La(this,Ba,"f")*Pa)}});return null==r?void 0:r.transformRequest(i)}async readState(t,e,r,n){var i,s,o,a;const c=function(t){for(const e of t.paths){const[t,r]=e;if(Nt(t,Rt((new TextEncoder).encode("request_status"))))return r}}(e);await La(this,la,"m",Ua).call(this);const u="string"==typeof t?Bt.fromText(t):t,f=null!=n?n:await this.createReadStateRequest(e,r),h=rn(f.body);this.log.print(`fetching "/api/v2/canister/${u}/read_state" with request:`,f);const l=La(this,_a,"f").call(this);try{const t=await La(this,la,"m",Oa).call(this,{request:()=>La(this,ga,"f").call(this,""+new URL(`/api/v2/canister/${u.toString()}/read_state`,this.host),Object.assign(Object.assign(Object.assign({},La(this,ba,"f")),f.request),{body:h})),backoff:l,tries:0});if(!t.ok)throw new Error(`Server returned an error:\n  Code: ${t.status} (${t.statusText})\n  Body: ${await t.text()}\n`);const e=on(await t.arrayBuffer());this.log.print("Read state response:",e);const r=await this.parseTimeFromResponse(e);return r>0&&(this.log.print("Read state response time:",r),ka(this,Ia,r,"f")),e}catch(t){const e=`Caught exception while attempting to read state: ${null!==(i=t.message)&&void 0!==i?i:String(t)}`,r=new bn(e,t,String(c),xt(null===(s=null==f?void 0:f.body)||void 0===s?void 0:s.sender_pubkey),xt(null===(o=null==f?void 0:f.body)||void 0===o?void 0:o.sender_sig),String(null===(a=null==f?void 0:f.body)||void 0===a?void 0:a.content.ingress_expiry._value));throw this.log.error(e,r),r}}async parseTimeFromResponse(t){let e;if(t.certificate){const r=on(t.certificate);if(!r||!("tree"in r))throw new Error("Could not decode time from response");e=r.tree;const n=Js(["time"],e);if(n.status!==Ws.Found)throw new Error("Time was not found in the response or was not in its expected format.");if(!(n.value instanceof ArrayBuffer||ArrayBuffer.isView(n)))throw new Error("Time was not found in the response or was not in its expected format.");const i=js(Rt(n.value));return this.log.print("Time from response:",i),this.log.print("Time from response in milliseconds:",Number(i)),Number(i)}return this.log.warn("No certificate found in response"),0}async syncTime(t){await La(this,la,"m",Ua).call(this);const e=await Promise.resolve().then(function(){return uo}),r=Date.now();try{t||this.log.print("Syncing time with the IC. No canisterId provided, so falling back to ryjl3-tyaaa-aaaaa-aaaba-cai");const n=Va.createSync({identity:new zr,host:this.host.toString(),fetch:La(this,ga,"f"),retryTimes:0}),i=(await e.request({canisterId:null!=t?t:Bt.from("ryjl3-tyaaa-aaaaa-aaaba-cai"),agent:n,paths:["time"]})).get("time");i&&(ka(this,ma,Number(i)-Number(r),"f"),this.log.notify({message:`Syncing time: offset of ${La(this,ma,"f")}`,level:"info"}))}catch(t){this.log.error("Caught exception while attempting to sync time",t)}}async status(){const t=La(this,va,"f")?{Authorization:"Basic "+btoa(La(this,va,"f"))}:{};this.log.print('fetching "/api/v2/status"');const e=La(this,_a,"f").call(this),r=await La(this,la,"m",Oa).call(this,{backoff:e,request:()=>La(this,ga,"f").call(this,""+new URL("/api/v2/status",this.host),Object.assign({headers:t},La(this,ba,"f"))),tries:0});return on(await r.arrayBuffer())}async fetchRootKey(){let t;return La(this,da,"f")||ka(this,da,new Promise((t,e)=>{this.status().then(e=>{const r=e.root_key;this.rootKey=r,t(r)}).catch(e)}),"f"),t=await La(this,da,"f"),ka(this,da,null,"f"),t}invalidateIdentity(){ka(this,ya,null,"f")}replaceIdentity(t){ka(this,ya,Promise.resolve(t),"f")}async fetchSubnetKeys(t){await La(this,la,"m",Ua).call(this);const e=Bt.from(t),r=(await ro({canisterId:e,paths:["subnet"],agent:this})).get("subnet");if(r&&"object"==typeof r&&"nodeKeys"in r)return La(this,Aa,"f").set(e.toText(),r),r}_transform(t){let e=Promise.resolve(t);if("call"===t.endpoint)for(const t of La(this,Ta,"f"))e=e.then(e=>t(e).then(t=>t||e));else for(const t of La(this,xa,"f"))e=e.then(e=>t(e).then(t=>t||e));return e}}var Da;function qa(){const t="undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?void 0:self.ic.agent:global.ic.agent:window.ic.agent;if(!t)throw new Error("No Agent could be found.");return t}da=new WeakMap,pa=new WeakMap,ya=new WeakMap,ga=new WeakMap,ba=new WeakMap,wa=new WeakMap,ma=new WeakMap,va=new WeakMap,Ea=new WeakMap,_a=new WeakMap,Ba=new WeakMap,Ia=new WeakMap,xa=new WeakMap,Ta=new WeakMap,Aa=new WeakMap,Sa=new WeakMap,Ra=new WeakMap,la=new WeakSet,Na=async function t(e){var r,n;const{ecid:i,transformedRequest:s,body:o,requestId:a,backoff:c,tries:u}=e,f=0===u?0:c.next();if(this.log.print(`fetching "/api/v2/canister/${i.toString()}/query" with tries:`,{tries:u,backoff:c,delay:f}),null===f)throw new Ut(`Timestamp failed to pass the watermark after retrying the configured ${La(this,Ea,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);let h;f>0&&await new Promise(t=>setTimeout(t,f));try{this.log.print(`fetching "/api/v2/canister/${i.toString()}/query" with request:`,s);const t=await La(this,ga,"f").call(this,""+new URL(`/api/v2/canister/${i.toString()}/query`,this.host),Object.assign(Object.assign(Object.assign({},La(this,ba,"f")),s.request),{body:o}));if(200!==t.status)throw new pn(`Gateway returned an error:\n  Code: ${t.status} (${t.statusText})\n  Body: ${await t.text()}\n`,{ok:t.ok,status:t.status,statusText:t.statusText,headers:dn(t.headers)});{const e=on(await t.arrayBuffer());h=Object.assign(Object.assign({},e),{httpDetails:{ok:t.ok,status:t.status,statusText:t.statusText,headers:dn(t.headers)},requestId:a})}}catch(r){if(u<La(this,Ea,"f"))return this.log.warn(`Caught exception while attempting to make query:\n  ${r}\n  Retrying query.`),await La(this,la,"m",t).call(this,Object.assign(Object.assign({},e),{tries:u+1}));throw r}const l=null===(n=null===(r=h.signatures)||void 0===r?void 0:r[0])||void 0===n?void 0:n.timestamp;if(!La(this,Sa,"f"))return h;if(!l)throw new Error("Timestamp not found in query response. This suggests a malformed or malicious response.");const d=Number(BigInt(l)/BigInt(1e6));if(this.log.print("watermark and timestamp",{waterMark:this.waterMark,timestamp:d}),Number(this.waterMark)>d){const r=new Ut("Timestamp is below the watermark. Retrying query.");if(this.log.error("Timestamp is below",r,{timestamp:l,waterMark:this.waterMark}),u<La(this,Ea,"f"))return await La(this,la,"m",t).call(this,Object.assign(Object.assign({},e),{tries:u+1}));throw new Ut(`Timestamp failed to pass the watermark after retrying the configured ${La(this,Ea,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`)}return h},Oa=async function t(e){const{request:r,backoff:n,tries:i}=e,s=0===i?0:n.next();if(null===s)throw new Ut(`Timestamp failed to pass the watermark after retrying the configured ${La(this,Ea,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);let o;s>0&&await new Promise(t=>setTimeout(t,s));try{o=await r()}catch(e){if(La(this,Ea,"f")>i)return this.log.warn(`Caught exception while attempting to make request:\n  ${e}\n  Retrying request.`),await La(this,la,"m",t).call(this,{request:r,backoff:n,tries:i+1});throw e}if(o.ok)return o;const a=await o.clone().text(),c=`Server returned an error:\n  Code: ${o.status} (${o.statusText})\n  Body: ${a}\n`;if(404===o.status&&o.url.includes("api/v3"))throw new pn("v3 api not supported. Fall back to v2",{ok:o.ok,status:o.status,statusText:o.statusText,headers:dn(o.headers)});if(i<La(this,Ea,"f"))return await La(this,la,"m",t).call(this,{request:r,backoff:n,tries:i+1});throw new pn(c,{ok:o.ok,status:o.status,statusText:o.statusText,headers:dn(o.headers)})},Ua=async function(){if(!this.rootKey){if(null!==this.rootKey||!La(this,pa,"f"))throw new Ut(`Invalid root key detected. The root key for this agent is ${this.rootKey} and the shouldFetchRootKey value is set to ${La(this,pa,"f")}. The root key should only be unknown if you are in local development. Otherwise you should avoid fetching and use the default IC Root Key or the known root key of your environment.`);await this.fetchRootKey()}},function(t){t.Error="err",t.GetPrincipal="gp",t.GetPrincipalResponse="gpr",t.Query="q",t.QueryResponse="qr",t.Call="c",t.CallResponse="cr",t.ReadState="rs",t.ReadStateResponse="rsr",t.Status="s",t.StatusResponse="sr"}(Da||(Da={}));function $a(){return function(...t){return async(e,r,n)=>{for(const i of t)await i(e,r,n)}}((t=function(){let t=!0;return async()=>!!t&&(t=!1,!0)}(),e=1e3,async(r,n,i)=>{if(await t(r,n,i))return new Promise(t=>setTimeout(t,e))}),function(t,e){let r=t;return()=>new Promise(t=>setTimeout(()=>{r*=e,t()},r))}(1e3,1.2),function(t){const e=Date.now()+t;return async(r,n,i)=>{if(Date.now()>e)throw new Error(`Request timed out after ${t} msec:\n  Request ID: ${xt(n)}\n  Request status: ${i}\n`)}}(3e5));var t,e}async function Ga(t,e,r,n=$a(),i,s){var o;const a=[(new TextEncoder).encode("request_status"),r],c=null!=i?i:await(null===(o=t.createReadStateRequest)||void 0===o?void 0:o.call(t,{paths:[a]})),u=await t.readState(e,{paths:[a]},void 0,c);if(null==t.rootKey)throw new Error("Agent root key not initialized before polling");const f=await Gs.create({certificate:u.certificate,rootKey:t.rootKey,canisterId:e,blsVerify:s}),h=Zs(f.lookup([...a,(new TextEncoder).encode("status")]));let l;switch(l=void 0===h?Fa.Unknown:(new TextDecoder).decode(h),l){case Fa.Replied:return{reply:Zs(f.lookup([...a,"reply"])),certificate:f};case Fa.Received:case Fa.Unknown:case Fa.Processing:return await n(e,r,l),Ga(t,e,r,n,c,s);case Fa.Rejected:{const t=new Uint8Array(Zs(f.lookup([...a,"reject_code"])))[0],e=(new TextDecoder).decode(Zs(f.lookup([...a,"reject_message"])));throw new Error(`Call was rejected:\n  Request ID: ${xt(r)}\n  Reject code: ${t}\n  Reject text: ${e}\n`)}case Fa.Done:throw new Error(`Call was marked as done but we never saw the reply:\n  Request ID: ${xt(r)}\n`)}throw new Error("unreachable")}var za=({IDL:t})=>{const e=t.Variant({mainnet:t.Null,testnet:t.Null}),r=t.Text,n=t.Record({network:e,address:r,min_confirmations:t.Opt(t.Nat32)}),i=t.Nat64,s=i,o=t.Nat32,a=t.Record({start_height:o,end_height:t.Opt(o),network:e}),c=t.Vec(t.Nat8),u=t.Record({tip_height:o,block_headers:t.Vec(c)}),f=t.Record({network:e}),h=t.Nat64,l=t.Vec(h),d=t.Record({network:e,filter:t.Opt(t.Variant({page:t.Vec(t.Nat8),min_confirmations:t.Nat32})),address:r}),p=t.Vec(t.Nat8),y=t.Record({txid:t.Vec(t.Nat8),vout:t.Nat32}),g=t.Record({height:t.Nat32,value:i,outpoint:y}),b=t.Record({next_page:t.Opt(t.Vec(t.Nat8)),tip_height:o,tip_block_hash:p,utxos:t.Vec(g)}),w=t.Record({transaction:t.Vec(t.Nat8),network:e}),m=t.Principal,v=t.Record({canister_id:m,num_requested_changes:t.Opt(t.Nat64)}),E=t.Variant({from_user:t.Record({user_id:t.Principal}),from_canister:t.Record({canister_version:t.Opt(t.Nat64),canister_id:t.Principal})}),_=t.Vec(t.Nat8),B=t.Variant({creation:t.Record({controllers:t.Vec(t.Principal)}),code_deployment:t.Record({mode:t.Variant({reinstall:t.Null,upgrade:t.Null,install:t.Null}),module_hash:t.Vec(t.Nat8)}),load_snapshot:t.Record({canister_version:t.Nat64,taken_at_timestamp:t.Nat64,snapshot_id:_}),controllers_change:t.Record({controllers:t.Vec(t.Principal)}),code_uninstall:t.Null}),I=t.Record({timestamp_nanos:t.Nat64,canister_version:t.Nat64,origin:E,details:B}),x=t.Record({controllers:t.Vec(t.Principal),module_hash:t.Opt(t.Vec(t.Nat8)),recent_changes:t.Vec(I),total_num_changes:t.Nat64}),T=t.Record({canister_id:m}),A=t.Variant({controllers:t.Null,public:t.Null,allowed_viewers:t.Vec(t.Principal)}),S=t.Record({freezing_threshold:t.Nat,controllers:t.Vec(t.Principal),reserved_cycles_limit:t.Nat,log_visibility:A,wasm_memory_limit:t.Nat,memory_allocation:t.Nat,compute_allocation:t.Nat}),N=t.Record({status:t.Variant({stopped:t.Null,stopping:t.Null,running:t.Null}),memory_size:t.Nat,cycles:t.Nat,settings:S,query_stats:t.Record({response_payload_bytes_total:t.Nat,num_instructions_total:t.Nat,num_calls_total:t.Nat,request_payload_bytes_total:t.Nat}),idle_cycles_burned_per_day:t.Nat,module_hash:t.Opt(t.Vec(t.Nat8)),reserved_cycles:t.Nat}),O=t.Record({canister_id:m}),R=t.Record({freezing_threshold:t.Opt(t.Nat),controllers:t.Opt(t.Vec(t.Principal)),reserved_cycles_limit:t.Opt(t.Nat),log_visibility:t.Opt(A),wasm_memory_limit:t.Opt(t.Nat),memory_allocation:t.Opt(t.Nat),compute_allocation:t.Opt(t.Nat)}),U=t.Record({settings:t.Opt(R),sender_canister_version:t.Opt(t.Nat64)}),F=t.Record({canister_id:m}),k=t.Record({canister_id:m}),L=t.Record({canister_id:m,snapshot_id:_}),P=t.Record({canister_id:m}),C=t.Variant({secp256k1:t.Null}),j=t.Record({key_id:t.Record({name:t.Text,curve:C}),canister_id:t.Opt(m),derivation_path:t.Vec(t.Vec(t.Nat8))}),M=t.Record({public_key:t.Vec(t.Nat8),chain_code:t.Vec(t.Nat8)}),V=t.Record({canister_id:m}),D=t.Record({idx:t.Nat64,timestamp_nanos:t.Nat64,content:t.Vec(t.Nat8)}),q=t.Record({canister_log_records:t.Vec(D)}),$=t.Record({value:t.Text,name:t.Text}),G=t.Record({status:t.Nat,body:t.Vec(t.Nat8),headers:t.Vec($)}),z=t.Record({url:t.Text,method:t.Variant({get:t.Null,head:t.Null,post:t.Null}),max_response_bytes:t.Opt(t.Nat64),body:t.Opt(t.Vec(t.Nat8)),transform:t.Opt(t.Record({function:t.Func([t.Record({context:t.Vec(t.Nat8),response:G})],[G],["query"]),context:t.Vec(t.Nat8)})),headers:t.Vec($)}),K=t.Variant({reinstall:t.Null,upgrade:t.Opt(t.Record({wasm_memory_persistence:t.Opt(t.Variant({keep:t.Null,replace:t.Null})),skip_pre_upgrade:t.Opt(t.Bool)})),install:t.Null}),Z=t.Record({hash:t.Vec(t.Nat8)}),H=t.Record({arg:t.Vec(t.Nat8),wasm_module_hash:t.Vec(t.Nat8),mode:K,chunk_hashes_list:t.Vec(Z),target_canister:m,store_canister:t.Opt(m),sender_canister_version:t.Opt(t.Nat64)}),Y=t.Vec(t.Nat8),W=t.Record({arg:t.Vec(t.Nat8),wasm_module:Y,mode:K,canister_id:m,sender_canister_version:t.Opt(t.Nat64)}),X=t.Record({canister_id:m}),J=t.Record({id:_,total_size:t.Nat64,taken_at_timestamp:t.Nat64}),Q=t.Vec(J),tt=t.Record({canister_id:m,sender_canister_version:t.Opt(t.Nat64),snapshot_id:_}),et=t.Record({start_at_timestamp_nanos:t.Nat64,subnet_id:t.Principal}),rt=t.Record({num_block_failures_total:t.Nat64,node_id:t.Principal,num_blocks_proposed_total:t.Nat64}),nt=t.Vec(t.Record({timestamp_nanos:t.Nat64,node_metrics:t.Vec(rt)})),it=t.Record({settings:t.Opt(R),specified_id:t.Opt(m),amount:t.Opt(t.Nat),sender_canister_version:t.Opt(t.Nat64)}),st=t.Record({canister_id:m}),ot=t.Record({canister_id:m,amount:t.Nat}),at=t.Vec(t.Nat8),ct=t.Variant({ed25519:t.Null,bip340secp256k1:t.Null}),ut=t.Record({key_id:t.Record({algorithm:ct,name:t.Text}),canister_id:t.Opt(m),derivation_path:t.Vec(t.Vec(t.Nat8))}),ft=t.Record({public_key:t.Vec(t.Nat8),chain_code:t.Vec(t.Nat8)}),ht=t.Record({key_id:t.Record({name:t.Text,curve:C}),derivation_path:t.Vec(t.Vec(t.Nat8)),message_hash:t.Vec(t.Nat8)}),lt=t.Record({signature:t.Vec(t.Nat8)}),dt=t.Variant({bip341:t.Record({merkle_root_hash:t.Vec(t.Nat8)})}),pt=t.Record({aux:t.Opt(dt),key_id:t.Record({algorithm:ct,name:t.Text}),derivation_path:t.Vec(t.Vec(t.Nat8)),message:t.Vec(t.Nat8)}),yt=t.Record({signature:t.Vec(t.Nat8)}),gt=t.Record({canister_id:m}),bt=t.Record({canister_id:m}),wt=t.Record({canister_id:m}),mt=t.Vec(Z),vt=t.Record({subnet_id:t.Principal}),Et=t.Record({replica_version:t.Text}),_t=t.Record({replace_snapshot:t.Opt(_),canister_id:m}),Bt=J,It=t.Record({canister_id:m,sender_canister_version:t.Opt(t.Nat64)}),xt=t.Record({canister_id:t.Principal,settings:R,sender_canister_version:t.Opt(t.Nat64)}),Tt=t.Record({chunk:t.Vec(t.Nat8),canister_id:t.Principal}),At=Z;return t.Service({bitcoin_get_balance:t.Func([n],[s],[]),bitcoin_get_block_headers:t.Func([a],[u],[]),bitcoin_get_current_fee_percentiles:t.Func([f],[l],[]),bitcoin_get_utxos:t.Func([d],[b],[]),bitcoin_send_transaction:t.Func([w],[],[]),canister_info:t.Func([v],[x],[]),canister_status:t.Func([T],[N],[]),clear_chunk_store:t.Func([O],[],[]),create_canister:t.Func([U],[F],[]),delete_canister:t.Func([k],[],[]),delete_canister_snapshot:t.Func([L],[],[]),deposit_cycles:t.Func([P],[],[]),ecdsa_public_key:t.Func([j],[M],[]),fetch_canister_logs:t.Func([V],[q],["query"]),http_request:t.Func([z],[G],[]),install_chunked_code:t.Func([H],[],[]),install_code:t.Func([W],[],[]),list_canister_snapshots:t.Func([X],[Q],[]),load_canister_snapshot:t.Func([tt],[],[]),node_metrics_history:t.Func([et],[nt],[]),provisional_create_canister_with_cycles:t.Func([it],[st],[]),provisional_top_up_canister:t.Func([ot],[],[]),raw_rand:t.Func([],[at],[]),schnorr_public_key:t.Func([ut],[ft],[]),sign_with_ecdsa:t.Func([ht],[lt],[]),sign_with_schnorr:t.Func([pt],[yt],[]),start_canister:t.Func([gt],[],[]),stop_canister:t.Func([bt],[],[]),stored_chunks:t.Func([wt],[mt],[]),subnet_info:t.Func([vt],[Et],[]),take_canister_snapshot:t.Func([_t],[Bt],[]),uninstall_code:t.Func([It],[],[]),update_settings:t.Func([xt],[],[]),upload_chunk:t.Func([Tt],[At],[])})};class Ka extends Ut{constructor(t,e,r,n){super(["Call failed:",`  Canister: ${t.toText()}`,`  Method: ${e} (${r})`,...Object.getOwnPropertyNames(n).map(t=>`  "${t}": ${JSON.stringify(n[t])}`)].join("\n")),this.canisterId=t,this.methodName=e,this.type=r,this.props=n}}class Za extends Ka{constructor(t,e,r){var n;super(t,e,"query",{Status:r.status,Code:null!==(n=f[r.reject_code])&&void 0!==n?n:`Unknown Code "${r.reject_code}"`,Message:r.reject_message}),this.result=r}}class Ha extends Ka{constructor(t,e,r,n,i,s,o){super(t,e,"update",Object.assign({"Request ID":xt(r)},n.body?Object.assign(Object.assign({},o?{"Error code":o}:{}),{"Reject code":String(i),"Reject message":s}):{"HTTP status code":n.status.toString(),"HTTP status text":n.statusText})),this.requestId=r,this.response=n,this.reject_code=i,this.reject_message=s,this.error_code=o}}const Ya=Symbol.for("ic-agent-metadata");class Wa{constructor(t){this[Ya]=Object.freeze(t)}static agentOf(t){return t[Ya].config.agent}static interfaceOf(t){return t[Ya].service}static canisterIdOf(t){return Bt.from(t[Ya].config.canisterId)}static async install(t,e){const r=void 0===t.mode?{install:null}:t.mode,n=t.arg?[...new Uint8Array(t.arg)]:[],i=[...new Uint8Array(t.module)],s="string"==typeof e.canisterId?Bt.fromText(e.canisterId):e.canisterId;await rc(e).install_code({mode:r,arg:n,wasm_module:i,canister_id:s,sender_canister_version:[]})}static async createCanister(t,e){const{canister_id:r}=await rc(t||{}).provisional_create_canister_with_cycles({amount:[],settings:function(t){return[{controllers:t.controllers?[t.controllers]:[],compute_allocation:t.compute_allocation?[t.compute_allocation]:[],freezing_threshold:t.freezing_threshold?[t.freezing_threshold]:[],memory_allocation:t.memory_allocation?[t.memory_allocation]:[],reserved_cycles_limit:[],log_visibility:[],wasm_memory_limit:[]}]}(e||{}),specified_id:[],sender_canister_version:[]});return r}static async createAndInstallCanister(t,e,r){const n=await this.createCanister(r);return await this.install(Object.assign({},e),Object.assign(Object.assign({},r),{canisterId:n})),this.createActor(t,Object.assign(Object.assign({},r),{canisterId:n}))}static createActorClass(t,e){const r=t({IDL:Je});return class extends Wa{constructor(t){if(!t.canisterId)throw new Ut(`Canister ID is required, but received ${typeof t.canisterId} instead. If you are using automatically generated declarations, this may be because your application is not setting the canister ID in process.env correctly.`);const n="string"==typeof t.canisterId?Bt.fromText(t.canisterId):t.canisterId;super({config:Object.assign(Object.assign(Object.assign({},Ja),t),{canisterId:n}),service:r});for(const[n,i]of r._fields)(null==e?void 0:e.httpDetails)&&i.annotations.push(Qa),(null==e?void 0:e.certificate)&&i.annotations.push(tc),this[n]=ec(this,n,i,t.blsVerify)}}}static createActor(t,e){if(!e.canisterId)throw new Ut(`Canister ID is required, but received ${typeof e.canisterId} instead. If you are using automatically generated declarations, this may be because your application is not setting the canister ID in process.env correctly.`);return new(this.createActorClass(t))(e)}static createActorWithHttpDetails(t,e){return new(this.createActorClass(t,{httpDetails:!0}))(e)}static createActorWithExtendedDetails(t,e,r={httpDetails:!0,certificate:!0}){return new(this.createActorClass(t,r))(e)}}function Xa(t,e){const r=Be(t,h.Buffer.from(e));switch(r.length){case 0:return;case 1:return r[0];default:return r}}const Ja={pollingStrategyFactory:$a},Qa="http-details",tc="certificate";function ec(t,e,r,n){let i;i=r.annotations.includes("query")||r.annotations.includes("composite_query")?async(n,...i)=>{var s,o;const a=(n=Object.assign(Object.assign({},n),null===(o=(s=t[Ya].config).queryTransform)||void 0===o?void 0:o.call(s,e,i,Object.assign(Object.assign({},t[Ya].config),n)))).agent||t[Ya].config.agent||qa(),c=Bt.from(n.canisterId||t[Ya].config.canisterId),u=_e(r.argTypes,i),f=await a.query(c,{methodName:e,arg:u,effectiveCanisterId:n.effectiveCanisterId}),h=Object.assign(Object.assign({},f.httpDetails),{requestDetails:f.requestDetails});switch(f.status){case"rejected":throw new Za(c,e,f);case"replied":return r.annotations.includes(Qa)?{httpDetails:h,result:Xa(r.retTypes,f.reply.arg)}:Xa(r.retTypes,f.reply.arg)}}:async(i,...s)=>{var o,a;const c=(i=Object.assign(Object.assign({},i),null===(a=(o=t[Ya].config).callTransform)||void 0===a?void 0:a.call(o,e,s,Object.assign(Object.assign({},t[Ya].config),i)))).agent||t[Ya].config.agent||qa(),{canisterId:u,effectiveCanisterId:f,pollingStrategyFactory:h}=Object.assign(Object.assign(Object.assign({},Ja),t[Ya].config),i),l=Bt.from(u),d=void 0!==f?Bt.from(f):l,p=_e(r.argTypes,s),{requestId:y,response:g,requestDetails:b}=await c.call(l,{methodName:e,arg:p,effectiveCanisterId:d});let w,m;if(g.body&&g.body.certificate){if(null==c.rootKey)throw new Error("Agent is missing root key");const t=g.body.certificate;m=await Gs.create({certificate:Pt(t),rootKey:c.rootKey,canisterId:Bt.from(u),blsVerify:n});const r=[(new TextEncoder).encode("request_status"),y];switch((new TextDecoder).decode(Zs(m.lookup([...r,"status"])))){case"replied":w=Zs(m.lookup([...r,"reply"]));break;case"rejected":{const t=new Uint8Array(Zs(m.lookup([...r,"reject_code"])))[0],n=(new TextDecoder).decode(Zs(m.lookup([...r,"reject_message"]))),i=Zs(m.lookup([...r,"error_code"])),s=i?(new TextDecoder).decode(i):void 0;throw new Ha(l,e,y,g,t,n,s)}}}else if(g.body&&"reject_message"in g.body){const{reject_code:t,reject_message:r,error_code:n}=g.body;throw new Ha(l,e,y,g,t,r,n)}if(202===g.status){const t=h(),e=await Ga(c,d,y,t,n);m=e.certificate,w=e.reply}const v=r.annotations.includes(Qa),E=r.annotations.includes(tc),_=Object.assign(Object.assign({},g),{requestDetails:b});if(void 0!==w)return v&&E?{httpDetails:_,certificate:m,result:Xa(r.retTypes,w)}:E?{certificate:m,result:Xa(r.retTypes,w)}:v?{httpDetails:_,result:Xa(r.retTypes,w)}:Xa(r.retTypes,w);if(0===r.retTypes.length)return v?{httpDetails:g,result:void 0}:void 0;throw new Error(`Call was returned undefined, but type [${r.retTypes.join(",")}].`)};const s=(...t)=>i({},...t);return s.withOptions=t=>(...e)=>i(t,...e),s}function rc(t){function e(e,r){if(t.effectiveCanisterId)return{effectiveCanisterId:Bt.from(t.effectiveCanisterId)};const n=r[0];let i=Bt.fromHex("");return n&&"object"==typeof n&&n.target_canister&&"install_chunked_code"===e&&(i=Bt.from(n.target_canister)),n&&"object"==typeof n&&n.canister_id&&(i=Bt.from(n.canister_id)),{effectiveCanisterId:i}}return Wa.createActor(za,Object.assign(Object.assign(Object.assign({},t),{canisterId:Bt.fromHex("")}),{callTransform:e,queryTransform:e}))}const nc=({IDL:t})=>{const e=t.Record({id:t.Nat,name:t.Text,imageBase64:t.Text,clickUrl:t.Text,adType:t.Text,viewsPurchased:t.Nat,viewsServed:t.Nat});return t.Service({getNextAd:t.Func([t.Text,t.Text],[t.Opt(t.Tuple(e,t.Nat))],[]),recordViewWithToken:t.Func([t.Nat],[t.Bool],[])})},ic="localhost"===location.hostname?"http://localhost:4943":"https://ic0.app",sc=(()=>{try{return"undefined"!=typeof window&&window.console?window.console:{}}catch{return{}}})();["log","info","warn","error","debug"].forEach(t=>{"function"!=typeof sc[t]&&(sc[t]=function(){})});const oc={"Horizontal Banner Portrait":{w:1090,h:225},"Vertical Banner Portrait":{w:225,h:1090},"Full Page Portrait":{w:1080,h:1920},"Full Page Landscape":{w:1920,h:1080},"Horizontal Banner Landscape":{w:1920,h:400}};class ac{constructor(t){this.scriptEl=t,this.dataset=t.dataset||{},this.projectId=this.dataset.projectId||t.getAttribute("data-project-id")||"Ad Network",this.adType=this.dataset.adType||t.getAttribute("data-ad-type")||"Horizontal Banner Portrait",this.targetId=this.dataset.target||t.getAttribute("data-target")||null,this.agent=new Va({host:ic}),this.actor=null,this.container=this.targetId?document.getElementById(this.targetId):document.createElement("div"),!this.targetId&&t.parentNode&&t.parentNode.insertBefore(this.container,t.nextSibling),this.container.style.display="block",this.container.style.position="relative",this.container.style.overflow="hidden",this.container.style.lineHeight="0";const e=oc[this.adType]||{w:728,h:90},r=this.adType.includes("Horizontal Banner")||this.adType.includes("Landscape")||this.adType.includes("Full Page Portrait");r?(this.container.style.width="100%",this.container.style.height="0",this.container.style.paddingBottom=e.h/e.w*100+"%"):(this.container.style.width=`${e.w}px`,this.container.style.height=`${e.h}px`),this.container.style.minWidth=r?"100%":`${e.w}px`,this.container.style.minHeight=r?"auto":`${e.h}px`,this.img=null,this.viewTimer=null,this.blobUrl=null,document.addEventListener("visibilitychange",this.handleVisibilityChange),window.addEventListener("pagehide",this.clearViewTimer),window.addEventListener("beforeunload",this.clearViewTimer)}createActor=async()=>{try{if(this.actor)return this.actor;const t=this.agent;return this.actor=Wa.createActor(nc,{agent:t,canisterId:"qanay-uyaaa-aaaag-qbbwa-cai"}),this.actor}catch(t){throw this.debug("createActor error:",t),t}};debug=(...t)=>{sc.debug("[AdNetworkEmbed]",...t)};hide=()=>{this.container.style.display="none"};showFallback=t=>{const e=document.createElement("div");e.style.textAlign="center",e.style.color="gray",e.style.padding="10px",e.style.width="100%",e.style.height="100%",e.style.boxSizing="border-box",e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="center",e.innerText=t,this.container.innerHTML="",this.container.appendChild(e)};clearViewTimer=()=>{this.viewTimer&&(clearTimeout(this.viewTimer),this.viewTimer=null,this.debug("View timer cleared")),this.blobUrl&&(URL.revokeObjectURL(this.blobUrl),this.blobUrl=null)};handleVisibilityChange=()=>{"hidden"===document.visibilityState&&this.clearViewTimer()};destroy=()=>{document.removeEventListener("visibilitychange",this.handleVisibilityChange),window.removeEventListener("pagehide",this.clearViewTimer),window.removeEventListener("beforeunload",this.clearViewTimer),this.clearViewTimer(),this.interval&&clearInterval(this.interval)};fetchAndShow=async()=>{this.debug("Fetching ad for project:",this.projectId,"adType:",this.adType);try{const t=await this.createActor(),e=await t.getNextAd(this.projectId,this.adType);this.debug("Raw response:",e);const r=function(t){if(!Array.isArray(t)||0===t.length)return null;const e=t[0];return Array.isArray(e)&&2===e.length?e:"object"==typeof e&&null!==e&&"0"in e&&"1"in e?[e[0],e[1]]:null}(e);if(this.debug("Normalized:",r),!r)return this.debug("No ad available"),void this.showFallback("No ad available");const[n,i]=r,s=n.imageBase64||"";if(!s)return this.debug("No image data"),void this.showFallback("No ad image");let o;try{o=Uint8Array.from(atob(s),t=>t.charCodeAt(0)),this.debug("Base64 decoded; length:",o.length)}catch(t){return this.debug("Base64 decode error:",t),void this.showFallback("Invalid image data")}let a="image/jpeg";s.startsWith("iVBORw0KGgo")&&(a="image/png");const c=new Blob([o],{type:a});if(this.blobUrl=URL.createObjectURL(c),this.img=document.createElement("img"),this.img.src=this.blobUrl,this.img.alt="Ad",this.img.style.position="absolute",this.img.style.top="0",this.img.style.left="0",this.img.style.width="100%",this.img.style.height="100%",this.img.style.objectFit="cover",this.img.decoding="async",this.img.loading="eager",this.img.onerror=t=>{this.debug("Image load error:",t),this.showFallback("Image failed to load")},this.img.addEventListener("load",()=>{if(this.debug("Image loaded; natural size:",this.img.naturalWidth,"x",this.img.naturalHeight),0===this.img.naturalWidth)return this.debug("Loaded but zero size - invalid image?"),void this.showFallback("Invalid image");this.viewTimer||(this.viewTimer=setTimeout(async()=>{try{await t.recordViewWithToken(i),this.debug("View recorded")}catch(t){this.debug("recordView error:",t)}this.viewTimer=null},5e3),this.debug("Timer started"))},{once:!0}),this.container.innerHTML="",n.clickUrl){const t=document.createElement("a");t.href=n.clickUrl,t.target="_blank",t.rel="noopener noreferrer nofollow",t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.display="block",t.appendChild(this.img),this.container.appendChild(t),this.container.style.cursor="pointer"}else this.container.appendChild(this.img),this.container.style.cursor="default";this.debug(`Rendered Ad #${n.id} (${n.adType}); token: ${i}`)}catch(t){this.debug("fetchAndShow error:",t),this.showFallback("Error loading ad")}};start=()=>{this.fetchAndShow()};refresh=()=>{this.fetchAndShow()}}function cc(){const t=document.querySelectorAll('script[src*="ad-network-embed"]'),e=[];t.forEach(t=>{const r=new ac(t);r.start(),e.push(r)}),window.AdNetworkEmbed=window.AdNetworkEmbed||{},window.AdNetworkEmbed.instances=e,window.AdNetworkEmbed.refresh=(t=0)=>{e[t]&&e[t].refresh()},window.addEventListener("unload",()=>e.forEach(t=>t.destroy()))}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",cc,{once:!0}):cc()}();
//# sourceMappingURL=ad-network-embed-bundled.js.map
